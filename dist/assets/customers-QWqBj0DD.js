import{r as d,S as E,ag as N,ah as W,j as e,T as k,I as L,G as g,ai as K,aj as Q,q as D,E as V,P as X}from"./index-DMPyTngB.js";import{D as O,a as M,b as z}from"./DialogTitle-P729Siqj.js";import{R as Y}from"./CloseOutlined-D0ZiO0qn.js";import{T as b,c as Z,d as ee,e as se,a as P,b as t,f as te}from"./TextField-DZyZK0vq.js";import{D as B}from"./DialogActions-CI9nfQEj.js";import{B as y}from"./InputLabel-Dma56rhx.js";import{C as ae}from"./CircularProgress-CFXVLVCW.js";import"./sweetalert2.esm.all-D3pEHXw3.js";import{C as re}from"./Container-BfGOL6TG.js";import{R as ne}from"./SearchOutlined-BojlxnqM.js";import{R as ie}from"./ClearOutlined-BI83v74q.js";import{R as le}from"./PlusOutlined-B4UYib1W.js";import{R as oe}from"./EditOutlined-BTD5A_7I.js";import{R as ce}from"./DeleteOutlined-D-rIF22X.js";import{T as de}from"./TablePagination-BX3gJNQW.js";import{D as me}from"./DialogContentText-CoSPQovp.js";import{S as p}from"./Skeleton-lpGlNquy.js";const xe=({open:v,handleClose:u,customer:i=null,handleSuccess:T})=>{const C={customer_name:"",contact_number:"",email:"",address:"",city:""},[a,m]=d.useState(C),[r,c]=d.useState({}),n=E(N),{createCustomer:R,updateCustomer:f}=W(),h=!!i;d.useEffect(()=>{v&&(m(i?{customer_name:i.customer_name||"",contact_number:i.contact_number||"",email:i.email||"",address:i.address||"",city:i.city||""}:C),c({}))},[v,i]);const _=()=>{const l={};return a.customer_name.trim()||(l.customer_name="Customer name is required"),a.email&&!/\S+@\S+\.\S+/.test(a.email)&&(l.email="Email address is invalid"),c(l),Object.keys(l).length===0},j=l=>{const{name:x,value:o}=l.target;m(S=>({...S,[x]:o})),r[x]&&c(S=>({...S,[x]:void 0}))},w=async()=>{var l,x;if(_())try{let o;h?o=await f(i.id,a):o=await R(a),T&&T(o),u()}catch(o){console.error("Error saving customer:",o),(x=(l=o.response)==null?void 0:l.data)!=null&&x.errors&&c(o.response.data.errors)}};return e.jsxs(O,{open:v,onClose:u,maxWidth:"md",fullWidth:!0,"aria-labelledby":"customer-dialog-title",children:[e.jsxs(M,{id:"customer-dialog-title",sx:{m:0,p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(k,{variant:"h6",children:h?"Edit Customer":"Add New Customer"}),e.jsx(L,{"aria-label":"close",onClick:u,size:"small",children:e.jsx(Y,{})})]}),e.jsx(z,{dividers:!0,children:e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"Customer Name *",name:"customer_name",value:a.customer_name,onChange:j,error:!!r.customer_name,helperText:r.customer_name,disabled:n,required:!0})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(b,{fullWidth:!0,label:"Contact Number",name:"contact_number",value:a.contact_number,onChange:j,error:!!r.contact_number,helperText:r.contact_number,disabled:n})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(b,{fullWidth:!0,label:"Email",name:"email",type:"email",value:a.email,onChange:j,error:!!r.email,helperText:r.email,disabled:n})}),e.jsx(g,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"Address",name:"address",value:a.address,onChange:j,error:!!r.address,helperText:r.address,disabled:n,multiline:!0,rows:2})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(b,{fullWidth:!0,label:"City",name:"city",value:a.city,onChange:j,error:!!r.city,helperText:r.city,disabled:n})})]})}),e.jsxs(B,{sx:{px:3,py:2},children:[e.jsx(y,{onClick:u,disabled:n,children:"Cancel"}),e.jsx(y,{variant:"contained",color:"primary",onClick:w,disabled:n,startIcon:n&&e.jsx(ae,{size:20,color:"inherit"}),children:n?"Saving...":h?"Update":"Save"})]})]})},he=()=>e.jsxs(P,{children:[e.jsx(t,{children:e.jsx(p,{animation:"wave"})}),e.jsx(t,{children:e.jsx(p,{animation:"wave"})}),e.jsx(t,{children:e.jsx(p,{animation:"wave"})}),e.jsx(t,{children:e.jsx(p,{animation:"wave"})}),e.jsx(t,{children:e.jsx(p,{animation:"wave"})}),e.jsx(t,{align:"right",children:e.jsxs(D,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(p,{animation:"wave",variant:"circular",width:32,height:32}),e.jsx(p,{animation:"wave",variant:"circular",width:32,height:32})]})})]}),Ie=()=>{K();const v=E(Q),u=E(N),{getAllCustomers:i,deleteCustomer:T}=W(),[C,a]=d.useState(0),[m,r]=d.useState(10),[c,n]=d.useState(""),[R,f]=d.useState(!1),[h,_]=d.useState(null),[j,w]=d.useState(!1),[l,x]=d.useState(null),o=(s,I)=>{a(I)},S=s=>{r(parseInt(s.target.value,10)),a(0)},F=s=>{_(s),f(!0)},$=async()=>{try{await T(h.id),f(!1),_(null)}catch(s){console.error("Error deleting customer:",s)}},q=()=>{n("")},G=()=>{x(null),w(!0)},H=s=>{x(s),w(!0)},U=()=>{w(!1)},J=()=>{i()},A=v.filter(s=>s.customer_name.toLowerCase().includes(c.toLowerCase())||s.email&&s.email.toLowerCase().includes(c.toLowerCase())||s.contact_number&&s.contact_number.toLowerCase().includes(c.toLowerCase())||s.city&&s.city.toLowerCase().includes(c.toLowerCase()));return e.jsxs(re,{maxWidth:"xxl",sx:{mt:0,px:"0!important"},children:[e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,gap:2},children:[e.jsx(D,{sx:{display:"flex",gap:2,flex:1},children:e.jsx(b,{placeholder:"Search customers",variant:"outlined",size:"small",value:c,onChange:s=>n(s.target.value),InputProps:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(ne,{})})},sx:{minWidth:300}})}),e.jsxs(D,{children:[e.jsx(y,{variant:"text",color:"error",sx:{mr:1},onClick:q,children:e.jsx(ie,{})}),e.jsx(y,{variant:"contained",color:"primary",startIcon:e.jsx(le,{}),onClick:G,children:"Add Customer"})]})]}),e.jsx(Z,{component:X,children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(P,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Contact Number"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Address"}),e.jsx(t,{children:"City"}),e.jsx(t,{align:"right",children:"Actions"})]})}),e.jsxs(te,{children:[u?[...Array(m)].map((s,I)=>e.jsx(he,{},I)):A.slice(C*m,C*m+m).map(s=>e.jsxs(P,{children:[e.jsx(t,{children:e.jsx(k,{children:s.customer_name})}),e.jsx(t,{children:s.contact_number||"N/A"}),e.jsx(t,{children:s.email||"N/A"}),e.jsx(t,{children:s.address||"N/A"}),e.jsx(t,{children:s.city||"N/A"}),e.jsxs(t,{align:"right",children:[e.jsx(L,{onClick:()=>H(s),children:e.jsx(oe,{style:{fontSize:20}})}),e.jsx(L,{onClick:()=>F(s),children:e.jsx(ce,{style:{fontSize:20,color:"red"}})})]})]},s.id)),!u&&A.length===0&&e.jsx(P,{children:e.jsx(t,{colSpan:6,align:"center",children:e.jsx(k,{variant:"body1",sx:{py:2},children:"No customers found"})})})]})]})}),e.jsx(de,{rowsPerPageOptions:[5,10,25],component:"div",count:A.length,rowsPerPage:m,page:C,onPageChange:o,onRowsPerPageChange:S}),e.jsxs(O,{open:R,onClose:()=>f(!1),children:[e.jsx(M,{children:"Confirm Delete"}),e.jsx(z,{children:e.jsxs(me,{children:['Are you sure you want to delete the customer "',h==null?void 0:h.customer_name,'"? This action cannot be undone.']})}),e.jsxs(B,{children:[e.jsx(y,{onClick:()=>f(!1),children:"Cancel"}),e.jsx(y,{onClick:$,color:"error",children:"Delete"})]})]}),e.jsx(xe,{open:j,handleClose:U,customer:l,handleSuccess:J})]})};export{Ie as default};

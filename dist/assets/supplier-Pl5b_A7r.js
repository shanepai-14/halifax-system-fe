import{r as n,H as O,J as U,K as Y,L as q,j as e,q as S,A as J,P as K,I as u}from"./index-BCpXsV6C.js";import{S as N}from"./SupplierModal-5uXcxdKc.js";import{S as x}from"./sweetalert2.esm.all-D3pEHXw3.js";import{C as V,T as W,R as G,c as Q,d as X,e as Z,a as w,b as s,f as ee}from"./PlusOutlined-BjNBVFEH.js";import{R as te,T as re}from"./SearchOutlined-CJM1AXmb.js";import{B as P}from"./InputLabel-bc7xF69S.js";import{R as se,a as ne}from"./EyeOutlined-CF7N8GbA.js";import{R as ae}from"./EditOutlined-DlYFdU0J.js";import{R as oe}from"./DeleteOutlined-CLqsTrHe.js";const je=()=>{const[c,m]=n.useState(0),[i,y]=n.useState(10),[l,j]=n.useState(""),[R,f]=n.useState(!1),[_,A]=n.useState("create"),[T,b]=n.useState(null),{data:a,isLoading:I,error:g,refetch:d}=O(),v=U(),M=Y(),B=q(),C=a==null?void 0:a.filter(t=>t.supplier_name.toLowerCase().includes(l.toLowerCase())||t.contact_person.toLowerCase().includes(l.toLowerCase())||t.email.toLowerCase().includes(l.toLowerCase())),E=(t,r)=>{m(r)},L=t=>{y(parseInt(t.target.value,10)),m(0)},k=async t=>{x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(async r=>{if(r.isConfirmed)try{await B.mutateAsync(t),x.fire("Deleted!","Supplier has been deleted.","success"),d()}catch(o){x.fire("Error!","Failed to delete supplier. Please try again.","error"),console.error("Error deleting supplier:",o)}})},D=t=>{const r=a.find(o=>o.supplier_id===t);p("view",r)},$=t=>{const r=a.find(o=>o.supplier_id===t);p("edit",r)},p=(t,r=null)=>{A(t),b(r),f(!0)},z=async t=>{try{await M.mutateAsync({id:t.supplier_id,data:{supplier_name:t.supplier_name,contact_person:t.contact_person,email:t.email,phone:t.phone,address:t.address}}),d(),h()}catch(r){console.error("Error updating supplier:",r)}},F=async t=>{try{await v.mutateAsync(t),d(),h()}catch(r){console.error("Error creating supplier:",r)}},h=()=>{f(!1)},H=()=>{j("")};return I?e.jsx("div",{children:"Loading..."}):g?e.jsxs("div",{children:["Error: ",g.message]}):e.jsxs(V,{maxWidth:"xxl",sx:{mt:0,px:"0!important"},children:[e.jsxs(S,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(W,{placeholder:"Search suppliers...",variant:"outlined",size:"small",value:l,onChange:t=>j(t.target.value),InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(te,{})})}}),e.jsxs(S,{children:[e.jsx(P,{variant:"text",color:"error",sx:{mr:1},onClick:H,children:e.jsx(se,{})}),e.jsx(P,{variant:"contained",color:"error",startIcon:e.jsx(G,{}),onClick:()=>p("create"),children:"Add Supplier"})]})]}),e.jsx(Q,{component:K,children:e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(w,{children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Contact Person"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Phone"}),e.jsx(s,{children:"Address"}),e.jsx(s,{align:"right",children:"Actions"})]})}),e.jsx(ee,{children:C.slice(c*i,c*i+i).map(t=>e.jsxs(w,{children:[e.jsx(s,{children:t.supplier_name}),e.jsx(s,{children:t.contact_person}),e.jsx(s,{children:t.email}),e.jsx(s,{children:t.phone}),e.jsx(s,{children:t.address}),e.jsxs(s,{align:"right",children:[e.jsx(u,{onClick:()=>D(t.supplier_id),children:e.jsx(ne,{style:{fontSize:20}})}),e.jsx(u,{onClick:()=>$(t.supplier_id),children:e.jsx(ae,{style:{fontSize:20}})}),e.jsx(u,{onClick:()=>k(t.supplier_id),children:e.jsx(oe,{style:{fontSize:20}})})]})]},t.supplier_id))})]})}),e.jsx(re,{rowsPerPageOptions:[5,10,25],component:"div",count:C.length,rowsPerPage:i,page:c,onPageChange:E,onRowsPerPageChange:L}),e.jsx(N,{open:R,handleClose:h,handleAddSupplier:F,handleUpdateSupplier:z,mode:_,initialData:T})]})};export{je as default};

import{r as f,j as t,q,G as l,T as h,F as E,a5 as d,a6 as G,a7 as R,$ as u,t as C}from"./index-BH4OZBNn.js";import{A as S}from"./Autocomplete-gVGXcdNK.js";import{T as v,S as K}from"./TextField-DF5xaGpt.js";import{I as Q,a as $,B as F}from"./InputLabel-BCuRqJ6g.js";import{M as I}from"./MenuItem-BzYG3h4A.js";import{R as W}from"./CloseOutlined-D7Yyhn4D.js";import{R as L}from"./SaveOutlined-DhTrkmo0.js";const z=({product:e,products:r,adjustmentTypes:s,onSubmit:p,onCancel:_,onSelectedProduct:P})=>{console.log(e);const[o,j]=f.useState({id:(e==null?void 0:e.id)||"",product_id:(e==null?void 0:e.id)||"",quantity:"",type:"addition",reason:"",notes:""}),[i,g]=f.useState({});f.useEffect(()=>{e&&j(n=>({...n,id:e.id||"",product_id:e.id||""}))},[e]);const T=()=>{const n={};return console.log("formData",o),o.product_id||(n.product_id="Product is required"),(!o.quantity||o.quantity<=0)&&(n.quantity="Quantity must be greater than 0"),o.reason||(n.reason="Reason is required"),g(n),Object.keys(n).length===0},x=n=>{const{name:a,value:m}=n.target;j(c=>({...c,[a]:m})),i[a]&&g(c=>{const b={...c};return delete b[a],b})},w=(n,a)=>{j(m=>({...m,product_id:a?a.id:"",id:a?a.id:""})),console.log("newValue",a),P(a),i.product_id&&g(m=>{const c={...m};return delete c.product_id,c})},A=n=>{n.preventDefault(),T()&&p(o)},y=e||r.find(n=>n.id===o.id);return console.log("product",e),console.log("products",r),t.jsx(q,{component:"form",onSubmit:A,sx:{mt:2},children:t.jsxs(l,{container:!0,spacing:3,children:[t.jsx(l,{item:!0,xs:12,children:t.jsx(S,{value:y||null,onChange:w,options:r||[],getOptionLabel:n=>`${n.product_code} - ${n.product_name}`,isOptionEqualToValue:(n,a)=>n.id===a.id,renderInput:n=>t.jsx(v,{...n,fullWidth:!0,label:"Product",error:!!i.product_id,helperText:i.product_id,disabled:e!==null&&e.product_id})})}),y&&t.jsx(l,{item:!0,xs:12,children:t.jsxs(q,{sx:{mb:2,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid #e0e0e0"},children:[t.jsx(h,{variant:"subtitle1",fontWeight:"bold",children:"Current Inventory:"}),t.jsxs(h,{children:["Product: ",y.product_name]}),t.jsxs(h,{children:["Current Quantity: ",y.quantity||0]}),t.jsxs(h,{children:["Reorder Level: ",y.reorder_level||"Not set"]})]})}),t.jsx(l,{item:!0,xs:12,md:6,children:t.jsxs(E,{fullWidth:!0,error:!!i.type,children:[t.jsx(Q,{children:"Adjustment Type"}),t.jsx(K,{name:"type",value:o.type,onChange:x,label:"Adjustment Type",children:s.map(n=>t.jsx(I,{value:n.value,children:n.label},n.value))}),i.type&&t.jsx($,{children:i.type})]})}),t.jsx(l,{item:!0,xs:12,md:6,children:t.jsx(v,{fullWidth:!0,label:"Quantity",name:"quantity",type:"number",value:o.quantity,onChange:x,error:!!i.quantity,helperText:i.quantity||"Enter quantity to adjust",InputProps:{inputProps:{min:1}}})}),t.jsx(l,{item:!0,xs:12,children:t.jsx(v,{fullWidth:!0,label:"Reason",name:"reason",value:o.reason,onChange:x,error:!!i.reason,helperText:i.reason||"Provide reason for this adjustment",required:!0})}),t.jsx(l,{item:!0,xs:12,children:t.jsx(v,{fullWidth:!0,label:"Additional Notes",name:"notes",value:o.notes,onChange:x,multiline:!0,rows:3,helperText:"Optional: Add any additional notes or details"})}),t.jsx(l,{item:!0,xs:12,children:t.jsxs(q,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[t.jsx(F,{variant:"outlined",color:"inherit",onClick:_,startIcon:t.jsx(W,{}),children:"Cancel"}),t.jsx(F,{type:"submit",variant:"contained",color:"primary",startIcon:t.jsx(L,{}),children:"Save Adjustment"})]})})]})})},J=()=>d({queryKey:["inventory"],queryFn:async()=>(await u.get("/inventory")).data.data}),U=e=>d({queryKey:["inventory",e],queryFn:async()=>(await u.get(`/inventory/product/${e}`)).data.data,enabled:!!e}),X=()=>{const e=G();return R({mutationFn:async r=>(await u.post("/inventory/adjustments",r)).data,onSuccess:(r,s)=>{e.invalidateQueries(["inventory"]),e.invalidateQueries(["inventory",s.product_id]),e.invalidateQueries(["inventory-adjustments"]),e.invalidateQueries(["inventory-adjustments",s.product_id])},onError:r=>{var s,p;C.error(((p=(s=r.response)==null?void 0:s.data)==null?void 0:p.message)||"Failed to create adjustment")}})},Y=(e={})=>d({queryKey:["inventory-adjustments",e],queryFn:async()=>(await u.get("/inventory/adjustments",{params:e})).data.data}),Z=e=>d({queryKey:["inventory-adjustments",e],queryFn:async()=>(await u.get(`/inventory/adjustments/product/${e}`)).data.data,enabled:!!e}),V=(e={})=>d({queryKey:["inventory-logs",e],queryFn:async()=>(await u.get("/inventory/logs",{params:e})).data.data}),ee=e=>d({queryKey:["inventory-logs",e],queryFn:async()=>(await u.get(`/inventory/logs/product/${e}`)).data.data,enabled:!!e}),te=e=>d({queryKey:["product-transactions",e],queryFn:async()=>(await u.get(`/inventory/transactions/product/${e}`)).data.data,enabled:!!e}),ne=e=>d({queryKey:["product-reports",e],queryFn:async()=>(await u.get(`/inventory/report/product/${e}`)).data.data,enabled:!!e}),re=()=>d({queryKey:["inventory-summary-stats"],queryFn:async()=>{var e,r;try{return(await u.get("/inventory/summary-stats")).data.data}catch(s){throw console.error("Error fetching inventory stats:",s),C.error(((r=(e=s.response)==null?void 0:e.data)==null?void 0:r.message)||"Failed to fetch inventory statistics"),s}}});export{z as I,Y as a,X as b,V as c,re as d,U as e,Z as f,ee as g,te as h,ne as i,J as u};

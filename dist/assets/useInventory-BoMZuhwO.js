import{r as p,a8 as w,a9 as A,j as t,q,G as d,T as v,F as E,a5 as l,a6 as $,a7 as G,$ as u,t as Q}from"./index-DMPyTngB.js";import{A as W}from"./Autocomplete-CzNCDO1-.js";import{T as j,S as I}from"./TextField-DZyZK0vq.js";import{I as K,a as S,B as C}from"./InputLabel-Dma56rhx.js";import{M as O}from"./SearchOutlined-BojlxnqM.js";import{R as L}from"./CloseOutlined-D0ZiO0qn.js";import{R as z}from"./SaveOutlined-Bo4ngWU2.js";var B={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},D=function(r,i){return p.createElement(w,A({},r,{ref:i,icon:B}))},Y=p.forwardRef(D);const Z=({product:e,products:r,adjustmentTypes:i,onSubmit:x,onCancel:F,onSelectedProduct:_})=>{console.log(e);const[a,g]=p.useState({id:(e==null?void 0:e.id)||"",product_id:(e==null?void 0:e.id)||"",quantity:"",type:"addition",reason:"",notes:""}),[o,f]=p.useState({});p.useEffect(()=>{e&&g(n=>({...n,id:e.id||"",product_id:e.id||""}))},[e]);const P=()=>{const n={};return console.log("formData",a),a.product_id||(n.product_id="Product is required"),(!a.quantity||a.quantity<=0)&&(n.quantity="Quantity must be greater than 0"),a.reason||(n.reason="Reason is required"),f(n),Object.keys(n).length===0},h=n=>{const{name:s,value:m}=n.target;g(c=>({...c,[s]:m})),o[s]&&f(c=>{const b={...c};return delete b[s],b})},R=(n,s)=>{g(m=>({...m,product_id:s?s.id:"",id:s?s.id:""})),console.log("newValue",s),_(s),o.product_id&&f(m=>{const c={...m};return delete c.product_id,c})},T=n=>{n.preventDefault(),P()&&x(a)},y=e||r.find(n=>n.id===a.id);return console.log("product",e),console.log("products",r),t.jsx(q,{component:"form",onSubmit:T,sx:{mt:2},children:t.jsxs(d,{container:!0,spacing:3,children:[t.jsx(d,{item:!0,xs:12,children:t.jsx(W,{value:y||null,onChange:R,options:r||[],getOptionLabel:n=>`${n.product_code} - ${n.product_name}`,isOptionEqualToValue:(n,s)=>n.id===s.id,renderInput:n=>t.jsx(j,{...n,fullWidth:!0,label:"Product",error:!!o.product_id,helperText:o.product_id,disabled:e!==null&&e.product_id})})}),y&&t.jsx(d,{item:!0,xs:12,children:t.jsxs(q,{sx:{mb:2,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid #e0e0e0"},children:[t.jsx(v,{variant:"subtitle1",fontWeight:"bold",children:"Current Inventory:"}),t.jsxs(v,{children:["Product: ",y.product_name]}),t.jsxs(v,{children:["Current Quantity: ",y.quantity||0]}),t.jsxs(v,{children:["Reorder Level: ",y.reorder_level||"Not set"]})]})}),t.jsx(d,{item:!0,xs:12,md:6,children:t.jsxs(E,{fullWidth:!0,error:!!o.type,children:[t.jsx(K,{children:"Adjustment Type"}),t.jsx(I,{name:"type",value:a.type,onChange:h,label:"Adjustment Type",children:i.map(n=>t.jsx(O,{value:n.value,children:n.label},n.value))}),o.type&&t.jsx(S,{children:o.type})]})}),t.jsx(d,{item:!0,xs:12,md:6,children:t.jsx(j,{fullWidth:!0,label:"Quantity",name:"quantity",type:"number",value:a.quantity,onChange:h,error:!!o.quantity,helperText:o.quantity||"Enter quantity to adjust",InputProps:{inputProps:{min:1}}})}),t.jsx(d,{item:!0,xs:12,children:t.jsx(j,{fullWidth:!0,label:"Reason",name:"reason",value:a.reason,onChange:h,error:!!o.reason,helperText:o.reason||"Provide reason for this adjustment",required:!0})}),t.jsx(d,{item:!0,xs:12,children:t.jsx(j,{fullWidth:!0,label:"Additional Notes",name:"notes",value:a.notes,onChange:h,multiline:!0,rows:3,helperText:"Optional: Add any additional notes or details"})}),t.jsx(d,{item:!0,xs:12,children:t.jsxs(q,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[t.jsx(C,{variant:"outlined",color:"inherit",onClick:F,startIcon:t.jsx(L,{}),children:"Cancel"}),t.jsx(C,{type:"submit",variant:"contained",color:"primary",startIcon:t.jsx(z,{}),children:"Save Adjustment"})]})})]})})},V=()=>l({queryKey:["inventory"],queryFn:async()=>(await u.get("/inventory")).data.data}),ee=e=>l({queryKey:["inventory",e],queryFn:async()=>(await u.get(`/inventory/product/${e}`)).data.data,enabled:!!e}),te=()=>{const e=$();return G({mutationFn:async r=>(await u.post("/inventory/adjustments",r)).data,onSuccess:(r,i)=>{e.invalidateQueries(["inventory"]),e.invalidateQueries(["inventory",i.product_id]),e.invalidateQueries(["inventory-adjustments"]),e.invalidateQueries(["inventory-adjustments",i.product_id])},onError:r=>{var i,x;Q.error(((x=(i=r.response)==null?void 0:i.data)==null?void 0:x.message)||"Failed to create adjustment")}})},ne=(e={})=>l({queryKey:["inventory-adjustments",e],queryFn:async()=>(await u.get("/inventory/adjustments",{params:e})).data.data}),re=e=>l({queryKey:["inventory-adjustments",e],queryFn:async()=>(await u.get(`/inventory/adjustments/product/${e}`)).data.data,enabled:!!e}),se=(e={})=>l({queryKey:["inventory-logs",e],queryFn:async()=>(await u.get("/inventory/logs",{params:e})).data.data}),ae=e=>l({queryKey:["inventory-logs",e],queryFn:async()=>(await u.get(`/inventory/logs/product/${e}`)).data.data,enabled:!!e}),oe=e=>l({queryKey:["product-transactions",e],queryFn:async()=>(await u.get(`/inventory/transactions/product/${e}`)).data.data,enabled:!!e}),ie=e=>l({queryKey:["product-reports",e],queryFn:async()=>(await u.get(`/inventory/report/product/${e}`)).data.data,enabled:!!e});export{Z as I,Y as R,ne as a,te as b,se as c,ee as d,re as e,ae as f,oe as g,ie as h,V as u};

import{r as b,j as r,v as f,G as a,T as j,H as I,a6 as R,l as w,aa as d,ab as A,ac as E,a5 as l,t as P}from"./index-VYacBzdn.js";import{A as G}from"./Autocomplete-CTmCWFbU.js";import{T as p,S}from"./TextField-DcFzWKp_.js";import{I as K,a as Q}from"./InputLabel-Cn1m3Ebo.js";import{M as $}from"./MenuItem--hotehpj.js";import{R as D}from"./CloseOutlined-BzQ1yUQH.js";import{R as L}from"./SaveOutlined-B1L_Y8WW.js";const U=({product:e,products:i,adjustmentTypes:o,onSubmit:v,onCancel:C,onSelectedProduct:F})=>{const[n,_]=b.useState({id:(e==null?void 0:e.id)||"",product_id:(e==null?void 0:e.id)||"",quantity:"",type:"addition",reason:"",notes:"",distribution_price:"",walk_in_price:"",wholesale_price:"",regular_price:""}),[s,g]=b.useState({});b.useEffect(()=>{e&&_(t=>({...t,id:e.id||"",product_id:e.id||""}))},[e]);const T=()=>{const t={};return n.product_id||(t.product_id="Product is required"),(!n.quantity||n.quantity<=0)&&(t.quantity="Quantity must be greater than 0"),n.reason||(t.reason="Reason is required"),n.type==="addition"&&((!n.distribution_price||n.distribution_price<=0)&&(t.distribution_price="Distribution price is required"),(!n.walk_in_price||n.walk_in_price<=0)&&(t.walk_in_price="Walk-in price is required"),(!n.wholesale_price||n.wholesale_price<=0)&&(t.wholesale_price="Wholesale price is required"),(!n.regular_price||n.regular_price<=0)&&(t.regular_price="Regular price is required")),g(t),Object.keys(t).length===0},c=t=>{const{name:u,value:x}=t.target;_(m=>({...m,[u]:x})),s[u]&&g(m=>{const q={...m};return delete q[u],q})},W=(t,u)=>{_(x=>({...x,product_id:u?u.id:"",id:u?u.id:""})),F(u),s.product_id&&g(x=>{const m={...x};return delete m.product_id,m})},k=t=>{t.preventDefault(),T()&&v(n)},h=e||i.find(t=>t.id===n.id),y=n.type==="addition";return r.jsx(f,{component:"form",onSubmit:k,sx:{mt:2},children:r.jsxs(a,{container:!0,spacing:3,children:[r.jsx(a,{item:!0,xs:12,children:r.jsx(G,{value:h||null,onChange:W,options:i||[],getOptionLabel:t=>t?`${t.product_code||""} ${t.product_name||""}`:"",isOptionEqualToValue:(t,u)=>t&&u?t.id===u.id:!1,renderInput:t=>r.jsx(p,{...t,fullWidth:!0,label:"Product",error:!!s.product_id,helperText:s.product_id,disabled:e!==null&&e.product_id})})}),h&&r.jsx(a,{item:!0,xs:12,children:r.jsxs(f,{sx:{mb:2,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid #e0e0e0"},children:[r.jsx(j,{variant:"subtitle1",fontWeight:"bold",children:"Current Inventory:"}),r.jsxs(j,{children:["Product: ",h.product_name]}),r.jsxs(j,{children:["Current Quantity: ",h.quantity||0]}),r.jsxs(j,{children:["Reorder Level: ",h.reorder_level||"Not set"]})]})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsxs(I,{fullWidth:!0,error:!!s.type,children:[r.jsx(K,{children:"Adjustment Type"}),r.jsx(S,{name:"type",value:n.type,onChange:c,label:"Adjustment Type",children:o.map(t=>r.jsx($,{value:t.value,children:t.label},t.value))}),s.type&&r.jsx(Q,{children:s.type})]})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsx(p,{fullWidth:!0,label:"Quantity",name:"quantity",type:"number",value:n.quantity,onChange:c,error:!!s.quantity,helperText:s.quantity||"Enter quantity to adjust",InputProps:{inputProps:{min:1}}})}),r.jsx(a,{item:!0,xs:12,sx:{paddingTop:y==!0?"24px!important":"0!important"},children:r.jsx(R,{in:y,sx:{width:"100%"},children:r.jsxs(a,{container:!0,spacing:3,children:[r.jsx(a,{item:!0,xs:12,children:r.jsx(j,{variant:"subtitle2",children:"Pricing Information"})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsx(p,{fullWidth:!0,label:"Distribution Price",name:"distribution_price",type:"number",value:n.distribution_price,onChange:c,error:!!s.distribution_price,helperText:s.distribution_price,required:y,InputProps:{inputProps:{min:0,step:"0.01"}}})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsx(p,{fullWidth:!0,label:"Walk-in Price",name:"walk_in_price",type:"number",value:n.walk_in_price,onChange:c,error:!!s.walk_in_price,helperText:s.walk_in_price,required:y,InputProps:{inputProps:{min:0,step:"0.01"}}})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsx(p,{fullWidth:!0,label:"Wholesale Price",name:"wholesale_price",type:"number",value:n.wholesale_price,onChange:c,error:!!s.wholesale_price,helperText:s.wholesale_price,required:y,InputProps:{inputProps:{min:0,step:"0.01"}}})}),r.jsx(a,{item:!0,xs:12,md:6,children:r.jsx(p,{fullWidth:!0,label:"Regular Price",name:"regular_price",type:"number",value:n.regular_price,onChange:c,error:!!s.regular_price,helperText:s.regular_price,required:y,InputProps:{inputProps:{min:0,step:"0.01"}}})})]})})}),r.jsx(a,{item:!0,xs:12,children:r.jsx(p,{fullWidth:!0,label:"Reason",name:"reason",value:n.reason,onChange:c,error:!!s.reason,helperText:s.reason||"Provide reason for this adjustment",required:!0})}),r.jsx(a,{item:!0,xs:12,children:r.jsx(p,{fullWidth:!0,label:"Additional Notes",name:"notes",value:n.notes,onChange:c,multiline:!0,rows:3,helperText:"Optional: Add any additional notes or details"})}),r.jsx(a,{item:!0,xs:12,children:r.jsxs(f,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[r.jsx(w,{variant:"outlined",color:"inherit",onClick:C,startIcon:r.jsx(D,{}),children:"Cancel"}),r.jsx(w,{type:"submit",variant:"contained",color:"primary",startIcon:r.jsx(L,{}),children:"Save Adjustment"})]})})]})})},X=()=>d({queryKey:["inventory"],queryFn:async()=>(await l.get("/inventory")).data.data}),Y=e=>d({queryKey:["inventory",e],queryFn:async()=>(await l.get(`/inventory/product/${e}`)).data.data,enabled:!!e}),Z=()=>{const e=A();return E({mutationFn:async i=>(await l.post("/inventory/adjustments",i)).data,onSuccess:(i,o)=>{e.invalidateQueries(["inventory"]),e.invalidateQueries(["inventory",o.product_id]),e.invalidateQueries(["inventory-adjustments"]),e.invalidateQueries(["inventory-adjustments",o.product_id])},onError:i=>{var o,v;P.error(((v=(o=i.response)==null?void 0:o.data)==null?void 0:v.message)||"Failed to create adjustment")}})},V=(e={})=>d({queryKey:["inventory-adjustments",e],queryFn:async()=>(await l.get("/inventory/adjustments",{params:e})).data.data}),ee=e=>d({queryKey:["inventory-adjustments",e],queryFn:async()=>(await l.get(`/inventory/adjustments/product/${e}`)).data.data,enabled:!!e}),re=(e={})=>d({queryKey:["inventory-logs",e],queryFn:async()=>(await l.get("/inventory/logs",{params:e})).data.data}),te=e=>d({queryKey:["inventory-logs",e],queryFn:async()=>(await l.get(`/inventory/logs/product/${e}`)).data.data,enabled:!!e}),ne=e=>d({queryKey:["product-transactions",e],queryFn:async()=>(await l.get(`/inventory/transactions/product/${e}`)).data.data,enabled:!!e}),se=e=>d({queryKey:["product-reports",e],queryFn:async()=>(await l.get(`/inventory/report/product/${e}`)).data.data,enabled:!!e}),ie=()=>d({queryKey:["inventory-summary-stats"],queryFn:async()=>{var e,i;try{return(await l.get("/inventory/summary-stats")).data.data}catch(o){throw console.error("Error fetching inventory stats:",o),P.error(((i=(e=o.response)==null?void 0:e.data)==null?void 0:i.message)||"Failed to fetch inventory statistics"),o}}});export{U as I,V as a,Z as b,re as c,ie as d,Y as e,ee as f,te as g,ne as h,se as i,X as u};

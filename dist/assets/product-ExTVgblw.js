import{g as U,a as O,k as ge,c as he,s as P,b as k,m as G,r as m,u as E,j as t,d as q,e as V,f as je,B as _e,h as ke,P as se,i as Se,l as Pe,F as De,T as fe,n as oe,D as we,o as X,I as Ae,p as Me}from"./index-BdgPwJ-0.js";import{c as Z,a as F,F as ie,b as ne,d as f,e as Y,f as Te,g as Re}from"./index.esm-D0PQ-3B-.js";import{u as le,T as h,M as L,R as $e,a as H,C as We,b as qe,c as Fe,d as Ie,e as Be,f as xe,g as _,h as Ne,i as Le}from"./SearchOutlined-D_mWe2EX.js";import{u as ce,a as B,B as S}from"./axios-AbDXG_aL.js";function Ue(r){return U("MuiCircularProgress",r)}O("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const T=44,re=ge`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,ae=ge`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`,Oe=typeof re!="string"?he`
        animation: ${re} 1.4s linear infinite;
      `:null,Ee=typeof ae!="string"?he`
        animation: ${ae} 1.4s ease-in-out infinite;
      `:null,Ve=r=>{const{classes:e,variant:a,color:s,disableShrink:o}=r,l={root:["root",a,`color${k(s)}`],svg:["svg"],circle:["circle",`circle${k(a)}`,o&&"circleDisableShrink"]};return V(l,Ue,e)},Ke=P("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.root,e[a.variant],e[`color${k(a.color)}`]]}})(G(({theme:r})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:r.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Oe||{animation:`${re} 1.4s linear infinite`}},...Object.entries(r.palette).filter(je()).map(([e])=>({props:{color:e},style:{color:(r.vars||r).palette[e].main}}))]}))),ze=P("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(r,e)=>e.svg})({display:"block"}),Qe=P("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.circle,e[`circle${k(a.variant)}`],a.disableShrink&&e.circleDisableShrink]}})(G(({theme:r})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:r.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:Ee||{animation:`${ae} 1.4s ease-in-out infinite`}}]}))),Ye=m.forwardRef(function(e,a){const s=E({props:e,name:"MuiCircularProgress"}),{className:o,color:l="primary",disableShrink:i=!1,size:n=40,style:p,thickness:u=3.6,value:D=0,variant:w="indeterminate",...d}=s,g={...s,color:l,disableShrink:i,size:n,thickness:u,value:D,variant:w},y=Ve(g),b={},v={},C={};if(w==="determinate"){const j=2*Math.PI*((T-u)/2);b.strokeDasharray=j.toFixed(3),C["aria-valuenow"]=Math.round(D),b.strokeDashoffset=`${((100-D)/100*j).toFixed(3)}px`,v.transform="rotate(-90deg)"}return t.jsx(Ke,{className:q(y.root,o),style:{width:n,height:n,...v,...p},ownerState:g,ref:a,role:"progressbar",...C,...d,children:t.jsx(ze,{className:y.svg,ownerState:g,viewBox:`${T/2} ${T/2} ${T} ${T}`,children:t.jsx(Qe,{className:y.circle,style:b,ownerState:g,cx:T,cy:T,r:(T-u)/2,fill:"none",strokeWidth:u})})})});function He(r){return U("MuiDialog",r)}const te=O("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ye=m.createContext({}),Xe=P(_e,{name:"MuiDialog",slot:"Backdrop",overrides:(r,e)=>e.backdrop})({zIndex:-1}),Ze=r=>{const{classes:e,scroll:a,maxWidth:s,fullWidth:o,fullScreen:l}=r,i={root:["root"],container:["container",`scroll${k(a)}`],paper:["paper",`paperScroll${k(a)}`,`paperWidth${k(String(s))}`,o&&"paperFullWidth",l&&"paperFullScreen"]};return V(i,He,e)},Ge=P(ke,{name:"MuiDialog",slot:"Root",overridesResolver:(r,e)=>e.root})({"@media print":{position:"absolute !important"}}),Je=P("div",{name:"MuiDialog",slot:"Container",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.container,e[`scroll${k(a.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),et=P(se,{name:"MuiDialog",slot:"Paper",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.paper,e[`scrollPaper${k(a.scroll)}`],e[`paperWidth${k(String(a.maxWidth))}`],a.fullWidth&&e.paperFullWidth,a.fullScreen&&e.paperFullScreen]}})(G(({theme:r})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:r.breakpoints.unit==="px"?Math.max(r.breakpoints.values.xs,444):`max(${r.breakpoints.values.xs}${r.breakpoints.unit}, 444px)`,[`&.${te.paperScrollBody}`]:{[r.breakpoints.down(Math.max(r.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(r.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${r.breakpoints.values[e]}${r.breakpoints.unit}`,[`&.${te.paperScrollBody}`]:{[r.breakpoints.down(r.breakpoints.values[e]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${te.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),de=m.forwardRef(function(e,a){const s=E({props:e,name:"MuiDialog"}),o=Se(),l={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":n,"aria-modal":p=!0,BackdropComponent:u,BackdropProps:D,children:w,className:d,disableEscapeKeyDown:g=!1,fullScreen:y=!1,fullWidth:b=!1,maxWidth:v="sm",onBackdropClick:C,onClick:j,onClose:c,open:x,PaperComponent:R=se,PaperProps:A={},scroll:$="paper",TransitionComponent:K=De,transitionDuration:N=l,TransitionProps:z,...Q}=s,W={...s,disableEscapeKeyDown:g,fullScreen:y,fullWidth:b,maxWidth:v,scroll:$},M=Ze(W),J=m.useRef(),be=I=>{J.current=I.target===I.currentTarget},ve=I=>{j&&j(I),J.current&&(J.current=null,C&&C(I),c&&c(I,"backdropClick"))},ee=Pe(n),Ce=m.useMemo(()=>({titleId:ee}),[ee]);return t.jsx(Ge,{className:q(M.root,d),closeAfterTransition:!0,components:{Backdrop:Xe},componentsProps:{backdrop:{transitionDuration:N,as:u,...D}},disableEscapeKeyDown:g,onClose:c,open:x,ref:a,onClick:ve,ownerState:W,...Q,children:t.jsx(K,{appear:!0,in:x,timeout:N,role:"presentation",...z,children:t.jsx(Je,{className:q(M.container),onMouseDown:be,ownerState:W,children:t.jsx(et,{as:R,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":ee,"aria-modal":p,...A,className:q(M.paper,A.className),ownerState:W,children:t.jsx(ye.Provider,{value:Ce,children:w})})})})})});function tt(r){return U("MuiDialogActions",r)}O("MuiDialogActions",["root","spacing"]);const rt=r=>{const{classes:e,disableSpacing:a}=r;return V({root:["root",!a&&"spacing"]},tt,e)},at=P("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.root,!a.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:r})=>!r.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),ue=m.forwardRef(function(e,a){const s=E({props:e,name:"MuiDialogActions"}),{className:o,disableSpacing:l=!1,...i}=s,n={...s,disableSpacing:l},p=rt(n);return t.jsx(at,{className:q(p.root,o),ownerState:n,ref:a,...i})});function st(r){return U("MuiDialogContent",r)}O("MuiDialogContent",["root","dividers"]);function ot(r){return U("MuiDialogTitle",r)}const it=O("MuiDialogTitle",["root"]),nt=r=>{const{classes:e,dividers:a}=r;return V({root:["root",a&&"dividers"]},st,e)},lt=P("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.root,a.dividers&&e.dividers]}})(G(({theme:r})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(r.vars||r).palette.divider}`,borderBottom:`1px solid ${(r.vars||r).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${it.root} + &`]:{paddingTop:0}}}]}))),pe=m.forwardRef(function(e,a){const s=E({props:e,name:"MuiDialogContent"}),{className:o,dividers:l=!1,...i}=s,n={...s,dividers:l},p=nt(n);return t.jsx(lt,{className:q(p.root,o),ownerState:n,ref:a,...i})}),ct=r=>{const{classes:e}=r;return V({root:["root"]},ot,e)},dt=P(fe,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(r,e)=>e.root})({padding:"16px 24px",flex:"0 0 auto"}),me=m.forwardRef(function(e,a){const s=E({props:e,name:"MuiDialogTitle"}),{className:o,id:l,...i}=s,n=s,p=ct(n),{titleId:u=l}=m.useContext(ye);return t.jsx(dt,{component:"h2",className:q(p.root,o),ownerState:n,ref:a,variant:"h6",id:l??u,...i})}),ut=()=>le({queryKey:["products"],queryFn:async()=>(await B.get("/products")).data.data}),pt=()=>{const r=oe();return ce({mutationFn:async e=>(await B.post("/products",e)).data,onSuccess:()=>{r.invalidateQueries("products")}})},mt=()=>le({queryKey:["categories"],queryFn:async()=>(await B.get("/product-categories")).data.data}),xt=()=>{const r=oe();return ce({mutationFn:async e=>(await B.post("/product-categories",e)).data,onSuccess:()=>{r.invalidateQueries("categories")}})},gt=()=>le({queryKey:["attributes"],queryFn:async()=>(await B.get("/attributes")).data.data}),ht=()=>{const r=oe();return ce({mutationFn:async e=>(await B.post("/attributes",e)).data,onSuccess:()=>{r.invalidateQueries("attributes")}})},ft=Z().shape({name:F().min(2,"Too Short!").max(100,"Too Long!").required("Required"),prefix:F().matches(/^[A-Za-z0-9]{3}$/,"Must be exactly 3 alphanumeric characters").required("Required"),description:F().nullable()}),yt=({open:r,handleClose:e})=>{const a=xt();return t.jsxs(de,{open:r,onClose:e,children:[t.jsx(me,{children:"Add New Category"}),t.jsx(ie,{initialValues:{name:"",prefix:"",description:""},validationSchema:ft,onSubmit:async(s,{setSubmitting:o,resetForm:l})=>{try{await a.mutateAsync(s),l(),e()}catch(i){console.error("Error creating category:",i)}finally{o(!1)}},children:({errors:s,touched:o,isSubmitting:l})=>t.jsxs(ne,{children:[t.jsxs(pe,{children:[t.jsx(f,{as:h,name:"name",label:"Category Name",fullWidth:!0,margin:"normal",error:o.name&&s.name,helperText:o.name&&s.name}),t.jsx(f,{as:h,name:"prefix",label:"Category Prefix (3 characters)",fullWidth:!0,margin:"normal",error:o.prefix&&s.prefix,helperText:o.prefix&&s.prefix}),t.jsx(f,{as:h,name:"description",label:"Description",fullWidth:!0,margin:"normal",multiline:!0,rows:3,error:o.description&&s.description,helperText:o.description&&s.description})]}),t.jsxs(ue,{children:[t.jsx(S,{onClick:e,children:"Cancel"}),t.jsx(S,{type:"submit",disabled:l,variant:"contained",color:"primary",children:l?"Adding...":"Add Category"})]})]})})]})},bt=Z().shape({product_name:F().min(2,"Too Short!").max(100,"Too Long!").required("Required"),product_category_id:Y().required("Required"),reorder_level:Y().min(0,"Must be 0 or greater").required("Required"),product_type:F().oneOf(["raw","finished","custom"],"Invalid product type").required("Required"),attributes:Te().of(Z().shape({attribute_id:Y().required("Required"),value:Y().required("Required")}))}),vt=({open:r,handleClose:e,categories:a})=>{const s=pt(),{data:o=[]}=gt();return t.jsxs(de,{open:r,onClose:e,maxWidth:"md",fullWidth:!0,children:[t.jsx(me,{children:"Add New Product"}),t.jsx(ie,{initialValues:{product_name:"",product_category_id:"",reorder_level:0,product_type:"raw",attributes:[]},validationSchema:bt,onSubmit:async(l,{setSubmitting:i,resetForm:n})=>{try{await s.mutateAsync(l),n(),e()}catch(p){console.error("Error creating product:",p)}finally{i(!1)}},children:({values:l,errors:i,touched:n,isSubmitting:p})=>t.jsxs(ne,{children:[t.jsxs(pe,{children:[t.jsx(f,{as:h,name:"product_name",label:"Product Name",fullWidth:!0,margin:"normal",error:n.product_name&&i.product_name,helperText:n.product_name&&i.product_name}),t.jsx(f,{as:h,select:!0,name:"product_category_id",label:"Category",fullWidth:!0,margin:"normal",error:n.product_category_id&&i.product_category_id,helperText:n.product_category_id&&i.product_category_id,children:a.map(u=>t.jsx(L,{value:u.id,children:u.name},u.id))}),t.jsx(f,{as:h,name:"reorder_level",label:"Reorder Level",type:"number",fullWidth:!0,margin:"normal",error:n.reorder_level&&i.reorder_level,helperText:n.reorder_level&&i.reorder_level}),t.jsxs(f,{as:h,select:!0,name:"product_type",label:"Product Type",fullWidth:!0,margin:"normal",error:n.product_type&&i.product_type,helperText:n.product_type&&i.product_type,children:[t.jsx(L,{value:"raw",children:"Raw Material"}),t.jsx(L,{value:"finished",children:"Finished Product"}),t.jsx(L,{value:"custom",children:"Custom Product"})]}),t.jsx(we,{sx:{my:2}}),t.jsx(fe,{variant:"subtitle1",gutterBottom:!0,children:"Product Attributes"}),t.jsx(Re,{name:"attributes",children:({push:u,remove:D})=>t.jsxs(X,{children:[l.attributes.map((w,d)=>{var g,y,b,v,C,j,c,x,R,A,$,K,N,z,Q,W;return t.jsxs(X,{sx:{display:"flex",gap:2,mb:2},children:[t.jsx(f,{as:h,select:!0,name:`attributes.${d}.attribute_id`,label:"Attribute",fullWidth:!0,error:((y=(g=n.attributes)==null?void 0:g[d])==null?void 0:y.attribute_id)&&((v=(b=i.attributes)==null?void 0:b[d])==null?void 0:v.attribute_id),helperText:((j=(C=n.attributes)==null?void 0:C[d])==null?void 0:j.attribute_id)&&((x=(c=i.attributes)==null?void 0:c[d])==null?void 0:x.attribute_id),children:o.map(M=>t.jsxs(L,{value:M.id,children:[M.attribute_name," (",M.unit_of_measurement,")"]},M.id))}),t.jsx(f,{as:h,name:`attributes.${d}.value`,label:"Value",type:"number",fullWidth:!0,error:((A=(R=n.attributes)==null?void 0:R[d])==null?void 0:A.value)&&((K=($=i.attributes)==null?void 0:$[d])==null?void 0:K.value),helperText:((z=(N=n.attributes)==null?void 0:N[d])==null?void 0:z.value)&&((W=(Q=i.attributes)==null?void 0:Q[d])==null?void 0:W.value)}),t.jsx(Ae,{onClick:()=>D(d),color:"error",children:t.jsx($e,{})})]},d)}),t.jsx(S,{type:"button",onClick:()=>u({attribute_id:"",value:""}),startIcon:t.jsx(H,{}),variant:"outlined",fullWidth:!0,children:"Add Attribute"})]})})]}),t.jsxs(ue,{children:[t.jsx(S,{onClick:e,children:"Cancel"}),t.jsx(S,{type:"submit",disabled:p,variant:"contained",color:"primary",children:p?"Adding...":"Add Product"})]})]})})]})},Ct=Z().shape({attribute_name:F().required("Required").min(2,"Too Short!").max(100,"Too Long!"),unit_of_measurement:F().required("Required").max(50,"Too Long!")}),jt=({open:r,handleClose:e})=>{const a=ht();return t.jsxs(de,{open:r,onClose:e,children:[t.jsx(me,{children:"Add New Attribute"}),t.jsx(ie,{initialValues:{attribute_name:"",unit_of_measurement:""},validationSchema:Ct,onSubmit:async(s,{setSubmitting:o,resetForm:l})=>{try{await a.mutateAsync(s),l(),e()}catch(i){console.error("Error creating attribute:",i)}finally{o(!1)}},children:({errors:s,touched:o,isSubmitting:l})=>t.jsxs(ne,{children:[t.jsxs(pe,{children:[t.jsx(f,{as:h,name:"attribute_name",label:"Attribute Name",fullWidth:!0,margin:"normal",error:o.attribute_name&&s.attribute_name,helperText:o.attribute_name&&s.attribute_name}),t.jsx(f,{as:h,name:"unit_of_measurement",label:"Unit of Measurement",fullWidth:!0,margin:"normal",error:o.unit_of_measurement&&s.unit_of_measurement,helperText:o.unit_of_measurement&&s.unit_of_measurement})]}),t.jsxs(ue,{children:[t.jsx(S,{onClick:e,children:"Cancel"}),t.jsx(S,{type:"submit",disabled:l,variant:"contained",color:"primary",children:l?"Adding...":"Add Attribute"})]})]})})]})},Dt=()=>{const[r,e]=m.useState(0),[a,s]=m.useState(10),[o,l]=m.useState(""),[i,n]=m.useState(!1),[p,u]=m.useState(!1),[D,w]=m.useState(!1),{data:d,isLoading:g}=ut(),{data:y,isLoading:b}=mt(),v=(d==null?void 0:d.filter(c=>{var x,R,A,$;return((x=c.product_code)==null?void 0:x.toLowerCase().includes(o.toLowerCase()))||((R=c.product_name)==null?void 0:R.toLowerCase().includes(o.toLowerCase()))||(($=(A=c.category)==null?void 0:A.name)==null?void 0:$.toLowerCase().includes(o.toLowerCase()))}))||[],C=(c,x)=>{e(x)},j=c=>{s(parseInt(c.target.value,10)),e(0)};return g||b?t.jsx(Ye,{}):t.jsxs(We,{maxWidth:"xxl",sx:{mt:0,p:"0!important"},children:[t.jsxs(X,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(h,{placeholder:"Search products...",variant:"outlined",size:"small",value:o,onChange:c=>l(c.target.value),InputProps:{startAdornment:t.jsx(Me,{position:"start",children:t.jsx(qe,{})})}}),t.jsxs(X,{children:[t.jsx(S,{variant:"contained",onClick:()=>u(!0),startIcon:t.jsx(H,{}),color:"error",children:"Add Product"}),t.jsx(S,{variant:"contained",onClick:()=>n(!0),startIcon:t.jsx(H,{}),sx:{ml:1},color:"info",children:"Add Category"}),t.jsx(S,{variant:"contained",onClick:()=>w(!0),startIcon:t.jsx(H,{}),sx:{ml:1},color:"success",children:"Add Attribute"})]})]}),t.jsx(Fe,{component:se,children:t.jsxs(Ie,{children:[t.jsx(Be,{children:t.jsxs(xe,{children:[t.jsx(_,{children:"Code"}),t.jsx(_,{children:"Name"}),t.jsx(_,{children:"Category"}),t.jsx(_,{children:"Reorder Level"}),t.jsx(_,{children:"Actions"})]})}),t.jsx(Ne,{children:v.slice(r*a,r*a+a).map(c=>{var x;return t.jsxs(xe,{children:[t.jsx(_,{children:c.product_code}),t.jsx(_,{children:c.product_name}),t.jsx(_,{children:(x=c.category)==null?void 0:x.name}),t.jsx(_,{children:c.reorder_level}),t.jsx(_,{})]},c.id)})})]})}),t.jsx(Le,{rowsPerPageOptions:[5,10,25],component:"div",count:v.length,rowsPerPage:a,page:r,onPageChange:C,onRowsPerPageChange:j}),t.jsx(yt,{open:i,handleClose:()=>n(!1)}),t.jsx(vt,{open:p,handleClose:()=>u(!1),categories:y||[]}),t.jsx(jt,{open:D,handleClose:()=>w(!1)})]})};export{Dt as default};

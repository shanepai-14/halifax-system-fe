import{a8 as j,a9 as b,$ as h,t as u,a7 as T,j as e,q as c,T as a,D as p,P as F}from"./index-CwdxULia.js";import{d as _,e as v,a as x,b as t,f as W}from"./TextField-D4xNUZye.js";function N(){const s=j();return b({mutationFn:async r=>(await h.post("/purchase-orders/receiving-reports",r)).data,onSuccess:(r,n)=>{s.invalidateQueries(["purchaseOrder",n.po_id]),u.success("Receiving report created successfully")},onError:r=>{var n,d;return console.error("Error creating receiving report:",r),u.error(((d=(n=r.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to create receiving report"),Promise.reject(r)}})}function E(){const s=j();return b({mutationFn:async({rrID:r,data:n})=>(await h.put(`/purchase-orders/${r}/receiving-reports`,n)).data,onSuccess:(r,n)=>{s.invalidateQueries(["purchaseOrder"]),u.success("Receiving report updated successfully")},onError:r=>{var n,d;return console.error("Error updating receiving report:",r),u.error(((d=(n=r.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to update receiving report"),Promise.reject(r)}})}function q(s={}){return T({queryKey:["receiving-reports",s],queryFn:async()=>(await h.get("/receiving-reports",{params:s})).data.data})}function A(){const s=j();return b({mutationFn:async({id:r,isPaid:n})=>(await h.put(`/receiving-reports/${r}/payment-status`,{is_paid:n})).data,onSuccess:r=>{var n;s.invalidateQueries(["receiving-reports"]),(n=r.data)!=null&&n.po_id&&s.invalidateQueries(["purchase-orders",r.data.po_id]),u.success(`Payment status ${r.data.is_paid?"marked as paid":"marked as unpaid"}`)},onError:r=>{var n,d;console.error("Error updating payment status:",r),u.error(((d=(n=r.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to update payment status")}})}function S(){return T({queryKey:["receiving-reports-stats"],queryFn:async()=>(await h.get("/receiving-reports/stats")).data.data})}const k=({receivingReport:s,contentRef:r})=>{var m,g,f,y;if(!s)return null;const n=i=>(i==null?void 0:i.reduce((l,o)=>l+o.cost_price*o.received_quantity,0))||0,d=i=>(i==null?void 0:i.reduce((l,o)=>l+(Number(o.amount)||0),0))||0,P=()=>{const i=n(s.received_items),l=d(s.additional_costs);return i+l};return e.jsxs(c,{ref:r,sx:{display:"none","@media print":{display:"block",p:4,bgcolor:"white"}},children:[e.jsxs(c,{sx:{mb:4,textAlign:"center"},children:[e.jsx(a,{variant:"h4",sx:{mb:1,fontWeight:"bold"},children:"RECEIVING REPORT"}),e.jsxs(a,{variant:"h6",children:["Batch Number: ",s.batch_number]})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[e.jsxs(c,{children:[e.jsx(a,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Supplier Information:"}),e.jsx(a,{children:(m=s.supplier)==null?void 0:m.supplier_name}),e.jsx(a,{children:(g=s.supplier)==null?void 0:g.address}),e.jsx(a,{children:(f=s.supplier)==null?void 0:f.contact_number})]}),e.jsxs(c,{sx:{textAlign:"right"},children:[e.jsxs(a,{sx:{mb:1},children:[e.jsx("strong",{children:"PO Number:"})," ",s.po_number]}),e.jsxs(a,{sx:{mb:1},children:[e.jsx("strong",{children:"Date Received:"})," ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs(a,{sx:{mb:1},children:[e.jsx("strong",{children:"Payment Status:"})," ",s.is_paid?"PAID":"UNPAID"]}),e.jsxs(a,{children:[e.jsx("strong",{children:"Invoice Number:"})," ",s.invoice?s.invoice:"NO INVOICE YET"]}),s.term>0&&e.jsxs(a,{children:[e.jsx("strong",{children:"Payment Terms:"})," ",s.term," days"]})]})]}),e.jsx(p,{sx:{mb:4}}),e.jsx(a,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Received Items"}),e.jsxs(_,{sx:{mb:4},children:[e.jsx(v,{children:e.jsxs(x,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Product"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Received Qty"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Cost Price"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Walk-in Price"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Wholesale Price"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Regular Price"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Total"})]})}),e.jsxs(W,{children:[(y=s.received_items)==null?void 0:y.map((i,l)=>{var o;return e.jsxs(x,{children:[e.jsx(t,{children:(o=i.product)==null?void 0:o.product_name}),e.jsx(t,{children:i.received_quantity}),e.jsxs(t,{children:["₱",Number(i.cost_price).toFixed(2)]}),e.jsxs(t,{children:["₱",Number(i.walk_in_price).toFixed(2)]}),e.jsxs(t,{children:["₱",Number(i.wholesale_price).toFixed(2)]}),e.jsxs(t,{children:["₱",Number(i.regular_price).toFixed(2)]}),e.jsxs(t,{children:["₱",(i.cost_price*i.received_quantity).toFixed(2)]})]},l)}),e.jsxs(x,{children:[e.jsx(t,{colSpan:6,sx:{textAlign:"right",fontWeight:"bold"},children:"Items Total:"}),e.jsxs(t,{sx:{fontWeight:"bold"},children:["₱",n(s.received_items).toFixed(2)]})]})]})]}),s.additional_costs&&s.additional_costs.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Additional Costs"}),e.jsxs(_,{sx:{mb:4},children:[e.jsx(v,{children:e.jsxs(x,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(t,{sx:{fontWeight:"bold"},children:"Cost Type"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Amount"}),e.jsx(t,{sx:{fontWeight:"bold"},children:"Remarks"})]})}),e.jsxs(W,{children:[s.additional_costs.map((i,l)=>{var o;return e.jsxs(x,{children:[e.jsx(t,{children:(o=i.cost_type)==null?void 0:o.name}),e.jsxs(t,{children:["₱",Number(i.amount).toFixed(2)]}),e.jsx(t,{children:i.remarks||"-"})]},l)}),e.jsxs(x,{children:[e.jsx(t,{colSpan:1,sx:{textAlign:"right",fontWeight:"bold"},children:"Additional Costs Total:"}),e.jsxs(t,{sx:{fontWeight:"bold"},children:["₱",d(s.additional_costs).toFixed(2)]}),e.jsx(t,{})]})]})]})]}),e.jsx(c,{sx:{display:"flex",justifyContent:"flex-end",mb:4},children:e.jsx(F,{elevation:1,sx:{p:2,width:"300px"},children:e.jsxs(a,{variant:"h6",sx:{fontWeight:"bold"},children:["Grand Total: ₱",P().toFixed(2)]})})}),e.jsx(c,{sx:{mt:6},children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",mt:8},children:[e.jsxs(c,{sx:{width:"200px"},children:[e.jsx(p,{}),e.jsx(a,{sx:{mt:1},children:"Received by"})]}),e.jsxs(c,{sx:{width:"200px"},children:[e.jsx(p,{}),e.jsx(a,{sx:{mt:1},children:"Verified by"})]})]})})]})};export{k as P,E as a,q as b,S as c,A as d,N as u};

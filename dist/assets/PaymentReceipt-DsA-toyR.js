import{r as b,a8 as D,a9 as H,aC as L,S as j,b9 as $,ba as M,bb as z,bc as N,a$ as O,bd as q,be as I,$ as p,bf as G,bg as F,t as u,bh as V,bi as U,bj as W,bk as Y,bl as Q,bm as J,j as e,q as m,T as t,P as w,G as c,D as K}from"./index-DNRk7xG9.js";import{l as X}from"./index-DifcCCYm.js";import{B}from"./InputLabel-DVcin1Fw.js";import{R as Z}from"./PrinterOutlined-DGNdqUgd.js";import{R as ee}from"./CloseOutlined-B_XHIcrp.js";import{c as te,d as se,e as re,a as k,b as y,f as ne}from"./TextField-qX0ABBN6.js";var ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},ie=function(f,h){return b.createElement(D,H({},f,{ref:h,icon:ae}))},je=b.forwardRef(ie);const pe=()=>{const r=L(),[f,h]=b.useState(!1),[S,i]=b.useState(null),n=j($),v=j(M),g=j(z),A=j(N),C=j(O),_=j(q);return{payments:n,currentPayment:v,isLoading:f||g,error:S||A,filters:C,stats:_,getAllPayments:async(x={})=>{var l,a;try{r(I());const s=await p.get("/payments",{params:x});return r(G(s.data.data)),s.data.data}catch(s){return console.error("Error fetching payments:",s),r(F(s.message)),u.error(((a=(l=s.response)==null?void 0:l.data)==null?void 0:a.message)||"Failed to fetch payments"),[]}},getPaymentById:async x=>{var l,a;try{r(I());const s=await p.get(`/payments/${x}`);return r(V(s.data.data)),s.data.data}catch(s){return console.error("Error fetching payment:",s),r(F(s.message)),u.error(((a=(l=s.response)==null?void 0:l.data)==null?void 0:a.message)||"Failed to fetch payment"),null}},createPayment:async(x,l)=>{var a,s;try{h(!0),i(null),r(U());const d=await p.post(`/payments/${x}`,l);return r(W(d.data.data)),u.success("Payment recorded successfully"),d.data.data}catch(d){throw console.error("Error creating payment:",d),i(d.message||"Failed to create payment"),r(Y(d.message||"Failed to create payment")),u.error(((s=(a=d.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to record payment"),d}finally{h(!1)}},getPaymentHistory:async x=>{var l,a;try{return h(!0),i(null),(await p.get(`/payments/${x}/history`)).data.data}catch(s){return console.error("Error fetching payment history:",s),i(s.message||"Failed to fetch payment history"),u.error(((a=(l=s.response)==null?void 0:l.data)==null?void 0:a.message)||"Failed to fetch payment history"),[]}finally{h(!1)}},voidPayment:async(x,l)=>{var a,s;try{h(!0),i(null);const d=await p.put(`/payments/${x}/void`,{reason:l});return u.success("Payment voided successfully"),d.data.data}catch(d){throw console.error("Error voiding payment:",d),i(d.message||"Failed to void payment"),u.error(((s=(a=d.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to void payment"),d}finally{h(!1)}},getPaymentStats:async(x={})=>{var l,a;try{const s=await p.get("/payments/stats",{params:x});return r(Q(s.data.data)),s.data.data}catch(s){return console.error("Error fetching payment statistics:",s),u.error(((a=(l=s.response)==null?void 0:l.data)==null?void 0:a.message)||"Failed to fetch payment statistics"),null}},resetCurrentPayment:()=>{r(J())}}},fe=({receipt:r,onClose:f})=>{var C,_,R,T,E;const h=b.useRef(),S=X.useReactToPrint({contentRef:h});if(console.log(r),!r||!r.payment||!r.sale)return null;const{payment:i,sale:n}=r,v=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",g=o=>`â‚±${parseFloat(o).toFixed(2)}`,A=o=>({cash:"Cash",credit_card:"Credit Card",debit_card:"Debit Card",cheque:"Cheque",bank_transfer:"Bank Transfer",online:"Online Payment",mobile_payment:"Mobile Payment",store_credit:"Store Credit"})[o]||o;return e.jsxs(m,{sx:{p:2},children:[e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(t,{variant:"h5",children:"Payment Receipt"}),e.jsxs(m,{children:[e.jsx(B,{variant:"outlined",startIcon:e.jsx(Z,{}),onClick:S,sx:{mr:1},children:"Print"}),e.jsx(B,{variant:"outlined",startIcon:e.jsx(ee,{}),onClick:f,children:"Close"})]})]}),e.jsx(w,{elevation:0,sx:{mt:2},children:e.jsxs(m,{ref:h,sx:{p:4},children:[e.jsxs(m,{sx:{textAlign:"center",mb:2},children:[e.jsx(t,{variant:"h4",children:"PAYMENT RECEIPT"}),e.jsx(t,{variant:"h6",children:i.reference_number}),e.jsx(t,{variant:"body2",children:v(i.payment_date)})]}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsxs(c,{item:!0,xs:6,md:6,children:[e.jsx(t,{children:"Halifax Glass & Aluminum Supply"}),e.jsx(t,{children:"Malagamot Road, Panacan"}),e.jsx(t,{children:"glasshalifax@gmail.com"}),e.jsx(t,{children:"0939 924 3876"})]}),e.jsxs(c,{item:!0,xs:6,md:6,sx:{textAlign:{xs:"right",md:"right"}},children:[e.jsxs(t,{children:[e.jsx("strong",{children:"Invoice #:"})," ",n.invoice_number]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Order Date:"})," ",v(n.order_date)]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Payment Status:"})," ",n.is_paid?"PAID":"PARTIALLY PAID"]})]})]}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsxs(c,{item:!0,xs:6,md:6,children:[e.jsx(t,{children:e.jsx("strong",{children:"Bill To:"})}),e.jsx(t,{children:((C=n.customer)==null?void 0:C.customer_name)||"Walk-in Customer"}),e.jsx(t,{children:((_=n.customer)==null?void 0:_.address)||n.address||"N/A"}),e.jsx(t,{children:((R=n.customer)==null?void 0:R.city)||n.city||"N/A"}),e.jsx(t,{children:((T=n.customer)==null?void 0:T.contact_number)||n.phone||"N/A"})]}),e.jsxs(c,{item:!0,xs:6,md:6,sx:{textAlign:{xs:"right",md:"right"}},children:[e.jsx(t,{children:e.jsx("strong",{children:"Payment Info:"})}),e.jsxs(t,{children:[e.jsx("strong",{children:"Method:"})," ",A(i.payment_method)]}),i.reference_number&&e.jsxs(t,{children:[e.jsx("strong",{children:"Reference #:"})," ",i.reference_number]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Received By:"})," ",((E=i.received_by)==null?void 0:E.customer_name)||"System"]})]})]}),e.jsxs(m,{sx:{mb:1},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Items Summary"}),e.jsx(te,{component:w,variant:"outlined",children:e.jsxs(se,{size:"small",children:[e.jsx(re,{children:e.jsxs(k,{children:[e.jsx(y,{children:"Item"}),e.jsx(y,{align:"right",children:"Qty"}),e.jsx(y,{align:"right",children:"Unit Price"}),e.jsx(y,{align:"right",children:"Subtotal"})]})}),e.jsx(ne,{children:n.items.map(o=>{var P;return e.jsxs(k,{children:[e.jsx(y,{children:((P=o.product)==null?void 0:P.product_name)||`Product #${o.product_id}`}),e.jsx(y,{align:"right",children:o.quantity}),e.jsx(y,{align:"right",children:g(o.sold_price)}),e.jsx(y,{align:"right",children:g(o.total_sold_price)})]},o.id)})})]})})]}),e.jsx(K,{sx:{my:1}}),e.jsx(m,{sx:{mb:3},children:e.jsxs(c,{container:!0,spacing:1,children:[e.jsx(c,{item:!0,xs:6,children:e.jsx(t,{children:e.jsx("strong",{children:"Sale Total:"})})}),e.jsx(c,{item:!0,xs:6,sx:{textAlign:"right"},children:e.jsx(t,{children:g(n.total)})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(t,{children:e.jsx("strong",{children:"This Payment:"})})}),e.jsx(c,{item:!0,xs:6,sx:{textAlign:"right"},children:e.jsx(t,{sx:{fontWeight:"bold"},children:g(i.amount)})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(t,{children:e.jsx("strong",{children:"Remaining Balance:"})})}),e.jsx(c,{item:!0,xs:6,sx:{textAlign:"right"},children:e.jsx(t,{children:g(n.total-n.amount_received)})})]})}),(i.remarks||n.remarks)&&e.jsxs(m,{sx:{mb:3},children:[e.jsx(t,{gutterBottom:!0,children:"Notes:"}),e.jsx(t,{children:i.remarks||n.remarks})]}),e.jsx(m,{sx:{mt:4,pt:2},children:e.jsxs(c,{container:!0,spacing:6,children:[e.jsx(c,{item:!0,xs:6,children:e.jsx(m,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Customer Signature"})})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(m,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Authorized Signature"})})})]})}),e.jsx(m,{sx:{mt:4,textAlign:"center"},children:e.jsx(t,{children:"Thank you for your business!"})})]})})]})};export{fe as P,je as R,pe as u};

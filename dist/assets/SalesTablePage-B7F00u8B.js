import{r as h,a8 as J,a9 as X,j as e,T as n,Q as Z,aC as ee,S as te,aD as ae,aB as se,G as l,C as g,x as f,q as re,E as _,I as ne,F as w,P as le,y as T,aE as I,aF as ie,aG as de,aH as k}from"./index-jDIXAb2S.js";import{a as j,b as a,T as b,S as R,c as ce,d as oe,e as he,f as xe}from"./TextField-BKTWEUZi.js";import{S as d}from"./Skeleton-Cb0-qA4q.js";import{C as ue}from"./Container-Cg-bcfkS.js";import{R as je,M as c}from"./SearchOutlined-DwJHkhgR.js";import{I as z,B as me}from"./InputLabel-GSHbBSGO.js";import{R as pe}from"./PlusOutlined-DQ8S9d5x.js";import{T as ve}from"./TablePagination-BzzPB1rl.js";var ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},fe=function(o,s){return h.createElement(J,X({},o,{ref:s,icon:ge}))},be=h.forwardRef(fe);const ye=({key:i})=>e.jsxs(j,{children:[e.jsx(a,{children:e.jsx(d,{width:100,height:24,variant:"text"})}),e.jsxs(a,{children:[e.jsx(d,{width:120,height:24,variant:"text"}),e.jsx(n,{variant:"caption",display:"block",children:e.jsx(d,{width:80,height:16,variant:"text"})})]}),e.jsx(a,{children:e.jsx(d,{width:80,height:32,variant:"rounded"})}),e.jsx(a,{children:e.jsx(d,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(d,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(d,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(d,{width:60,height:24,variant:"text"})}),e.jsx(a,{align:"right",children:e.jsx(d,{width:80,height:24,variant:"text",sx:{ml:"auto"}})}),e.jsx(a,{children:e.jsx(d,{width:60,height:32,variant:"rounded"})})]},i),y=i=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(i),E=i=>i?new Date(i).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"}):"-",ke=()=>{const i=Z(),o=ee(),s=te(ae),{sales:x,getAllSales:L,getSalesStats:W}=se(),[m,p]=h.useState(0),[u,A]=h.useState(10),[S,Se]=h.useState(s.searchTerm),[B,C]=h.useState(!0),[v,H]=h.useState({total_sales:0,total_revenue:0,total_profit:0});h.useEffect(()=>{D()},[s.statusFilter,s.deliveredFilter,s.startDate,s.endDate]);const D=async()=>{C(!0);const t={status:s.statusFilter!=="all"?s.statusFilter:void 0,is_delivered:s.deliveredFilter!=="all"?s.deliveredFilter==="true":void 0,date_from:s.startDate||void 0,date_to:s.endDate||void 0,search:s.searchTerm||void 0};await L(t);const r={date_from:t.date_from,date_to:t.date_to},F=await W(r);F&&H(F),C(!1)},O=(t,r)=>{p(r)},M=t=>{A(parseInt(t.target.value,10)),p(0)},N=t=>{I(t.target.value)},P=()=>{o(I(S)),p(0),D()},V=t=>{t.key==="Enter"&&P()},$=t=>{o(ie(t.target.value))},G=t=>{o(de(t.target.value))},U=t=>{o(k({startDate:t.target.value,endDate:s.endDate}))},K=t=>{o(k({startDate:s.startDate,endDate:t.target.value}))},q=()=>{i("/app/sales")},Q=t=>{i(`/app/delivery-report/${t}`)},Y=t=>{let r;switch(t){case"completed":r="success";break;case"pending":r="warning";break;case"cancelled":r="error";break;case"partially_paid":r="info";break;case"unpaid":r="default";break;default:r="default"}return e.jsx(T,{label:t.replace("_"," ").toUpperCase(),color:r,size:"small"})};return e.jsxs(ue,{maxWidth:"xxl",sx:{mt:0,p:"0!important"},children:[e.jsxs(l,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(g,{children:e.jsxs(f,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Sales"}),e.jsx(n,{variant:"h4",children:v.total_sales||0}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(g,{children:e.jsxs(f,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Revenue"}),e.jsx(n,{variant:"h4",children:y(v.total_revenue||0)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(g,{children:e.jsxs(f,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Profit"}),e.jsx(n,{variant:"h4",children:y(v.total_profit||0)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})})]}),e.jsx(re,{sx:{mb:3},children:e.jsxs(l,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(l,{item:!0,xs:12,md:3,children:e.jsx(b,{fullWidth:!0,placeholder:"Search by invoice number",variant:"outlined",size:"small",value:S,onChange:N,onKeyPress:V,InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(je,{})}),endAdornment:e.jsx(_,{position:"end",children:e.jsx(ne,{onClick:P,size:"small",children:e.jsx(be,{})})})}})}),e.jsx(l,{item:!0,xs:6,md:2,children:e.jsxs(w,{fullWidth:!0,size:"small",children:[e.jsx(z,{children:"Status"}),e.jsxs(R,{value:s.statusFilter,onChange:$,label:"Status",children:[e.jsx(c,{value:"all",children:"All Status"}),e.jsx(c,{value:"pending",children:"Pending"}),e.jsx(c,{value:"completed",children:"Completed"}),e.jsx(c,{value:"partially_paid",children:"Partially Paid"}),e.jsx(c,{value:"unpaid",children:"Unpaid"}),e.jsx(c,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(l,{item:!0,xs:6,md:2,children:e.jsxs(w,{fullWidth:!0,size:"small",children:[e.jsx(z,{children:"Delivery Status"}),e.jsxs(R,{value:s.deliveredFilter,onChange:G,label:"Delivery Status",children:[e.jsx(c,{value:"all",children:"All"}),e.jsx(c,{value:"true",children:"Delivered"}),e.jsx(c,{value:"false",children:"Not Delivered"})]})]})}),e.jsx(l,{item:!0,xs:6,md:2,children:e.jsx(b,{label:"Start Date",type:"date",value:s.startDate,onChange:U,InputLabelProps:{shrink:!0},size:"small",fullWidth:!0})}),e.jsx(l,{item:!0,xs:6,md:2,children:e.jsx(b,{label:"End Date",type:"date",value:s.endDate,onChange:K,InputLabelProps:{shrink:!0},size:"small",fullWidth:!0,inputProps:{min:s.startDate}})}),e.jsx(l,{item:!0,xs:12,md:1,children:e.jsx(me,{variant:"contained",color:"primary",startIcon:e.jsx(pe,{}),onClick:q,fullWidth:!0,children:"Sale"})})]})}),e.jsx(ce,{component:le,children:e.jsxs(oe,{size:"small",children:[e.jsx(he,{children:e.jsxs(j,{children:[e.jsx(a,{children:"Invoice #"}),e.jsx(a,{children:"Customer"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Payment Method"}),e.jsx(a,{children:"Order Date"}),e.jsx(a,{children:"Delivery Date"}),e.jsx(a,{children:"City"}),e.jsx(a,{align:"right",children:"Total"}),e.jsx(a,{children:"Delivered"})]})}),e.jsx(xe,{children:B?Array(u).fill(0).map((t,r)=>e.jsx(ye,{},r)):x&&x.length>0?x.slice(m*u,m*u+u).map(t=>e.jsxs(j,{children:[e.jsx(a,{children:e.jsx(n,{variant:"body1",fontWeight:"bold",sx:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>Q(t.id),children:t.invoice_number})}),e.jsx(a,{children:t.customer?e.jsxs(e.Fragment,{children:[t.customer.customer_name,t.customer.business_name&&e.jsx(n,{variant:"caption",display:"block",sx:{color:"text.secondary"},children:t.customer.business_name})]}):"Walk-in Customer"}),e.jsx(a,{children:Y(t.status)}),e.jsx(a,{children:t.payment_method.toUpperCase()}),e.jsx(a,{children:E(t.order_date)}),e.jsx(a,{children:E(t.delivery_date)}),e.jsx(a,{children:t.city||"-"}),e.jsx(a,{align:"right",children:y(t.total)}),e.jsx(a,{children:e.jsx(T,{label:t.is_delivered?"YES":"NO",color:t.is_delivered?"success":"default",size:"small"})})]},t.id)):e.jsx(j,{children:e.jsx(a,{colSpan:10,align:"center",children:e.jsx(n,{variant:"body1",sx:{py:2},children:"No sales found"})})})})]})}),e.jsx(ve,{rowsPerPageOptions:[5,10,25,50],component:"div",count:x?x.length:0,rowsPerPage:u,page:m,onPageChange:O,onRowsPerPageChange:M})]})};export{ke as default};

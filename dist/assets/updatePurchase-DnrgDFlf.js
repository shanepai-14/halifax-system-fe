import{a as W,g as E,d as O,j as t,s as y,P as Y,e as _,m as H,r as x,u as V,ag as re,I as de,c as N,b as G,aj as he,ak as ge,i as te,al as Pe,am as we,T as J,W as Re,an as Ae,ao as ke,Q as $e,q as Q,E as ze,G as k,t as be}from"./index-D1JMdfBH.js";import{S as se}from"./sweetalert2.esm.all-D3pEHXw3.js";import{b as Te,c as De,d as qe}from"./usePurchaseOrders-o6fHjbgT.js";import{l as _e,P as Ne,a as Oe}from"./Print-IO7azQ3L.js";import{D as Ue,a as Be,b as Fe,c as We,g as Ee}from"./fileHelper-4QT21A26.js";import{C as He,T as K,c as Ve,d as Ge,e as Qe,a as ye,b as z,f as Ze}from"./TextField-CqUPLGNT.js";import{C as Ke}from"./Close-DPiaitBZ.js";import{L as Ye}from"./Link-DUa5IdjW.js";import{B as ee}from"./InputLabel-DwtkTGL1.js";import{S as Z}from"./Skeleton-NE3iTNM7.js";function Je(e){return W("MuiAlert",e)}const Ce=E("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Xe=O(t.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),et=O(t.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),tt=O(t.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),rt=O(t.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),at=e=>{const{variant:r,color:a,severity:o,classes:s}=e,d={root:["root",`color${_(a||o)}`,`${r}${_(a||o)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return G(d,Je,s)},ot=y(Y,{name:"MuiAlert",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`${a.variant}${_(a.color||a.severity)}`]]}})(H(({theme:e})=>{const r=e.palette.mode==="light"?he:ge,a=e.palette.mode==="light"?ge:he;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(te(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${o}Color`]:r(e.palette[o].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${o}StandardBg`]:a(e.palette[o].light,.9),[`& .${Ce.icon}`]:e.vars?{color:e.vars.palette.Alert[`${o}IconColor`]}:{color:e.palette[o].main}}})),...Object.entries(e.palette).filter(te(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${o}Color`]:r(e.palette[o].light,.6),border:`1px solid ${(e.vars||e).palette[o].light}`,[`& .${Ce.icon}`]:e.vars?{color:e.vars.palette.Alert[`${o}IconColor`]}:{color:e.palette[o].main}}})),...Object.entries(e.palette).filter(te(["dark"])).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${o}FilledColor`],backgroundColor:e.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[o].dark:e.palette[o].main,color:e.palette.getContrastText(e.palette[o].main)}}}))]}})),nt=y("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,r)=>r.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),st=y("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,r)=>r.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),Se=y("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,r)=>r.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),je={success:t.jsx(Xe,{fontSize:"inherit"}),warning:t.jsx(et,{fontSize:"inherit"}),error:t.jsx(tt,{fontSize:"inherit"}),info:t.jsx(rt,{fontSize:"inherit"})},it=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiAlert"}),{action:s,children:d,className:p,closeText:l="Close",color:h,components:v={},componentsProps:m={},icon:c,iconMapping:g=je,onClose:j,role:b="alert",severity:f="success",slotProps:u={},slots:I={},variant:w="standard",...L}=o,C={...o,color:h,severity:f,variant:w,colorSeverity:h||f},P=at(C),q={slots:{closeButton:v.CloseButton,closeIcon:v.CloseIcon,...I},slotProps:{...m,...u}},[R,$]=re("closeButton",{elementType:de,externalForwardedProps:q,ownerState:C}),[T,D]=re("closeIcon",{elementType:Ke,externalForwardedProps:q,ownerState:C});return t.jsxs(ot,{role:b,elevation:0,ownerState:C,className:N(P.root,p),ref:a,...L,children:[c!==!1?t.jsx(nt,{ownerState:C,className:P.icon,children:c||g[f]||je[f]}):null,t.jsx(st,{ownerState:C,className:P.message,children:d}),s!=null?t.jsx(Se,{ownerState:C,className:P.action,children:s}):null,s==null&&j?t.jsx(Se,{ownerState:C,className:P.action,children:t.jsx(R,{size:"small","aria-label":l,title:l,color:"inherit",onClick:j,...$,children:t.jsx(T,{fontSize:"small",...D})})}):null]})});function lt(e){return W("MuiCircularProgress",e)}E("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const B=44,pe=Pe`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,ue=Pe`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`,ct=typeof pe!="string"?we`
        animation: ${pe} 1.4s linear infinite;
      `:null,dt=typeof ue!="string"?we`
        animation: ${ue} 1.4s ease-in-out infinite;
      `:null,pt=e=>{const{classes:r,variant:a,color:o,disableShrink:s}=e,d={root:["root",a,`color${_(o)}`],svg:["svg"],circle:["circle",`circle${_(a)}`,s&&"circleDisableShrink"]};return G(d,lt,r)},ut=y("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`color${_(a.color)}`]]}})(H(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:ct||{animation:`${pe} 1.4s linear infinite`}},...Object.entries(e.palette).filter(te()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}}))]}))),xt=y("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,r)=>r.svg})({display:"block"}),mt=y("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.circle,r[`circle${_(a.variant)}`],a.disableShrink&&r.circleDisableShrink]}})(H(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink,style:dt||{animation:`${ue} 1.4s ease-in-out infinite`}}]}))),vt=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiCircularProgress"}),{className:s,color:d="primary",disableShrink:p=!1,size:l=40,style:h,thickness:v=3.6,value:m=0,variant:c="indeterminate",...g}=o,j={...o,color:d,disableShrink:p,size:l,thickness:v,value:m,variant:c},b=pt(j),f={},u={},I={};if(c==="determinate"){const w=2*Math.PI*((B-v)/2);f.strokeDasharray=w.toFixed(3),I["aria-valuenow"]=Math.round(m),f.strokeDashoffset=`${((100-m)/100*w).toFixed(3)}px`,u.transform="rotate(-90deg)"}return t.jsx(ut,{className:N(b.root,s),style:{width:l,height:l,...u,...h},ownerState:j,ref:a,role:"progressbar",...I,...g,children:t.jsx(xt,{className:b.svg,ownerState:j,viewBox:`${B/2} ${B/2} ${B} ${B}`,children:t.jsx(mt,{className:b.circle,style:f,ownerState:j,cx:B,cy:B,r:(B-v)/2,fill:"none",strokeWidth:v})})})});function ft(e){return W("MuiDialogContentText",e)}E("MuiDialogContentText",["root"]);const ht=e=>{const{classes:r}=e,o=G({root:["root"]},ft,r);return{...r,...o}},gt=y(J,{shouldForwardProp:e=>Re(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,r)=>r.root})({}),bt=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiDialogContentText"}),{children:s,className:d,...p}=o,l=ht(p);return t.jsx(gt,{component:"p",variant:"body1",color:"textSecondary",ref:a,ownerState:p,className:N(l.root,d),...o,classes:l})}),ae=x.createContext({}),me=x.createContext({});function yt(e){return W("MuiStep",e)}E("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Ct=e=>{const{classes:r,orientation:a,alternativeLabel:o,completed:s}=e;return G({root:["root",a,o&&"alternativeLabel",s&&"completed"]},yt,r)},St=y("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.orientation],a.alternativeLabel&&r.alternativeLabel,a.completed&&r.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),jt=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiStep"}),{active:s,children:d,className:p,component:l="div",completed:h,disabled:v,expanded:m=!1,index:c,last:g,...j}=o,{activeStep:b,connector:f,alternativeLabel:u,orientation:I,nonLinear:w}=x.useContext(ae);let[L=!1,C=!1,P=!1]=[s,h,v];b===c?L=s!==void 0?s:!0:!w&&b>c?C=h!==void 0?h:!0:!w&&b<c&&(P=v!==void 0?v:!0);const q=x.useMemo(()=>({index:c,last:g,expanded:m,icon:c+1,active:L,completed:C,disabled:P}),[c,g,m,L,C,P]),R={...o,active:L,orientation:I,alternativeLabel:u,completed:C,disabled:P,expanded:m,component:l},$=Ct(R),T=t.jsxs(St,{as:l,className:N($.root,p),ref:a,ownerState:R,...j,children:[f&&u&&c!==0?f:null,d]});return t.jsx(me.Provider,{value:q,children:f&&!u&&c!==0?t.jsxs(x.Fragment,{children:[f,T]}):T})}),Lt=O(t.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Pt=O(t.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function wt(e){return W("MuiStepIcon",e)}const ie=E("MuiStepIcon",["root","active","completed","error","text"]);var Le;const Mt=e=>{const{classes:r,active:a,completed:o,error:s}=e;return G({root:["root",a&&"active",o&&"completed",s&&"error"],text:["text"]},wt,r)},le=y(Ae,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,r)=>r.root})(H(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${ie.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${ie.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${ie.error}`]:{color:(e.vars||e).palette.error.main}}))),It=y("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,r)=>r.text})(H(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),Rt=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiStepIcon"}),{active:s=!1,className:d,completed:p=!1,error:l=!1,icon:h,...v}=o,m={...o,active:s,completed:p,error:l},c=Mt(m);if(typeof h=="number"||typeof h=="string"){const g=N(d,c.root);return l?t.jsx(le,{as:Pt,className:g,ref:a,ownerState:m,...v}):p?t.jsx(le,{as:Lt,className:g,ref:a,ownerState:m,...v}):t.jsxs(le,{className:g,ref:a,ownerState:m,...v,children:[Le||(Le=t.jsx("circle",{cx:"12",cy:"12",r:"12"})),t.jsx(It,{className:c.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:m,children:h})]})}return h});function At(e){return W("MuiStepLabel",e)}const F=E("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),kt=e=>{const{classes:r,orientation:a,active:o,completed:s,error:d,disabled:p,alternativeLabel:l}=e;return G({root:["root",a,d&&"error",p&&"disabled",l&&"alternativeLabel"],label:["label",o&&"active",s&&"completed",d&&"error",p&&"disabled",l&&"alternativeLabel"],iconContainer:["iconContainer",o&&"active",s&&"completed",d&&"error",p&&"disabled",l&&"alternativeLabel"],labelContainer:["labelContainer",l&&"alternativeLabel"]},At,r)},$t=y("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.orientation]]}})({display:"flex",alignItems:"center",[`&.${F.alternativeLabel}`]:{flexDirection:"column"},[`&.${F.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),zt=y("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,r)=>r.label})(H(({theme:e})=>({...e.typography.body2,display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${F.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${F.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${F.alternativeLabel}`]:{marginTop:16},[`&.${F.error}`]:{color:(e.vars||e).palette.error.main}}))),Tt=y("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,r)=>r.iconContainer})({flexShrink:0,display:"flex",paddingRight:8,[`&.${F.alternativeLabel}`]:{paddingRight:0}}),Dt=y("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,r)=>r.labelContainer})(H(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${F.alternativeLabel}`]:{textAlign:"center"}}))),xe=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiStepLabel"}),{children:s,className:d,componentsProps:p={},error:l=!1,icon:h,optional:v,slots:m={},slotProps:c={},StepIconComponent:g,StepIconProps:j,...b}=o,{alternativeLabel:f,orientation:u}=x.useContext(ae),{active:I,disabled:w,completed:L,icon:C}=x.useContext(me),P=h||C;let q=g;P&&!q&&(q=Rt);const R={...o,active:I,alternativeLabel:f,completed:L,disabled:w,error:l,orientation:u},$=kt(R),T={slots:m,slotProps:{stepIcon:j,...p,...c}},[D,A]=re("label",{elementType:zt,externalForwardedProps:T,ownerState:R}),[X,oe]=re("stepIcon",{elementType:q,externalForwardedProps:T,ownerState:R});return t.jsxs($t,{className:N($.root,d),ref:a,ownerState:R,...b,children:[P||X?t.jsx(Tt,{className:$.iconContainer,ownerState:R,children:t.jsx(X,{completed:L,active:I,error:l,icon:P,...oe})}):null,t.jsxs(Dt,{className:$.labelContainer,ownerState:R,children:[s?t.jsx(D,{...A,className:N($.label,A==null?void 0:A.className),children:s}):null,v]})]})});xe&&(xe.muiName="StepLabel");function qt(e){return W("MuiStepConnector",e)}E("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const _t=e=>{const{classes:r,orientation:a,alternativeLabel:o,active:s,completed:d,disabled:p}=e,l={root:["root",a,o&&"alternativeLabel",s&&"active",d&&"completed",p&&"disabled"],line:["line",`line${_(a)}`]};return G(l,qt,r)},Nt=y("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.orientation],a.alternativeLabel&&r.alternativeLabel,a.completed&&r.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),Ot=y("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.line,r[`line${_(a.orientation)}`]]}})(H(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return{display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:r,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),Ut=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiStepConnector"}),{className:s,...d}=o,{alternativeLabel:p,orientation:l="horizontal"}=x.useContext(ae),{active:h,disabled:v,completed:m}=x.useContext(me),c={...o,alternativeLabel:p,orientation:l,active:h,completed:m,disabled:v},g=_t(c);return t.jsx(Nt,{className:N(g.root,s),ref:a,ownerState:c,...d,children:t.jsx(Ot,{className:g.line,ownerState:c})})});function Bt(e){return W("MuiStepper",e)}E("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const Ft=e=>{const{orientation:r,nonLinear:a,alternativeLabel:o,classes:s}=e;return G({root:["root",r,a&&"nonLinear",o&&"alternativeLabel"]},Bt,s)},Wt=y("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.orientation],a.alternativeLabel&&r.alternativeLabel,a.nonLinear&&r.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),Et=t.jsx(Ut,{}),Ht=x.forwardRef(function(r,a){const o=V({props:r,name:"MuiStepper"}),{activeStep:s=0,alternativeLabel:d=!1,children:p,className:l,component:h="div",connector:v=Et,nonLinear:m=!1,orientation:c="horizontal",...g}=o,j={...o,nonLinear:m,alternativeLabel:d,orientation:c,component:h},b=Ft(j),f=x.Children.toArray(p).filter(Boolean),u=f.map((w,L)=>x.cloneElement(w,{index:L,last:L+1===f.length,...w.props})),I=x.useMemo(()=>({activeStep:s,alternativeLabel:d,connector:v,nonLinear:m,orientation:c}),[s,d,v,m,c]);return t.jsx(ae.Provider,{value:I,children:t.jsx(Wt,{as:h,ownerState:j,className:N(b.root,l),ref:a,...g,children:u})})}),Vt=O(t.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBackOutlined"),Gt=O(t.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"}),"CancelOutlined"),Qt=O(t.jsx("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5z"}),"FileDownloadOutlined"),Zt=()=>t.jsxs(Q,{children:[t.jsx(Z,{variant:"rectangular",width:40,height:40,sx:{mb:2}}),t.jsx(Z,{variant:"rectangular",height:60,sx:{mb:4}}),t.jsx(Z,{variant:"text",sx:{fontSize:"2rem",mb:2}}),t.jsxs(k,{container:!0,spacing:3,children:[t.jsxs(k,{item:!0,xs:12,children:[t.jsx(Z,{variant:"text",sx:{fontSize:"1.2rem",mb:1}}),t.jsx(Z,{variant:"text",sx:{fontSize:"1.2rem",mb:2}})]}),t.jsx(k,{item:!0,xs:12,children:t.jsx(Z,{variant:"rectangular",height:300})})]})]}),ce=[{label:"Pending",value:"pending"},{label:"Partially Received",value:"partially_received"},{label:"Completed",value:"completed"},{label:"Cancelled",value:"cancelled"}],sr=()=>{var ve,fe;const{id:e}=ke(),r=$e(),[a,o]=x.useState({items:[],invoice:"",attachment:""}),s=x.useRef(),d=_e.useReactToPrint({contentRef:s}),[p,l]=x.useState({}),[h,v]=x.useState(0),[m,c]=x.useState(!1),[g,j]=x.useState(""),[b,f]=x.useState(!1),{data:u,isLoading:I,refetch:w}=Te(e),L=De(),C=qe();x.useEffect(()=>{if(u){o({...u,items:u.items.map(i=>({...i,received_quantity:i.received_quantity||0}))});const n=ce.findIndex(i=>i.value===u.status);v(n)}},[u]);const P=n=>{n.preventDefault();const i=document.createElement("a");i.href=Ee(a.attachment),i.download=a.attachment.split("/").pop(),i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)},q=()=>{let n="";a.status==="pending"?n="partially_received":a.status==="partially_received"&&(n="completed"),j(n),c(!0)},R=async()=>{var U,M;l({});let n=!1;const i={};if(g==="completed"&&(a.invoice||(i.invoice="Invoice is required",n=!0),a.attachment||(i.attachment="Attachment is required",n=!0),a.items.forEach((S,ne)=>{!S.received_quantity||S.received_quantity<=0?(i[`items.${ne}.received_quantity`]="Received quantity is required",n=!0):S.received_quantity>S.requested_quantity&&(i[`items.${ne}.received_quantity`]="Cannot exceed requested quantity",n=!0),(!S.retail_price||S.retail_price<=0)&&(i[`items.${ne}.retail_price`]="Retail price is required",n=!0)}),n)){l(i),c(!1);return}try{f(!0),await L.mutateAsync({id:e,data:{...a,status:g}}),a.attachment instanceof File&&await C.mutateAsync({id:e,file:a.attachment}),c(!1),be.success("Purchase Order updated successfully"),w()}catch(S){(M=(U=S.response)==null?void 0:U.data)!=null&&M.errors&&(l(S.response.data.errors),be.error("Something went wrong please try again")),f(!1),c(!1)}finally{f(!1)}},$=(n,i,U)=>{const M=[...a.items];M[n]={...M[n],[i]:U},o(S=>({...S,items:M}))},T=a.status==="pending",D=a.status==="partially_received",A=a.status==="completed",X=()=>T?"Mark as Partially Received":D?"Mark as Completed":"",oe=()=>g==="partially_received"?"Are you sure you want to mark this Purchase Order as partially received? This will allow you to start recording received quantities.":g==="completed"?"Are you sure you want to mark this Purchase Order as completed? This action cannot be undone.":"",Me=()=>{se.fire({title:"Are you sure?",text:"You want to cancel this purchase order? This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, keep it"}).then(async n=>{if(n.isConfirmed)try{f(!0),await L.mutateAsync({id:e,data:{...a,status:"cancelled"}}),se.fire("Cancelled!","The purchase order has been cancelled.","success"),w()}catch{se.fire("Error!","Failed to cancel the purchase order.","error")}finally{f(!1)}})},Ie=n=>{switch(n){case"pending":return"warning";case"partially_received":return"info";case"completed":return"success";case"cancelled":return"error";default:return"default"}};return I?t.jsx(Zt,{}):t.jsxs(He,{maxWidth:"xxl",sx:{mt:0,mb:4},children:[t.jsxs(Q,{sx:{mb:4},children:[t.jsxs(Q,{sx:{display:"flex",justifyContent:"space-between"},children:[t.jsx(de,{onClick:()=>r("/app/purchase"),sx:{mb:2},color:"primary",children:t.jsx(Vt,{})}),t.jsx(ze,{title:"Print Purchase Order",children:t.jsx(de,{onClick:d,color:"primary",children:t.jsx(Ne,{})})}),t.jsx(Oe,{purchaseOrder:u,contentRef:s})]}),t.jsx(Ht,{activeStep:h,sx:{mb:4},children:ce.map(n=>t.jsx(jt,{children:t.jsx(xe,{children:n.label})},n.value))}),t.jsx(Y,{elevation:0,sx:{p:0,mb:0},children:t.jsxs(k,{container:!0,spacing:2,alignItems:"center",children:[t.jsx(k,{item:!0,xs:12,md:8,children:t.jsxs(J,{variant:"h5",sx:{mb:1},children:["Purchase Order: ",u==null?void 0:u.po_number]})}),t.jsx(k,{item:!0,xs:12,md:4,children:t.jsx(Q,{sx:{display:"flex",justifyContent:"flex-end"},children:t.jsxs(it,{severity:Ie(a.status),sx:{mb:2},children:["Current Status:"," ",(ve=ce.find(n=>n.value===a.status))==null?void 0:ve.label]})})})]})}),t.jsx(Y,{elevation:0,sx:{p:0,mb:3},children:t.jsxs(k,{container:!0,spacing:3,children:[t.jsx(k,{item:!0,xs:12,md:6,children:t.jsxs(J,{variant:"subtitle1",sx:{mb:2},children:["Supplier: ",(fe=u==null?void 0:u.supplier)==null?void 0:fe.supplier_name]})}),t.jsx(k,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:t.jsxs(J,{variant:"subtitle1",children:["PO Date: ",new Date(u==null?void 0:u.po_date).toLocaleDateString()]})})]})}),(D||A)&&t.jsx(Y,{elevation:0,sx:{p:0,mb:3},children:t.jsxs(k,{container:!0,spacing:3,children:[t.jsx(k,{item:!0,xs:12,md:6,children:t.jsx(K,{fullWidth:!0,label:"Invoice Number",name:"invoice",value:a.invoice,onChange:n=>o(i=>({...i,invoice:n.target.value})),error:!!p.invoice,helperText:p.invoice,required:!0,disabled:A,sx:{mb:2}})}),t.jsx(k,{item:!0,xs:12,md:6,children:a.attachment&&typeof a.attachment=="string"?t.jsxs(Q,{sx:{display:"flex",alignItems:"center",gap:2},children:[t.jsx(J,{children:"Current Attachment:"}),t.jsxs(Ye,{href:"#",sx:{display:"flex",alignItems:"center",gap:1},onClick:P,children:[t.jsx(Qt,{})," Download Attachment"]})]}):t.jsx(K,{fullWidth:!0,type:"file",label:"Attachment",name:"attachment",InputLabelProps:{shrink:!0},inputProps:{accept:".pdf,.doc,.docx,.png,.jpg,.jpeg"},onChange:n=>{const i=n.target.files[0];if(i){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/png","image/jpeg"].includes(i.type)){l(S=>({...S,attachment:"File must be PDF, DOC, DOCX, PNG, or JPG format"})),n.target.value="";return}const M=5*1024*1024;if(i.size>M){l(S=>({...S,attachment:"File size must be less than 5MB"})),n.target.value="";return}o(S=>({...S,attachment:i}))}},error:!!p.attachment,helperText:p.attachment,disabled:A,required:!0})})]})}),t.jsxs(Y,{elevation:0,sx:{p:0},children:[t.jsx(Ve,{children:t.jsxs(Ge,{children:[t.jsx(Qe,{children:t.jsxs(ye,{children:[t.jsx(z,{children:"Product"}),t.jsx(z,{children:"Requested Quantity"}),(D||A)&&t.jsxs(t.Fragment,{children:[t.jsx(z,{children:"Received Quantity"}),t.jsx(z,{children:"Retail Price"})]}),t.jsx(z,{children:"Price"}),t.jsx(z,{children:"Total"})]})}),t.jsx(Ze,{children:a.items.map((n,i)=>{var U;return t.jsxs(ye,{children:[t.jsx(z,{sx:{verticalAlign:"top"},children:(U=n.product)==null?void 0:U.product_name}),t.jsx(z,{sx:{verticalAlign:"top"},children:t.jsx(K,{sx:{width:215},type:"number",value:n.requested_quantity,onChange:M=>$(i,"requested_quantity",M.target.value),disabled:!T,size:"small",inputProps:{min:1}})}),(D||A)&&t.jsxs(t.Fragment,{children:[t.jsx(z,{sx:{verticalAlign:"top"},children:t.jsx(K,{sx:{width:215},type:"number",value:n.received_quantity,onChange:M=>$(i,"received_quantity",M.target.value),disabled:A,size:"small",required:!0,error:!!p[`items.${i}.received_quantity`],helperText:p[`items.${i}.received_quantity`],inputProps:{min:0,max:n.requested_quantity}})}),t.jsx(z,{sx:{verticalAlign:"top"},children:t.jsx(K,{sx:{width:215},type:"number",value:n.retail_price,onChange:M=>$(i,"retail_price",M.target.value),error:!!p[`items.${i}.retail_price`],disabled:A,size:"small",required:!0,helperText:p[`items.${i}.retail_price`],inputProps:{min:0,step:.01}})})]}),t.jsxs(z,{sx:{verticalAlign:"top"},children:["₱",n.price]}),t.jsxs(z,{sx:{verticalAlign:"top"},children:["₱",(n.price*(D||A?n.received_quantity||0:n.requested_quantity)).toFixed(2)]})]},i)})})]})}),t.jsx(k,{item:!0,xs:12,md:4,children:t.jsxs(Q,{sx:{display:"flex",mt:4,justifyContent:"flex-end",gap:2},children:[D&&t.jsx(ee,{variant:"contained",onClick:Me,disabled:b,color:"error",startIcon:t.jsx(Gt,{}),sx:{minWidth:200},children:"Cancel Order"}),(T||D)&&!b&&t.jsx(ee,{variant:"contained",onClick:q,disabled:L.isPending,color:"primary",sx:{minWidth:200},children:X()})]})})]})]}),t.jsxs(Ue,{open:m,onClose:()=>c(!1),PaperProps:{sx:{borderRadius:2,minWidth:"500px",padding:2,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"}},children:[t.jsx(Be,{sx:{fontSize:"1.5rem",fontWeight:600,color:"#333",pb:1},children:"Confirm Status Update"}),t.jsx(Fe,{sx:{pt:2},children:t.jsx(bt,{sx:{fontSize:"1.1rem",color:"#555",lineHeight:1.5},children:oe()})}),t.jsxs(We,{sx:{padding:3,paddingTop:2,gap:2},children:[t.jsx(ee,{onClick:()=>c(!1),sx:{fontSize:"1rem",minWidth:"100px",textTransform:"none"},children:"Cancel"}),t.jsx(ee,{onClick:R,variant:"contained",color:"primary",disabled:b,sx:{fontSize:"1rem",minWidth:"100px",textTransform:"none",boxShadow:2},children:b?t.jsxs(Q,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(vt,{size:20,color:"inherit"}),t.jsx("span",{children:"Updating..."})]}):"Confirm"})]})]})]})};export{sr as default};

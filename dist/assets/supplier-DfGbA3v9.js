import{K as Y,r as o,L as K,N as Q,Q as W,S as q,j as e,v as g,F as G,l as P,P as J,T as R,I as p,U as X}from"./index-VYacBzdn.js";import{S as Z}from"./SupplierModal-GurUfyiW.js";import{S as f}from"./sweetalert2.esm.all-D3pEHXw3.js";import{C as ee}from"./Container-g1D49Be8.js";import{T as re}from"./TextField-DcFzWKp_.js";import{R as ne}from"./SearchOutlined-CuhT5l3w.js";import{R as te}from"./ClearOutlined-Ck6tTetQ.js";import{R as se}from"./PlusOutlined-NVaeiLU6.js";import{b as ae,c as oe,d as ie,T as h,a as n,e as le}from"./TableRow-F8UK-irz.js";import{R as ce}from"./EyeOutlined-DxhCRKYA.js";import{R as de}from"./EditOutlined-CdhJH0Bk.js";import{R as pe}from"./DeleteOutlined-CknXjhA9.js";import{T as he}from"./TablePagination-Dq0YRuKk.js";import{S as s}from"./Skeleton-wlVAb656.js";import"./CloseOutlined-BzQ1yUQH.js";import"./InputLabel-Cn1m3Ebo.js";import"./KeyboardArrowRight-CWBZhDWc.js";import"./LastPage-DIxfCoDv.js";import"./MenuItem--hotehpj.js";const xe=()=>e.jsxs(h,{children:[e.jsx(n,{children:e.jsx(s,{animation:"wave"})}),e.jsx(n,{children:e.jsx(s,{animation:"wave"})}),e.jsx(n,{children:e.jsx(s,{animation:"wave"})}),e.jsx(n,{children:e.jsx(s,{animation:"wave"})}),e.jsx(n,{children:e.jsx(s,{animation:"wave"})}),e.jsx(n,{align:"right",children:e.jsxs(g,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(s,{animation:"wave",variant:"circular",width:32,height:32}),e.jsx(s,{animation:"wave",variant:"circular",width:32,height:32}),e.jsx(s,{animation:"wave",variant:"circular",width:32,height:32})]})})]}),ke=()=>{const T=Y(),[x,w]=o.useState(0),[i,_]=o.useState(10),[l,C]=o.useState(""),[b,S]=o.useState(!1),[A,I]=o.useState("create"),[M,L]=o.useState(null),{data:c,isLoading:k,error:y,refetch:m}=K(),B=Q(),E=W(),$=q(),a=c==null?void 0:c.filter(r=>r.supplier_name.toLowerCase().includes(l.toLowerCase())||r.contact_person.toLowerCase().includes(l.toLowerCase())||r.email&&r.email.toLowerCase().includes(l.toLowerCase())||r.phone&&r.phone.toLowerCase().includes(l.toLowerCase())),z=(r,t)=>{w(t)},D=r=>{_(parseInt(r.target.value,10)),w(0)},F=async r=>{f.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"}).then(async t=>{if(t.isConfirmed)try{await $.mutateAsync(r),f.fire("Deleted!","Supplier has been deleted.","success"),m()}catch(d){f.fire("Error!","Failed to delete supplier. Please try again.","error"),console.error("Error deleting supplier:",d)}})},H=r=>{const t=c.find(d=>d.supplier_id===r);u("view",t)},N=r=>{const t=c.find(d=>d.supplier_id===r);u("edit",t)},v=r=>{T(`/app/supplier/${r}/purchase-history`)},u=(r,t=null)=>{I(r),L(t),S(!0)},O=async r=>{try{await E.mutateAsync({id:r.supplier_id,data:{supplier_name:r.supplier_name,contact_person:r.contact_person,email:r.email,phone:r.phone,address:r.address}}),m(),j()}catch(t){console.error("Error updating supplier:",t)}},U=async r=>{try{await B.mutateAsync(r),m(),j()}catch(t){console.error("Error creating supplier:",t)}},j=()=>{S(!1)},V=()=>{C("")};return y?e.jsxs("div",{children:["Error: ",y.message]}):e.jsxs(ee,{maxWidth:"xxl",sx:{mt:0,px:"0!important"},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(re,{placeholder:"Search suppliers...",variant:"outlined",size:"small",value:l,onChange:r=>C(r.target.value),InputProps:{startAdornment:e.jsx(G,{position:"start",children:e.jsx(ne,{})})}}),e.jsxs(g,{children:[e.jsx(P,{variant:"text",color:"error",sx:{mr:1},onClick:V,children:e.jsx(te,{})}),e.jsx(P,{variant:"contained",color:"error",startIcon:e.jsx(se,{}),onClick:()=>u("create"),children:"Add Supplier"})]})]}),e.jsx(ae,{component:J,children:e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsxs(h,{children:[e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Contact Person"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Phone"}),e.jsx(n,{children:"Address"}),e.jsx(n,{align:"right",children:"Actions"})]})}),e.jsx(le,{children:k?[...Array(i)].map((r,t)=>e.jsx(xe,{},t)):a&&a.length>0?a.slice(x*i,x*i+i).map(r=>e.jsxs(h,{children:[e.jsx(n,{children:e.jsx(R,{sx:{cursor:"pointer","&:hover":{color:"primary.main",textDecoration:"underline"}},onClick:()=>v(r.supplier_id),children:r.supplier_name})}),e.jsx(n,{children:r.contact_person}),e.jsx(n,{children:r.email}),e.jsx(n,{children:r.phone}),e.jsx(n,{children:r.address}),e.jsxs(n,{align:"right",children:[e.jsx(p,{onClick:()=>v(r.supplier_id),color:"primary",title:"View Purchase History",children:e.jsx(X,{style:{fontSize:20}})}),e.jsx(p,{onClick:()=>H(r.supplier_id),children:e.jsx(ce,{style:{fontSize:20}})}),e.jsx(p,{onClick:()=>N(r.supplier_id),children:e.jsx(de,{style:{fontSize:20}})}),e.jsx(p,{onClick:()=>F(r.supplier_id),children:e.jsx(pe,{style:{fontSize:20}})})]})]},r.supplier_id)):e.jsx(h,{children:e.jsx(n,{colSpan:6,align:"center",children:e.jsx(R,{variant:"body1",sx:{py:2},children:"No suppliers found"})})})})]})}),e.jsx(he,{rowsPerPageOptions:[5,10,25],component:"div",count:(a==null?void 0:a.length)||0,rowsPerPage:i,page:x,onPageChange:z,onRowsPerPageChange:D}),e.jsx(Z,{open:b,handleClose:j,handleAddSupplier:U,handleUpdateSupplier:O,mode:A,initialData:M})]})};export{ke as default};

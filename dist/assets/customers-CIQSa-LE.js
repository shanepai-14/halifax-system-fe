import{r as m,S as E,ag as W,ah as O,j as e,T as L,I as N,G as p,ai as Q,q as A,E as V,P as X}from"./index-Chkw8LpN.js";import{c as k}from"./cities-nh0Rcspy.js";import{D as B}from"./Dialog-ACxKU5r-.js";import{D as M,a as z}from"./DialogTitle-Ch3X7RlB.js";import{R as Y}from"./CloseOutlined-B2N1Ghrl.js";import{T as C,c as Z,d as ee,e as se,a as P,b as a,f as ae}from"./TextField-Czzb7ycq.js";import{A as ne}from"./Autocomplete-LFVe6RBn.js";import{D as $}from"./DialogActions-WQ4-Ebxu.js";import{B as _}from"./InputLabel-aB29g19v.js";import{C as te}from"./CircularProgress-B2CTOErf.js";import"./sweetalert2.esm.all-D3pEHXw3.js";import{C as re}from"./Container-BmsYVYg_.js";import{R as ie}from"./SearchOutlined-K4PNmaK5.js";import{R as le}from"./ClearOutlined-DihZjiGe.js";import{R as oe}from"./PlusOutlined-1JNR4_VJ.js";import{R as de}from"./EditOutlined-jQCM4PCc.js";import{R as ce}from"./DeleteOutlined-Cnk7YRvG.js";import{T as me}from"./TablePagination-CcVC2h88.js";import{D as ue}from"./DialogContentText-CuwziPzK.js";import{S as h}from"./Skeleton-6YVSzGd4.js";import"./MenuItem-DKP--nxm.js";const xe=({open:y,handleClose:f,customer:o=null,handleSuccess:S})=>{const b={customer_name:"",contact_number:"",email:"",address:"",city:"",business_name:"",business_address:""},[r,u]=m.useState(b),[t,d]=m.useState({}),i=E(W),{createCustomer:D,updateCustomer:g}=O(),j=!!o;m.useEffect(()=>{y&&(u(o?{customer_name:o.customer_name||"",contact_number:o.contact_number||"",email:o.email||"",address:o.address||"",city:o.city||"",business_name:o.business_name||"",business_address:o.business_address||""}:b),d({}))},[y,o]);const T=()=>{const n={};return r.customer_name.trim()||(n.customer_name="Customer name is required"),r.email&&!/\S+@\S+\.\S+/.test(r.email)&&(n.email="Email address is invalid"),d(n),Object.keys(n).length===0},x=n=>{const{name:l,value:c}=n.target;u(w=>({...w,[l]:c})),t[l]&&d(w=>({...w,[l]:void 0}))},v=async()=>{var n,l;if(T())try{let c;j?c=await g(o.id,r):c=await D(r),S&&S(c),f()}catch(c){console.error("Error saving customer:",c),(l=(n=c.response)==null?void 0:n.data)!=null&&l.errors&&d(c.response.data.errors)}};return e.jsxs(B,{open:y,onClose:f,maxWidth:"md",fullWidth:!0,"aria-labelledby":"customer-dialog-title",children:[e.jsxs(M,{id:"customer-dialog-title",sx:{m:0,p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(L,{variant:"h6",children:j?"Edit Customer":"Add New Customer"}),e.jsx(N,{"aria-label":"close",onClick:f,size:"small",children:e.jsx(Y,{})})]}),e.jsx(z,{dividers:!0,children:e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,label:"Customer Name *",name:"customer_name",value:r.customer_name,onChange:x,error:!!t.customer_name,helperText:t.customer_name,disabled:i,required:!0})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Business Name",name:"business_name",value:r.business_name,onChange:x,error:!!t.business_name,helperText:t.business_name,disabled:i})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Business Address",name:"business_address",value:r.business_address,onChange:x,error:!!t.business_address,helperText:t.business_address,disabled:i})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Contact Number",name:"contact_number",value:r.contact_number,onChange:x,error:!!t.contact_number,helperText:t.contact_number,disabled:i})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(C,{fullWidth:!0,label:"Email",name:"email",type:"email",value:r.email,onChange:x,error:!!t.email,helperText:t.email,disabled:i})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(C,{fullWidth:!0,label:"Address",name:"address",value:r.address,onChange:x,error:!!t.address,helperText:t.address,disabled:i,multiline:!0,rows:2})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(ne,{fullWidth:!0,options:k,getOptionLabel:n=>`${n.name}`,value:k.find(n=>n.name===r.city)||null,onChange:(n,l)=>{x({target:{name:"city",value:l?l.name:""}})},isOptionEqualToValue:(n,l)=>n.name===l.name,renderInput:n=>e.jsx(C,{...n,label:"City",name:"city",size:"normal",slotProps:{inputLabel:{sx:{top:"1px"}}},error:!!t.city,helperText:t.city,disabled:i})})})]})}),e.jsxs($,{sx:{px:3,py:2},children:[e.jsx(_,{onClick:f,disabled:i,children:"Cancel"}),e.jsx(_,{variant:"contained",color:"primary",onClick:v,disabled:i,startIcon:i&&e.jsx(te,{size:20,color:"inherit"}),children:i?"Saving...":j?"Update":"Save"})]})]})},he=()=>e.jsxs(P,{children:[e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{children:e.jsx(h,{animation:"wave"})}),e.jsx(a,{align:"right",children:e.jsxs(A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(h,{animation:"wave",variant:"circular",width:32,height:32}),e.jsx(h,{animation:"wave",variant:"circular",width:32,height:32})]})})]}),We=()=>{const y=E(Q),f=E(W),{getAllCustomers:o,deleteCustomer:S}=O(),[b,r]=m.useState(0),[u,t]=m.useState(10),[d,i]=m.useState(""),[D,g]=m.useState(!1),[j,T]=m.useState(null),[x,v]=m.useState(!1),[n,l]=m.useState(null),c=(s,I)=>{r(I)},w=s=>{t(parseInt(s.target.value,10)),r(0)},F=s=>{T(s),g(!0)},q=async()=>{try{await S(j.id),g(!1),T(null)}catch(s){console.error("Error deleting customer:",s)}},G=()=>{i("")},H=()=>{l(null),v(!0)},U=s=>{l(s),v(!0)},J=()=>{v(!1)},K=()=>{o()},R=y.filter(s=>s.customer_name.toLowerCase().includes(d.toLowerCase())||s.business_name&&s.business_name.toLowerCase().includes(d.toLowerCase())||s.email&&s.email.toLowerCase().includes(d.toLowerCase())||s.contact_number&&s.contact_number.toLowerCase().includes(d.toLowerCase())||s.city&&s.city.toLowerCase().includes(d.toLowerCase()));return e.jsxs(re,{maxWidth:"xxl",sx:{mt:0,px:"0!important"},children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,gap:2},children:[e.jsx(A,{sx:{display:"flex",gap:2,flex:1},children:e.jsx(C,{placeholder:"Search customers",variant:"outlined",size:"small",value:d,onChange:s=>i(s.target.value),InputProps:{startAdornment:e.jsx(V,{position:"start",children:e.jsx(ie,{})})},sx:{minWidth:300}})}),e.jsxs(A,{children:[e.jsx(_,{variant:"text",color:"error",sx:{mr:1},onClick:G,children:e.jsx(le,{})}),e.jsx(_,{variant:"contained",color:"primary",startIcon:e.jsx(oe,{}),onClick:H,children:"Add Customer"})]})]}),e.jsx(Z,{component:X,children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(P,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Business Name"}),e.jsx(a,{children:"Business Address"}),e.jsx(a,{children:"Contact Number"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Address"}),e.jsx(a,{children:"City"}),e.jsx(a,{align:"right",children:"Actions"})]})}),e.jsxs(ae,{children:[f?[...Array(u)].map((s,I)=>e.jsx(he,{},I)):R.slice(b*u,b*u+u).map(s=>e.jsxs(P,{children:[e.jsx(a,{children:e.jsx(L,{children:s.customer_name})}),e.jsx(a,{children:s.business_name||"N/A"}),e.jsx(a,{children:s.business_address||"N/A"}),e.jsx(a,{children:s.contact_number||"N/A"}),e.jsx(a,{children:s.email||"N/A"}),e.jsx(a,{children:s.address||"N/A"}),e.jsx(a,{children:s.city||"N/A"}),e.jsxs(a,{align:"right",children:[e.jsx(N,{onClick:()=>U(s),children:e.jsx(de,{style:{fontSize:20}})}),e.jsx(N,{onClick:()=>F(s),children:e.jsx(ce,{style:{fontSize:20,color:"red"}})})]})]},s.id)),!f&&R.length===0&&e.jsx(P,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(L,{variant:"body1",sx:{py:2},children:"No customers found"})})})]})]})}),e.jsx(me,{rowsPerPageOptions:[5,10,25],component:"div",count:R.length,rowsPerPage:u,page:b,onPageChange:c,onRowsPerPageChange:w}),e.jsxs(B,{open:D,onClose:()=>g(!1),children:[e.jsx(M,{children:"Confirm Delete"}),e.jsx(z,{children:e.jsxs(ue,{children:['Are you sure you want to delete the customer "',j==null?void 0:j.customer_name,'"? This action cannot be undone.']})}),e.jsxs($,{children:[e.jsx(_,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(_,{onClick:q,color:"error",children:"Delete"})]})]}),e.jsx(xe,{open:x,handleClose:J,customer:n,handleSuccess:K})]})};export{We as default};

import{r as h,ad as V,ae as L,c as Se,j as e,v as a,T as n,z as E,l as S,a2 as Ie,I as H,G as s,D as ne,P as z,H as Me,F as Fe,X as xe,t as te,Z as fe,aU as ve,J as ce,ak as he,K as be,R as ke,V as Ae,aV as Te,Y as qe}from"./index-VYacBzdn.js";import{l as Ce}from"./index-akne5vGV.js";import{a as se,f as de}from"./currencyFormat-BsuV9MhS.js";import{D as $}from"./Dialog-KIaZwdXs.js";import{D as ie,a as ae}from"./DialogTitle-sNzQWAp3.js";import{D as we}from"./DialogContentText-D1_q2Iju.js";import{b as N,c as Q,d as G,T as A,a as i,e as U}from"./TableRow-F8UK-irz.js";import{T as O,S as Oe,M as We}from"./TextField-DcFzWKp_.js";import{D as re}from"./DialogActions-Cf0C3-gn.js";import{R as _e}from"./PrinterOutlined-Dc6m45c5.js";import{R as Re}from"./CloseOutlined-BzQ1yUQH.js";import{u as De,R as ze,P as Be}from"./PaymentReceipt-CFPKKNoV.js";import{I as Ee}from"./InputLabel-Cn1m3Ebo.js";import{M as B}from"./MenuItem--hotehpj.js";import{R as He}from"./SaveOutlined-B1L_Y8WW.js";import{R as Ve}from"./DeleteOutlined-CknXjhA9.js";import{R as Le}from"./CloseCircleOutlined-Bag0VGDw.js";import{R as Pe}from"./HomeOutlined-BL0nYU_M.js";import{S as c}from"./Skeleton-wlVAb656.js";import{C as $e}from"./Container-g1D49Be8.js";import{L as ye}from"./Link-C_3rcFug.js";import{R as Ne}from"./ArrowLeftOutlined-D9j3WHTr.js";import"./Close-C8KEn5ze.js";var Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},Ge=function(t,l){return h.createElement(V,L({},t,{ref:l,icon:Qe}))},Ue=h.forwardRef(Ge),Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},Ye=function(t,l){return h.createElement(V,L({},t,{ref:l,icon:Ke}))},Je=h.forwardRef(Ye),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M911.5 700.7a8 8 0 00-10.3-4.8L840 718.2V180c0-37.6-30.4-68-68-68H252c-37.6 0-68 30.4-68 68v538.2l-61.3-22.3c-.9-.3-1.8-.5-2.7-.5-4.4 0-8 3.6-8 8V763c0 3.3 2.1 6.3 5.3 7.5L501 910.1c7.1 2.6 14.8 2.6 21.9 0l383.8-139.5c3.2-1.2 5.3-4.2 5.3-7.5v-59.6c0-1-.2-1.9-.5-2.8zM512 837.5l-256-93.1V184h512v560.4l-256 93.1zM660.6 312h-54.5c-3 0-5.8 1.7-7.1 4.4l-84.7 168.8H511l-84.7-168.8a8 8 0 00-7.1-4.4h-55.7c-1.3 0-2.6.3-3.8 1-3.9 2.1-5.3 7-3.2 10.8l103.9 191.6h-57c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76v39h-76c-4.4 0-8 3.6-8 8v27.1c0 4.4 3.6 8 8 8h76V704c0 4.4 3.6 8 8 8h49.9c4.4 0 8-3.6 8-8v-63.5h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8h-76.3v-39h76.3c4.4 0 8-3.6 8-8v-27.1c0-4.4-3.6-8-8-8H564l103.7-191.6c.6-1.2 1-2.5 1-3.8-.1-4.3-3.7-7.9-8.1-7.9z"}}]},name:"money-collect",theme:"outlined"},Ze=function(t,l){return h.createElement(V,L({},t,{ref:l,icon:Xe}))},et=h.forwardRef(Ze),tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},nt=function(t,l){return h.createElement(V,L({},t,{ref:l,icon:tt}))},st=h.forwardRef(nt),it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"},at=function(t,l){return h.createElement(V,L({},t,{ref:l,icon:it}))},rt=h.forwardRef(at);const lt=Se(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert"),ot=({open:x,onClose:t,returnItems:l,handleReturnQuantityChange:m,returnReason:w,setReturnReason:u,handleSubmitCreditMemo:b,returns:d=[]})=>{const[f,v]=h.useState([]);h.useEffect(()=>{if(l&&l.length>0){const r={};d&&d.length>0&&d.forEach(_=>{_.items.forEach(R=>{const g=R.product_id;r[g]||(r[g]=0),r[g]+=parseInt(R.quantity)})});const p=l.map(_=>{const R=_.product_id,g=r[R]||0,D=Math.max(0,_.max_quantity-g);return{..._,original_max_quantity:_.max_quantity,max_quantity:D,already_returned:g}});v(p)}else v([])},[l,d]);const C=f.some(r=>r.max_quantity>0),j=f.reduce((r,p)=>r+parseFloat(p.sold_price)*p.return_quantity,0);return e.jsxs($,{open:x,onClose:t,maxWidth:"md",fullWidth:!0,children:[e.jsx(ie,{children:"Create Credit Memo"}),e.jsxs(ae,{children:[e.jsx(we,{children:"Specify the items and quantities to be returned. Only items that are part of this delivery report can be returned."}),d&&d.length>0&&e.jsxs(a,{sx:{mt:2,mb:2,p:2,bgcolor:"background.level2",borderRadius:1},children:[e.jsx(n,{variant:"subtitle2",gutterBottom:!0,children:"Previous Returns:"}),d.map((r,p)=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(E,{label:r.credit_memo_number,size:"small",color:"primary",variant:"outlined",sx:{mr:1}}),e.jsxs(n,{variant:"body2",children:[new Date(r.return_date).toLocaleDateString()," - ₱",parseFloat(r.refund_amount).toFixed(2)]})]},r.id))]}),e.jsx(N,{sx:{mt:2},children:e.jsxs(Q,{size:"small",children:[e.jsx(G,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Item"}),e.jsx(i,{children:"Code"}),e.jsx(i,{align:"right",children:"Price"}),e.jsx(i,{align:"center",children:"Original Qty"}),e.jsx(i,{align:"center",children:"Already Returned"}),e.jsx(i,{align:"center",children:"Available"}),e.jsx(i,{align:"center",children:"Return Quantity"}),e.jsx(i,{align:"right",children:"Total"})]})}),e.jsxs(U,{children:[f.map(r=>{var p,_;return e.jsxs(A,{sx:r.max_quantity===0?{backgroundColor:"rgba(0,0,0,0.04)"}:{},children:[e.jsx(i,{children:(p=r.product)==null?void 0:p.product_name}),e.jsx(i,{children:(_=r.product)==null?void 0:_.product_code}),e.jsxs(i,{align:"right",children:["₱",parseFloat(r.sold_price).toFixed(2)]}),e.jsx(i,{align:"center",children:r.original_max_quantity}),e.jsxs(i,{align:"center",children:[r.already_returned>0&&e.jsx(E,{label:r.already_returned,size:"small",color:"warning",variant:"outlined"}),r.already_returned===0&&"-"]}),e.jsx(i,{align:"center",children:r.max_quantity}),e.jsx(i,{align:"center",children:e.jsx(O,{type:"number",InputProps:{inputProps:{min:0,max:r.max_quantity}},value:r.return_quantity,onChange:R=>m(r.id,R.target.value,r.already_returned),size:"small",sx:{width:"80px"},disabled:r.max_quantity===0})}),e.jsxs(i,{align:"right",children:["₱",(parseFloat(r.sold_price)*r.return_quantity).toFixed(2)]})]},r.id)}),e.jsxs(A,{children:[e.jsx(i,{colSpan:7,align:"right",children:e.jsx(n,{variant:"subtitle2",children:"Total Return Amount:"})}),e.jsx(i,{align:"right",children:e.jsxs(n,{variant:"subtitle2",children:["₱",j.toFixed(2)]})})]})]})]})}),!C&&e.jsx(a,{sx:{mt:2,p:2,bgcolor:"error.lighter",borderRadius:1},children:e.jsx(n,{variant:"body2",color:"error.main",children:"All items have been fully returned. No further returns are possible."})}),e.jsx(O,{margin:"dense",id:"returnReason",label:"Reason for Return",multiline:!0,rows:3,fullWidth:!0,variant:"outlined",value:w,onChange:r=>u(r.target.value),sx:{mt:3},disabled:!C})]}),e.jsxs(re,{children:[e.jsx(S,{onClick:t,children:"Cancel"}),e.jsx(S,{onClick:b,variant:"contained",color:"primary",disabled:!C||j<=0,children:"Create Credit Memo"})]})]})},ct=({open:x,onClose:t,returns:l,report:m})=>{var d,f,v,C;const w=h.useRef(),u=Ce.useReactToPrint({contentRef:w}),b=(l==null?void 0:l.reduce((j,r)=>j+parseFloat(r.refund_amount),0))||0;return!l||l.length===0?null:e.jsx(Ie,{open:x,onClose:t,"aria-labelledby":"credit-memo-modal-title",children:e.jsxs(a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:"850px",maxHeight:"90vh",overflow:"auto",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(n,{id:"credit-memo-modal-title",variant:"h5",children:"Credit Memo Details"}),e.jsxs(a,{children:[e.jsx(S,{variant:"outlined",color:"primary",startIcon:e.jsx(_e,{}),onClick:u,sx:{mr:1},children:"Print"}),e.jsx(H,{onClick:t,color:"default",children:e.jsx(Re,{})})]})]}),e.jsxs(a,{ref:w,sx:{p:2},children:[e.jsxs(s,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(s,{item:!0,xs:12,md:12,children:e.jsxs(a,{sx:{textAlign:"center",mb:2},children:[e.jsx(n,{variant:"h4",children:"CREDIT MEMO"}),e.jsxs(n,{variant:"body2",children:["DR #: ",m==null?void 0:m.invoice_number]})]})}),e.jsxs(s,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(n,{variant:"h6",children:"Halifax Glass & Aluminum Supply"}),e.jsx(n,{variant:"body2",children:"Malagamot Road, Panacan"}),e.jsx(n,{variant:"body2",children:"glasshalifax@gmail.com"}),e.jsx(n,{variant:"body2",children:"0939 924 3876"})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Date:"})," ",se(new Date)]}),e.jsxs(n,{variant:"subtitle2",children:[e.jsx("strong",{children:"Customer:"})," ",((d=m==null?void 0:m.customer)==null?void 0:d.business_name)||((f=m==null?void 0:m.customer)==null?void 0:f.customer_name)]}),e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Address:"})," ",((v=m==null?void 0:m.customer)==null?void 0:v.business_address)||(m==null?void 0:m.address)]}),e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Phone:"})," ",m==null?void 0:m.phone]})]})]})]}),e.jsx(ne,{sx:{my:2}}),l.map((j,r)=>e.jsxs(a,{sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(n,{variant:"subtitle1",children:["Credit Memo #",j.credit_memo_number]}),e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Date:"})," ",se(j.return_date)]})]}),e.jsx(N,{component:z,variant:"outlined",sx:{mb:1},children:e.jsxs(Q,{size:"small",children:[e.jsx(G,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Item"}),e.jsx(i,{children:"Code"}),e.jsx(i,{align:"right",children:"Price"}),e.jsx(i,{align:"center",children:"Quantity"}),e.jsx(i,{align:"right",children:"Total"}),e.jsx(i,{children:"Condition"}),e.jsx(i,{children:"Reason"})]})}),e.jsx(U,{children:j.items.map(p=>e.jsxs(A,{children:[e.jsx(i,{children:`Product #${p.product_id}`}),e.jsx(i,{children:`P-${p.product_id}`}),e.jsxs(i,{align:"right",children:["₱",parseFloat(p.price).toFixed(2)]}),e.jsx(i,{align:"center",children:p.quantity}),e.jsxs(i,{align:"right",children:["₱",parseFloat(p.subtotal).toFixed(2)]}),e.jsx(i,{children:p.condition}),e.jsx(i,{children:p.return_reason})]},p.id))})]})}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(s,{container:!0,spacing:0,sx:{maxWidth:"300px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"body1",fontWeight:"bold",align:"right",children:"Refund Amount:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body1",fontWeight:"bold",align:"right",children:["₱",parseFloat(j.refund_amount).toFixed(2)]})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"body2",align:"right",children:"Method:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"body2",align:"right",children:j.refund_method.toUpperCase()})})]})}),r<l.length-1&&e.jsx(ne,{sx:{my:2}})]},j.id)),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsxs(s,{container:!0,spacing:0,sx:{maxWidth:"300px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"h6",fontWeight:"bold",align:"right",children:"Total Refund:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"h6",fontWeight:"bold",align:"right",children:["₱",b.toFixed(2)]})})]})}),((C=l[0])==null?void 0:C.remarks)&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(n,{variant:"subtitle2",children:"Remarks:"}),e.jsx(n,{variant:"body2",children:l[0].remarks})]}),e.jsxs(s,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{variant:"caption",children:"Prepared By"})})}),e.jsx(s,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{variant:"caption",children:"Approved By"})})}),e.jsx(s,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{variant:"caption",children:"Customer Signature"})})})]})]})]})})},dt=({open:x,handleClose:t,sale:l,onSuccess:m})=>{var R;const w={payment_method:"cash",amount:"",reference_number:"",remarks:""},[u,b]=h.useState(w),[d,f]=h.useState({}),[v,C]=h.useState(!1),{createPayment:j}=De();h.useEffect(()=>{x&&l&&(b({...w,amount:l.total-l.amount_received||0,received_by:l.customer_id}),f({}))},[x,l]);const r=()=>{const g={};return u.payment_method||(g.payment_method="Payment method is required"),u.payment_method==="cheque"&&!u.payment_date&&(g.payment_date="Payment date is required for cheque payments"),!u.amount||parseFloat(u.amount)<=0?g.amount="Amount must be greater than 0":parseFloat(u.amount)>parseFloat((l==null?void 0:l.total)||0)&&(g.amount="Amount cannot exceed the due amount"),u.payment_method==="cheque"&&!u.reference_number&&(g.reference_number="Reference number is required for cheque payments"),f(g),Object.keys(g).length===0},p=g=>{const{name:D,value:T}=g.target;b(F=>({...F,[D]:T})),d[D]&&f(F=>({...F,[D]:void 0}))},_=async()=>{var g,D;if(r())try{C(!0);const T={...u,amount:parseFloat(u.amount)},F=await j(l.id,T);F&&(m&&m(F),t())}catch(T){console.error("Error saving payment:",T),te.error(((D=(g=T.response)==null?void 0:g.data)==null?void 0:D.message)||"Failed to record payment")}finally{C(!1)}};return e.jsxs($,{open:x,onClose:t,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"payment-dialog-title",children:[e.jsxs(ie,{id:"payment-dialog-title",sx:{m:0,p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(n,{variant:"h6",children:"Record Payment"}),e.jsx(H,{"aria-label":"close",onClick:t,size:"small",children:e.jsx(Re,{})})]}),e.jsxs(ae,{dividers:!0,children:[l&&e.jsxs(a,{sx:{mb:3},children:[e.jsxs(n,{variant:"subtitle1",children:["Sale #",l.invoice_number]}),e.jsxs(s,{container:!0,spacing:1,children:[e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body2",children:["Customer: ",((R=l.customer)==null?void 0:R.customer_name)||"Walk-in Customer"]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body2",children:["Order Date: ",new Date(l.order_date).toLocaleDateString()]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body2",children:["Total Amount: ₱",parseFloat(l.total).toFixed(2)]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body2",color:"error",children:["Amount Due: ₱",parseFloat(l.total-l.amount_received||0).toFixed(2)]})})]})]}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(Me,{fullWidth:!0,error:!!d.payment_method,children:[e.jsx(Ee,{id:"payment-method-label",children:"Payment Method *"}),e.jsxs(Oe,{labelId:"payment-method-label",name:"payment_method",value:u.payment_method,onChange:p,label:"Payment Method *",disabled:v,children:[e.jsx(B,{value:"cod",children:"Cash"}),e.jsx(B,{value:"cash",children:"Cash"}),e.jsx(B,{value:"cheque",children:"Cheque"}),e.jsx(B,{value:"online",children:"Online Payment"})]}),d.payment_method&&e.jsx(n,{variant:"caption",color:"error",children:d.payment_method})]})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Amount *",name:"amount",type:"number",value:u.amount,onChange:p,error:!!d.amount,helperText:d.amount,disabled:v,InputProps:{startAdornment:e.jsx(Fe,{position:"start",children:"₱"})}})}),u.payment_method==="cheque"&&e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Cheque Date *",name:"payment_date",type:"date",value:u.payment_date,onChange:p,error:!!d.payment_date,helperText:d.payment_date,InputLabelProps:{shrink:!0},required:!0})}),e.jsx(s,{item:!0,xs:12,md:u.payment_method==="cheque"?6:12,children:e.jsx(O,{fullWidth:!0,required:u.payment_method==="cheque",label:u.payment_method==="cheque"?"Reference Number *":"Reference Number",name:"reference_number",value:u.reference_number,onChange:p,error:!!d.reference_number,helperText:d.reference_number,disabled:v,placeholder:"Cheque/Transaction No."})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,label:"Remarks",name:"remarks",value:u.remarks,onChange:p,multiline:!0,rows:2,disabled:v})})]})]}),e.jsxs(re,{sx:{px:3,py:2},children:[e.jsx(S,{onClick:t,disabled:v,children:"Cancel"}),e.jsx(S,{variant:"contained",color:"primary",onClick:_,disabled:v,startIcon:v?e.jsx(xe,{size:20,color:"inherit"}):e.jsx(He,{}),children:v?"Processing...":"Save Payment"})]})]})},xt=({sale:x,onPaymentSuccess:t,disabled:l=!1})=>{const[m,w]=h.useState(!1),[u,b]=h.useState(!1),d=fe(ve),f=(d==null?void 0:d.role)==="admin"||(d==null?void 0:d.role)==="cashier",v=()=>{w(!0)},C=()=>{w(!1)},j=r=>{b(!1),w(!1),t&&t(r)};return f?x!=null&&x.is_paid?e.jsx(a,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(n,{variant:"body2",color:"success.main",fontWeight:"bold",children:"PAID"})}):e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outlined",color:"success",startIcon:u?e.jsx(xe,{size:20}):e.jsx(et,{}),onClick:v,disabled:l||u,sx:{mr:1},children:u?"Processing...":"Pay Now"}),x&&x.amount_due>0&&e.jsxs(n,{variant:"body2",color:"error",sx:{ml:1,fontWeight:"medium"},children:["Due: ",de(x.amount_due)]}),e.jsx(dt,{open:m,handleClose:C,sale:x,onSuccess:j})]}):null},ht=({sale:x,onPaymentUpdate:t,setSelectedReceipt:l})=>{const[m,w]=h.useState([]),[u,b]=h.useState(!1),[d,f]=h.useState(null),[v,C]=h.useState(!1),[j,r]=h.useState(""),{getPaymentHistory:p,voidPayment:_,isLoading:R}=De(),g=fe(ve),D=(g==null?void 0:g.role)==="admin"||(g==null?void 0:g.role)==="cashier";if(!D)return null;h.useEffect(()=>{x&&F()},[x]);const T=o=>{l({payment:{...o},sale:x})},F=async()=>{try{b(!0);const o=await p(x.id);w(o)}catch(o){console.error("Error fetching payment history:",o)}finally{b(!1)}},K=async()=>{var o,q;if(!j.trim()){te.error("Please provide a reason for voiding the payment");return}try{await _(d.id,j),F(),t&&t(),C(!1),r(""),f(null),te.success("Payment voided successfully")}catch(ee){console.error("Error voiding payment:",ee),te.error(((q=(o=ee.response)==null?void 0:o.data)==null?void 0:q.message)||"Failed to void payment")}},le=o=>{f(o),C(!0)},Y=()=>{C(!1),r(""),f(null)},J=o=>new Date(o).toLocaleString(),oe=o=>o?new Date(o).toISOString().split("T")[0]:"-",X=o=>o==="completed"?e.jsx(E,{label:"Completed",color:"success",size:"small"}):o==="voided"?e.jsx(E,{label:"Voided",color:"error",size:"small"}):e.jsx(E,{label:o,size:"small"}),Z=o=>({cash:"Cash",credit_card:"Credit Card",debit_card:"Debit Card",cheque:"Cheque",bank_transfer:"Bank Transfer",online:"Online Payment",mobile_payment:"Mobile Payment",store_credit:"Store Credit"})[o]||o;return u?e.jsx(a,{sx:{p:2},children:e.jsx(n,{variant:"body2",children:"Loading payment history..."})}):e.jsxs(e.Fragment,{children:[e.jsxs(a,{sx:{mb:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Payment History"}),m.length===0?e.jsx(n,{variant:"body2",color:"text.secondary",children:"No payment records found for this sale."}):e.jsx(N,{component:z,variant:"outlined",children:e.jsxs(Q,{size:"small",children:[e.jsx(G,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Method"}),e.jsx(i,{children:"Reference No."}),e.jsx(i,{align:"right",children:"Amount"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Received By"}),e.jsx(i,{align:"right",children:"Actions"})]})}),e.jsx(U,{children:m.map(o=>{var q;return e.jsxs(A,{children:[e.jsx(i,{children:J(o.created_at)}),e.jsx(i,{children:Z(o.payment_method)}),e.jsx(i,{children:o.payment_method==="cheque"?`${o.reference_number||"-"} (${oe(o.payment_date)})`:o.reference_number||"-"}),e.jsx(i,{align:"right",children:de(o.amount)}),e.jsx(i,{children:X(o.status)}),e.jsx(i,{children:((q=o.received_by)==null?void 0:q.customer_name)||"-"}),e.jsxs(i,{align:"right",children:[e.jsx(ce,{title:"View Receipt",children:e.jsx(H,{size:"small",color:"primary",onClick:()=>T(o),children:e.jsx(ze,{})})}),o.status==="completed"&&D&&e.jsx(ce,{title:"Void Payment",children:e.jsx(H,{size:"small",color:"error",onClick:()=>le(o),children:e.jsx(Ve,{})})}),o.status==="voided"&&e.jsx(ce,{title:`Void reason: ${o.void_reason}`,children:e.jsx(a,{component:"span",sx:{ml:1,color:"text.secondary",fontSize:"0.75rem"},children:"(Voided)"})})]})]},o.id)})})]})})]}),e.jsxs($,{open:v,onClose:Y,children:[e.jsx(ie,{children:"Void Payment"}),e.jsxs(ae,{children:[e.jsx(n,{variant:"body2",gutterBottom:!0,children:"Are you sure you want to void this payment? This action cannot be undone."}),d&&e.jsxs(a,{sx:{my:2},children:[e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Payment Method:"})," ",Z(d.payment_method)]}),e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Amount:"})," ",de(d.amount)]}),e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Date:"})," ",J(d.payment_date)]})]}),e.jsx(O,{label:"Reason for voiding payment",fullWidth:!0,multiline:!0,rows:3,value:j,onChange:o=>r(o.target.value),required:!0,margin:"dense",error:!j.trim(),helperText:j.trim()?"":"Reason is required"})]}),e.jsxs(re,{children:[e.jsx(S,{onClick:Y,children:"Cancel"}),e.jsx(S,{onClick:K,color:"error",disabled:R||!j.trim(),children:R?"Processing...":"Void Payment"})]})]})]})},ut=({sale:x})=>{const[t,l]=h.useState(null),m=!!t,[w,u]=h.useState(!1),[b,d]=h.useState(""),[f,v]=h.useState(!1),{cancelSale:C}=he(),j=D=>{l(D.currentTarget)},r=()=>{l(null)},p=()=>{r(),u(!0)},_=()=>{u(!1),d("")},R=async()=>{if(b.trim()){v(!0);try{await C(x.id,b),_()}catch(D){console.error("Error cancelling sale:",D)}finally{v(!1)}}},g=x.status==="cancelled"||x.status==="completed"||x.status==="returned";return e.jsxs(e.Fragment,{children:[e.jsx(H,{"aria-label":"more","aria-controls":"sale-menu","aria-haspopup":"true",onClick:j,size:"small",children:e.jsx(lt,{})}),e.jsx(We,{id:"sale-menu",anchorEl:t,keepMounted:!0,open:m,onClose:r,PaperProps:{style:{maxHeight:48*4.5,width:"20ch"}},children:e.jsxs(B,{onClick:p,disabled:g,sx:{color:g?"text.disabled":"error.main","&.Mui-disabled":{opacity:.6}},children:[e.jsx(Le,{style:{marginRight:8}}),"Cancel Sale"]})}),e.jsxs($,{open:w,onClose:_,"aria-labelledby":"cancel-sale-dialog-title",maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{id:"cancel-sale-dialog-title",children:"Cancel Sale"}),e.jsxs(ae,{children:[e.jsxs(we,{sx:{mb:2},children:["Are you sure you want to cancel sale #",x.invoice_number,"? This action cannot be undone."]}),e.jsx(O,{autoFocus:!0,id:"cancel-reason",label:"Reason for Cancellation",type:"text",fullWidth:!0,multiline:!0,rows:3,value:b,onChange:D=>d(D.target.value),variant:"outlined",required:!0,error:!b.trim(),helperText:b.trim()?"":"Reason is required"})]}),e.jsxs(re,{children:[e.jsx(S,{onClick:_,color:"primary",children:"Back"}),e.jsx(S,{onClick:R,color:"error",disabled:!b.trim()||f,startIcon:f?e.jsx(xe,{size:20,color:"inherit"}):null,children:f?"Cancelling...":"Confirm Cancel"})]})]})]})},mt=({refresh:x,report:t})=>{var ue,me,je,ge,pe;const[l,m]=h.useState(!1),[w,u]=h.useState(!1),[b,d]=h.useState([]),[f,v]=h.useState(""),C=be(),j=h.useRef(),[r,p]=h.useState(!1),[_,R]=h.useState(null),{createCreditMemo:g}=he();ke.useEffect(()=>{t&&t.items&&d(t.items.map(y=>({...y,return_quantity:0,max_quantity:y.quantity})))},[t]);const D=Ce.useReactToPrint({contentRef:j}),T=()=>{m(!0)},F=()=>{m(!1)},K=()=>{u(!0)},le=()=>{u(!1)},Y=(y,P,M)=>{const k=Math.max(0,parseInt(P)||0);d(b.map(I=>{if(I.id===y){const W=I.max_quantity-(M||0);return{...I,return_quantity:Math.min(k,W)}}return I}))},J=async()=>{const y=b.filter(M=>M.return_quantity>0);if(y.length===0){alert("Please specify at least one item to return");return}const P=y.reduce((M,k)=>M+k.return_quantity*k.sold_price,0);try{const M={sale_id:t.id,remarks:f,refund_method:"cash",refund_amount:P,items:y.map(I=>({sale_item_id:I.id,product_id:I.product_id,quantity:I.return_quantity,price:I.sold_price}))};await g(M)&&(F(),x(t.id))}catch{}},oe=((ue=t==null?void 0:t.returns)==null?void 0:ue.reduce((y,P)=>{var k;const M=((k=P.items)==null?void 0:k.reduce((I,W)=>I+parseFloat(W.quantity||0)*parseFloat(W.price||0),0))||0;return y+M},0))||0,X=async y=>{x(t.id,!0);const P={...t,...y.sale};R({payment:{...y},sale:{...P}})},Z=()=>{p(!r)};if(!t)return e.jsxs(a,{sx:{p:4,textAlign:"center"},children:[e.jsx(n,{variant:"h5",children:"No delivery report data available"}),e.jsx(S,{variant:"contained",startIcon:e.jsx(Pe,{}),onClick:()=>C("/dashboard"),sx:{mt:2},children:"Go to Dashboard"})]});const o=t.items.reduce((y,P)=>y+parseFloat(P.sold_price)*P.quantity,0),q=t.items.reduce((y,P)=>{const k=parseFloat(P.sold_price)*P.quantity*(parseFloat(P.discount)/100);return y+k},0),ee=o-q;return e.jsxs(e.Fragment,{children:[e.jsxs(z,{elevation:2,sx:{p:3,mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(n,{variant:"h5",children:"Delivery Report Details"}),e.jsxs(a,{children:[e.jsx(xt,{sale:t,onPaymentSuccess:X,disabled:t.status=="cancelled"||t.status=="completed"}),e.jsx(S,{variant:"outlined",color:"primary",startIcon:e.jsx(_e,{}),onClick:D,sx:{mr:1},children:"Print"}),e.jsx(S,{variant:"outlined",color:"secondary",startIcon:e.jsx(st,{}),onClick:T,disabled:!1,children:"Create Credit Memo"}),e.jsx(ut,{sale:t})]})]}),e.jsxs(a,{ref:j,sx:{p:2},children:[e.jsxs(s,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(s,{item:!0,xs:12,md:12,children:e.jsx(a,{sx:{textAlign:"center",mb:2},children:e.jsx(n,{variant:"h4",children:"DELIVERY REPORT"})})}),e.jsxs(s,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(n,{variant:"h5",children:"Halifax Glass & Aluminum Supply"}),e.jsx(n,{children:"Malagamot Road, Panacan"}),e.jsx(n,{children:"glasshalifax@gmail.com"}),e.jsx(n,{children:"0939 924 3876"})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Order Date:"})," ",se(t.order_date)]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Delivery Date:"})," ",se(t.delivery_date)]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Payment Method:"})," ",t.payment_method.toUpperCase()]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Status:"})," ",t.status.toUpperCase()]})]})]})]}),e.jsxs(s,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(s,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{mb:1},children:[e.jsxs(n,{children:[e.jsx("strong",{children:" Delivered to:"}),"  ",((me=t.customer)==null?void 0:me.business_name)||((je=t.customer)==null?void 0:je.customer_name)]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Address:"}),"  ",((ge=t.customer)==null?void 0:ge.business_address)||t.address]}),e.jsxs(n,{children:[e.jsx("strong",{children:"City:"}),"  ",t.city]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Phone:"}),"  ",t.phone]})]})}),e.jsx(s,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{textAlign:"right"},children:[e.jsxs(n,{variant:"h6",children:[e.jsx("strong",{children:"DR #:"})," ",t.invoice_number]}),t.term_days!==0&&t.term_days&&e.jsx(e.Fragment,{children:e.jsxs(n,{variant:"h6",children:[e.jsx("strong",{children:"Term :"})," ",t.term_days]})})]})})]}),e.jsx(ne,{sx:{my:1}}),e.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Order Items"}),e.jsx(N,{component:z,variant:"outlined",sx:{mb:2},children:e.jsxs(Q,{size:"small",children:[e.jsx(G,{children:e.jsxs(A,{children:[e.jsx(i,{children:"Item"}),e.jsx(i,{children:"Code"}),e.jsx(i,{align:"right",children:"Price"}),e.jsx(i,{align:"center",children:"Qty"}),e.jsx(i,{align:"right",children:"Discount (%)"}),e.jsx(i,{align:"right",children:"Subtotal"})]})}),e.jsx(U,{children:t.items.map(y=>{var I,W;const P=parseFloat(y.sold_price)*y.quantity,M=P*(parseFloat(y.discount)/100),k=P-M;return e.jsxs(A,{children:[e.jsx(i,{children:(I=y.product)==null?void 0:I.product_name}),e.jsx(i,{children:(W=y.product)==null?void 0:W.product_code}),e.jsxs(i,{align:"right",children:["₱",parseFloat(y.sold_price).toFixed(2)]}),e.jsx(i,{align:"center",children:y.quantity}),e.jsxs(i,{align:"right",children:[parseFloat(y.discount).toFixed(2),"%"]}),e.jsxs(i,{align:"right",children:["₱",k.toFixed(2)]})]},y.id)})})]})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Delivery Status:"})," ",t.is_delivered?"Delivered":"Pending Delivery"]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Encoded By:"})," ",(pe=t.user)==null?void 0:pe.name]})]}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(s,{container:!0,spacing:0,sx:{maxWidth:"400px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{align:"right",children:"Subtotal:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{align:"right",children:["₱",o.toFixed(2)]})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{align:"right",children:"Discount:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{align:"right",children:["₱",q.toFixed(2)]})}),t.returns&&t.returns.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"body2",align:"right",onClick:K,sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},children:"Credit Memo Total:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{variant:"body2",align:"right",onClick:K,sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},children:["₱",oe.toFixed(2)]})})]}),e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{fontWeight:"bold",align:"right",children:"Total Amount:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{fontWeight:"bold",align:"right",children:["₱",ee.toFixed(2)]})}),t.amount_received!=="0.00"&&t.amount_received&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{align:"right",children:"Amount Received:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{align:"right",children:["₱",parseFloat(t.amount_received).toFixed(2)]})})]}),t.change!=="0.00"&&t.change&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{align:"right",children:"Change:"})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(n,{align:"right",children:["₱",parseFloat(t.change).toFixed(2)," ",typeof t.change]})})]})]})})]}),t.remarks&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(n,{children:"Remarks:"}),e.jsx(n,{variant:"body2",children:t.remarks})]}),e.jsxs(s,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{children:"Prepared By"})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{children:"Checked By"})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{children:"Released By"})})})]}),e.jsxs(s,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"center",gap:30},children:[e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{children:"Delivered By"})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(n,{children:"Received By"})})})]}),e.jsx(s,{container:!0,children:e.jsx(s,{item:!0,xs:12,mt:5,children:e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(n,{fontWeight:"bold",children:"Note: This Office will not entertain any claim of shortage after receipt has been duly acknowledge"})})})})]})]}),e.jsx(a,{sx:{mt:3,mb:2},children:e.jsx(S,{variant:"text",color:"primary",onClick:Z,startIcon:r?e.jsx(rt,{}):e.jsx(Ue,{}),children:r?"Hide Payment History":"Show Payment History"})}),r&&e.jsx(a,{sx:{mt:2},children:e.jsx(ht,{sale:t,onPaymentUpdate:X,setSelectedReceipt:R})}),_&&e.jsx($,{open:!!_,onClose:()=>R(null),maxWidth:"md",fullWidth:!0,children:e.jsx(Be,{paymentRecord:_,onClose:()=>R(null)})}),e.jsx(ot,{open:l,onClose:F,returnItems:b,handleReturnQuantityChange:Y,returnReason:f,setReturnReason:v,handleSubmitCreditMemo:J,returns:t.returns}),t.returns&&t.returns.length>0&&e.jsx(ct,{open:w,onClose:le,returns:t.returns,report:t})]})},jt=()=>{const x=t=>Array(t).fill(0).map((l,m)=>e.jsxs(A,{children:[e.jsx(i,{children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"center",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})})]},m));return e.jsxs(z,{elevation:2,sx:{p:3,mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(c,{animation:"wave",height:40,width:"40%"}),e.jsx(a,{children:e.jsx(c,{animation:"wave",variant:"rectangular",width:170,height:36,sx:{borderRadius:1}})})]}),e.jsxs(a,{sx:{p:2},children:[e.jsxs(s,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(s,{item:!0,xs:12,md:12,children:e.jsx(a,{sx:{textAlign:"center",mb:2},children:e.jsx(c,{animation:"wave",height:50,width:"50%",sx:{mx:"auto"}})})}),e.jsxs(s,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(c,{animation:"wave",height:30,width:200}),e.jsx(c,{animation:"wave",height:20,width:180}),e.jsx(c,{animation:"wave",height:20,width:160}),e.jsx(c,{animation:"wave",height:20,width:140})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsx(c,{animation:"wave",height:20,width:150}),e.jsx(c,{animation:"wave",height:20,width:150}),e.jsx(c,{animation:"wave",height:20,width:150}),e.jsx(c,{animation:"wave",height:20,width:150})]})]})]}),e.jsxs(s,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(s,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{mb:1},children:[e.jsx(c,{animation:"wave",height:24,width:"80%"}),e.jsx(c,{animation:"wave",height:20,width:"70%"}),e.jsx(c,{animation:"wave",height:20,width:"50%"}),e.jsx(c,{animation:"wave",height:20,width:"60%"})]})}),e.jsx(s,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{textAlign:"right"},children:[e.jsx(c,{animation:"wave",height:24,width:"60%",sx:{ml:"auto"}}),e.jsx(c,{animation:"wave",height:24,width:"40%",sx:{ml:"auto"}})]})})]}),e.jsx(ne,{sx:{my:1}}),e.jsx(c,{animation:"wave",height:28,width:"20%",sx:{mb:1}}),e.jsx(N,{component:z,variant:"outlined",sx:{mb:2},children:e.jsxs(Q,{size:"small",children:[e.jsx(G,{children:e.jsxs(A,{children:[e.jsx(i,{children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"center",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})}),e.jsx(i,{align:"right",children:e.jsx(c,{animation:"wave",height:24})})]})}),e.jsx(U,{children:x(5)})]})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e.jsx(c,{animation:"wave",height:20,width:160}),e.jsx(c,{animation:"wave",height:20,width:140})]}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(s,{container:!0,spacing:0,sx:{maxWidth:"400px"},children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{ml:"auto"}})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:20,width:"60%",sx:{ml:"auto"}})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{ml:"auto"}})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:20,width:"60%",sx:{ml:"auto"}})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:24,width:"90%",sx:{ml:"auto"}})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(c,{animation:"wave",height:24,width:"70%",sx:{ml:"auto"}})})]})})]}),e.jsxs(s,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})})]}),e.jsxs(s,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"center",gap:30},children:[e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(s,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(c,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})})]})]})]})},Bt=()=>{const{id:x}=Ae(),t=Te(),l=be(),[m,w]=h.useState(!0),[u,b]=h.useState(null),{getSaleById:d}=he(),f=async(C,j=!1)=>{j||w(!0);try{const r=await d(C);if(r)b(r);else return console.error("Delivery report not found"),null}catch(r){return console.error("Error fetching delivery report:",r),null}j||w(!1)};h.useEffect(()=>{(async()=>{var j;if((j=t.state)!=null&&j.reportData){b(t.state.reportData),w(!1);return}x&&f(x)})()},[x,t.state]);const v=()=>{l("/app/sales-list")};return e.jsxs($e,{maxWidth:"xxl",sx:{mt:4,mb:4},children:[e.jsxs(qe,{sx:{mb:2},children:[e.jsxs(ye,{underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>l("/app/dashboard"),children:[e.jsx(Pe,{style:{marginRight:8}}),"Dashboard"]}),e.jsxs(ye,{underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>l("/app/sales-list"),children:[e.jsx(Je,{style:{marginRight:8}}),"Sales"]}),e.jsx(n,{color:"text.primary",children:"Delivery Report"})]}),e.jsx(a,{sx:{mb:2},children:e.jsx(S,{variant:"outlined",startIcon:e.jsx(Ne,{}),onClick:v,children:"Back to Sales"})}),m?e.jsx(jt,{}):u?e.jsx(mt,{refresh:f,report:u}):e.jsxs(z,{sx:{p:3,textAlign:"center"},children:[e.jsx(n,{variant:"h6",color:"error",children:"Delivery report not found or could not be loaded"}),e.jsx(S,{variant:"contained",sx:{mt:2},onClick:v,children:"Go to Sales List"})]})]})};export{Bt as default};

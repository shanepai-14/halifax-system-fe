import{r as j,a8 as H,a9 as z,j as e,q as a,T as t,y as Y,Y as de,I as ce,G as i,D as S,P as k,Q as ee,aB as te,R as xe,a1 as oe,b7 as he,b8 as ue}from"./index-jDIXAb2S.js";import{l as ne}from"./index-Bvijw4Ij.js";import{D as je,a as me,b as ge}from"./DialogTitle-BjmUltT8.js";import{D as pe}from"./DialogContentText-BQsRm76W.js";import{c as q,d as P,e as B,a as I,b as s,f as O,T as J}from"./TextField-BKTWEUZi.js";import{D as ve}from"./DialogActions-DkjioFdp.js";import{B as T}from"./InputLabel-GSHbBSGO.js";import{R as ie}from"./PrinterOutlined-CniVPLOs.js";import{R as ye}from"./CloseOutlined-DgFTxuYc.js";import{S as r}from"./Skeleton-Cb0-qA4q.js";import{C as fe}from"./Container-Cg-bcfkS.js";import{L as K}from"./Link-DR75JYSo.js";import{R as be}from"./ArrowLeftOutlined-RFlew5oV.js";var we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},Ce=function(n,d){return j.createElement(H,z({},n,{ref:d,icon:we}))},_e=j.forwardRef(Ce),Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"}}]},name:"home",theme:"outlined"},De=function(n,d){return j.createElement(H,z({},n,{ref:d,icon:Re}))},se=j.forwardRef(De),Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},Ae=function(n,d){return j.createElement(H,z({},n,{ref:d,icon:Fe}))},Ie=j.forwardRef(Ae);const Te=({open:h,onClose:n,returnItems:d,handleReturnQuantityChange:c,returnReason:C,setReturnReason:D,handleSubmitCreditMemo:_,returns:m=[]})=>{const[y,R]=j.useState([]);j.useEffect(()=>{if(d&&d.length>0){const l={};m&&m.length>0&&m.forEach(w=>{w.items.forEach(F=>{const A=F.product_id;l[A]||(l[A]=0),l[A]+=parseInt(F.quantity)})});const u=d.map(w=>{const F=w.product_id,A=l[F]||0,E=Math.max(0,w.max_quantity-A);return{...w,original_max_quantity:w.max_quantity,max_quantity:E,already_returned:A}});R(u)}else R([])},[d,m]);const b=y.some(l=>l.max_quantity>0),o=y.reduce((l,u)=>l+parseFloat(u.sold_price)*u.return_quantity,0);return e.jsxs(je,{open:h,onClose:n,maxWidth:"md",fullWidth:!0,children:[e.jsx(me,{children:"Create Credit Memo"}),e.jsxs(ge,{children:[e.jsx(pe,{children:"Specify the items and quantities to be returned. Only items that are part of this delivery report can be returned."}),m&&m.length>0&&e.jsxs(a,{sx:{mt:2,mb:2,p:2,bgcolor:"background.level2",borderRadius:1},children:[e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Previous Returns:"}),m.map((l,u)=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Y,{label:l.credit_memo_number,size:"small",color:"primary",variant:"outlined",sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[new Date(l.return_date).toLocaleDateString()," - ₱",parseFloat(l.refund_amount).toFixed(2)]})]},l.id))]}),e.jsx(q,{sx:{mt:2},children:e.jsxs(P,{size:"small",children:[e.jsx(B,{children:e.jsxs(I,{children:[e.jsx(s,{children:"Item"}),e.jsx(s,{children:"Code"}),e.jsx(s,{align:"right",children:"Price"}),e.jsx(s,{align:"center",children:"Original Qty"}),e.jsx(s,{align:"center",children:"Already Returned"}),e.jsx(s,{align:"center",children:"Available"}),e.jsx(s,{align:"center",children:"Return Quantity"}),e.jsx(s,{align:"right",children:"Total"})]})}),e.jsxs(O,{children:[y.map(l=>{var u,w;return e.jsxs(I,{sx:l.max_quantity===0?{backgroundColor:"rgba(0,0,0,0.04)"}:{},children:[e.jsx(s,{children:(u=l.product)==null?void 0:u.product_name}),e.jsx(s,{children:(w=l.product)==null?void 0:w.product_code}),e.jsxs(s,{align:"right",children:["₱",parseFloat(l.sold_price).toFixed(2)]}),e.jsx(s,{align:"center",children:l.original_max_quantity}),e.jsxs(s,{align:"center",children:[l.already_returned>0&&e.jsx(Y,{label:l.already_returned,size:"small",color:"warning",variant:"outlined"}),l.already_returned===0&&"-"]}),e.jsx(s,{align:"center",children:l.max_quantity}),e.jsx(s,{align:"center",children:e.jsx(J,{type:"number",InputProps:{inputProps:{min:0,max:l.max_quantity}},value:l.return_quantity,onChange:F=>c(l.id,F.target.value,l.already_returned),size:"small",sx:{width:"80px"},disabled:l.max_quantity===0})}),e.jsxs(s,{align:"right",children:["₱",(parseFloat(l.sold_price)*l.return_quantity).toFixed(2)]})]},l.id)}),e.jsxs(I,{children:[e.jsx(s,{colSpan:7,align:"right",children:e.jsx(t,{variant:"subtitle2",children:"Total Return Amount:"})}),e.jsx(s,{align:"right",children:e.jsxs(t,{variant:"subtitle2",children:["₱",o.toFixed(2)]})})]})]})]})}),!b&&e.jsx(a,{sx:{mt:2,p:2,bgcolor:"error.lighter",borderRadius:1},children:e.jsx(t,{variant:"body2",color:"error.main",children:"All items have been fully returned. No further returns are possible."})}),e.jsx(J,{margin:"dense",id:"returnReason",label:"Reason for Return",multiline:!0,rows:3,fullWidth:!0,variant:"outlined",value:C,onChange:l=>D(l.target.value),sx:{mt:3},disabled:!b})]}),e.jsxs(ve,{children:[e.jsx(T,{onClick:n,children:"Cancel"}),e.jsx(T,{onClick:_,variant:"contained",color:"primary",disabled:!b||o<=0,children:"Create Credit Memo"})]})]})},X=h=>h?new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"",Me=({open:h,onClose:n,returns:d,report:c})=>{var m,y,R,b;const C=j.useRef(),D=ne.useReactToPrint({contentRef:C}),_=(d==null?void 0:d.reduce((o,l)=>o+parseFloat(l.refund_amount),0))||0;return!d||d.length===0?null:e.jsx(de,{open:h,onClose:n,"aria-labelledby":"credit-memo-modal-title",children:e.jsxs(a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:"850px",maxHeight:"90vh",overflow:"auto",bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(t,{id:"credit-memo-modal-title",variant:"h5",children:"Credit Memo Details"}),e.jsxs(a,{children:[e.jsx(T,{variant:"outlined",color:"primary",startIcon:e.jsx(ie,{}),onClick:D,sx:{mr:1},children:"Print"}),e.jsx(ce,{onClick:n,color:"default",children:e.jsx(ye,{})})]})]}),e.jsxs(a,{ref:C,sx:{p:2},children:[e.jsxs(i,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,md:12,children:e.jsxs(a,{sx:{textAlign:"center",mb:2},children:[e.jsx(t,{variant:"h4",children:"CREDIT MEMO"}),e.jsxs(t,{variant:"body2",children:["DR #: ",c==null?void 0:c.invoice_number]})]})}),e.jsxs(i,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(t,{variant:"h6",children:"Halifax Glass & Aluminum Supply"}),e.jsx(t,{variant:"body2",children:"Malagamot Road, Panacan"}),e.jsx(t,{variant:"body2",children:"glasshalifax@gmail.com"}),e.jsx(t,{variant:"body2",children:"0939 924 3876"})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Date:"})," ",X(new Date)]}),e.jsxs(t,{variant:"subtitle2",children:[e.jsx("strong",{children:"Customer:"})," ",((m=c==null?void 0:c.customer)==null?void 0:m.business_name)||((y=c==null?void 0:c.customer)==null?void 0:y.customer_name)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Address:"})," ",((R=c==null?void 0:c.customer)==null?void 0:R.business_address)||(c==null?void 0:c.address)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Phone:"})," ",c==null?void 0:c.phone]})]})]})]}),e.jsx(S,{sx:{my:2}}),d.map((o,l)=>e.jsxs(a,{sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(t,{variant:"subtitle1",children:["Credit Memo #",o.credit_memo_number]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Date:"})," ",X(o.return_date)]})]}),e.jsx(q,{component:k,variant:"outlined",sx:{mb:1},children:e.jsxs(P,{size:"small",children:[e.jsx(B,{children:e.jsxs(I,{children:[e.jsx(s,{children:"Item"}),e.jsx(s,{children:"Code"}),e.jsx(s,{align:"right",children:"Price"}),e.jsx(s,{align:"center",children:"Quantity"}),e.jsx(s,{align:"right",children:"Total"}),e.jsx(s,{children:"Condition"}),e.jsx(s,{children:"Reason"})]})}),e.jsx(O,{children:o.items.map(u=>e.jsxs(I,{children:[e.jsx(s,{children:`Product #${u.product_id}`}),e.jsx(s,{children:`P-${u.product_id}`}),e.jsxs(s,{align:"right",children:["₱",parseFloat(u.price).toFixed(2)]}),e.jsx(s,{align:"center",children:u.quantity}),e.jsxs(s,{align:"right",children:["₱",parseFloat(u.subtotal).toFixed(2)]}),e.jsx(s,{children:u.condition}),e.jsx(s,{children:u.return_reason})]},u.id))})]})}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(i,{container:!0,spacing:0,sx:{maxWidth:"300px"},children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body1",fontWeight:"bold",align:"right",children:"Refund Amount:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body1",fontWeight:"bold",align:"right",children:["₱",parseFloat(o.refund_amount).toFixed(2)]})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:"Method:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:o.refund_method.toUpperCase()})})]})}),l<d.length-1&&e.jsx(S,{sx:{my:2}})]},o.id)),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsxs(i,{container:!0,spacing:0,sx:{maxWidth:"300px"},children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"h6",fontWeight:"bold",align:"right",children:"Total Refund:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"h6",fontWeight:"bold",align:"right",children:["₱",_.toFixed(2)]})})]})}),((b=d[0])==null?void 0:b.remarks)&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(t,{variant:"subtitle2",children:"Remarks:"}),e.jsx(t,{variant:"body2",children:d[0].remarks})]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(i,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Prepared By"})})}),e.jsx(i,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Approved By"})})}),e.jsx(i,{item:!0,xs:3,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Customer Signature"})})})]})]})]})})},Z=h=>h?new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"",ke=({refresh:h,report:n})=>{var $,Q,G,U,N;const[d,c]=j.useState(!1),[C,D]=j.useState(!1),[_,m]=j.useState([]),[y,R]=j.useState(""),b=ee(),o=j.useRef(),{createCreditMemo:l}=te();xe.useEffect(()=>{n&&n.items&&m(n.items.map(x=>({...x,return_quantity:0,max_quantity:x.quantity})))},[n]);const u=ne.useReactToPrint({contentRef:o}),w=()=>{c(!0)},F=()=>{c(!1)},A=()=>{D(!0)},E=()=>{D(!1)},ae=(x,g,v)=>{const f=Math.max(0,parseInt(g)||0);m(_.map(p=>{if(p.id===x){const M=p.max_quantity-(v||0);return{...p,return_quantity:Math.min(f,M)}}return p}))},re=async()=>{const x=_.filter(v=>v.return_quantity>0);if(x.length===0){alert("Please specify at least one item to return");return}const g=x.reduce((v,f)=>v+f.return_quantity*f.sold_price,0);try{const v={sale_id:n.id,remarks:y,refund_method:"cash",refund_amount:g,items:x.map(p=>({sale_item_id:p.id,product_id:p.product_id,quantity:p.return_quantity,price:p.sold_price}))};await l(v)&&(F(),h(n.id))}catch{}},L=(($=n==null?void 0:n.returns)==null?void 0:$.reduce((x,g)=>{var f;const v=((f=g.items)==null?void 0:f.reduce((p,M)=>p+parseFloat(M.quantity||0)*parseFloat(M.price||0),0))||0;return x+v},0))||0;if(!n)return e.jsxs(a,{sx:{p:4,textAlign:"center"},children:[e.jsx(t,{variant:"h5",children:"No delivery report data available"}),e.jsx(T,{variant:"contained",startIcon:e.jsx(se,{}),onClick:()=>b("/dashboard"),sx:{mt:2},children:"Go to Dashboard"})]});const W=n.items.reduce((x,g)=>x+parseFloat(g.sold_price)*g.quantity,0),V=n.items.reduce((x,g)=>{const f=parseFloat(g.sold_price)*g.quantity*(parseFloat(g.discount)/100);return x+f},0),le=W-V;return e.jsxs(e.Fragment,{children:[e.jsxs(k,{elevation:2,sx:{p:3,mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(t,{variant:"h5",children:"Delivery Report Details"}),e.jsxs(a,{children:[e.jsx(T,{variant:"outlined",color:"primary",startIcon:e.jsx(ie,{}),onClick:u,sx:{mr:1},children:"Print"}),e.jsx(T,{variant:"outlined",color:"secondary",startIcon:e.jsx(Ie,{}),onClick:w,disabled:!1,children:"Create Credit Memo"})]})]}),e.jsxs(a,{ref:o,sx:{p:2},children:[e.jsxs(i,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,md:12,children:e.jsx(a,{sx:{textAlign:"center",mb:2},children:e.jsx(t,{variant:"h4",children:"DELIVERY REPORT"})})}),e.jsxs(i,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(t,{variant:"h6",children:"Halifax Glass & Aluminum Supply"}),e.jsx(t,{variant:"body2",children:"Malagamot Road, Panacan"}),e.jsx(t,{variant:"body2",children:"glasshalifax@gmail.com"}),e.jsx(t,{variant:"body2",children:"0939 924 3876"})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Order Date:"})," ",Z(n.order_date)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Delivery Date:"})," ",Z(n.delivery_date)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Payment Method:"})," ",n.payment_method.toUpperCase()]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",n.status.toUpperCase()]})]})]})]}),e.jsxs(i,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(i,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{mb:1},children:[e.jsxs(t,{variant:"subtitle2",children:[e.jsx("strong",{children:" Delivered to:"}),"  ",((Q=n.customer)==null?void 0:Q.business_name)||((G=n.customer)==null?void 0:G.customer_name)]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Address:"}),"  ",((U=n.customer)==null?void 0:U.business_address)||n.address]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"City:"}),"  ",n.city]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Phone:"}),"  ",n.phone]})]})}),e.jsx(i,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{textAlign:"right"},children:[e.jsxs(t,{variant:"subtitle2",children:[e.jsx("strong",{children:"DR #:"})," ",n.invoice_number]}),n.term_days!==0&&n.term_days&&e.jsx(e.Fragment,{children:e.jsxs(t,{variant:"subtitle2",children:[e.jsx("strong",{children:"Term :"})," ",n.term_days]})})]})})]}),e.jsx(S,{sx:{my:1}}),e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Order Items"}),e.jsx(q,{component:k,variant:"outlined",sx:{mb:2},children:e.jsxs(P,{size:"small",children:[e.jsx(B,{children:e.jsxs(I,{children:[e.jsx(s,{children:"Item"}),e.jsx(s,{children:"Code"}),e.jsx(s,{align:"right",children:"Price"}),e.jsx(s,{align:"center",children:"Qty"}),e.jsx(s,{align:"right",children:"Discount (%)"}),e.jsx(s,{align:"right",children:"Subtotal"})]})}),e.jsx(O,{children:n.items.map(x=>{var p,M;const g=parseFloat(x.sold_price)*x.quantity,v=g*(parseFloat(x.discount)/100),f=g-v;return e.jsxs(I,{children:[e.jsx(s,{children:(p=x.product)==null?void 0:p.product_name}),e.jsx(s,{children:(M=x.product)==null?void 0:M.product_code}),e.jsxs(s,{align:"right",children:["₱",parseFloat(x.sold_price).toFixed(2)]}),e.jsx(s,{align:"center",children:x.quantity}),e.jsxs(s,{align:"right",children:[parseFloat(x.discount).toFixed(2),"%"]}),e.jsxs(s,{align:"right",children:["₱",f.toFixed(2)]})]},x.id)})})]})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Delivery Status:"})," ",n.is_delivered?"Delivered":"Pending Delivery"]}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Encoded By:"})," ",(N=n.user)==null?void 0:N.name]})]}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(i,{container:!0,spacing:0,sx:{maxWidth:"400px"},children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:"Subtotal:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",align:"right",children:["₱",W.toFixed(2)]})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:"Discount:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",align:"right",children:["₱",V.toFixed(2)]})}),n.returns&&n.returns.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",onClick:A,sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},children:"Credit Memo Total:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",align:"right",onClick:A,sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},children:["₱",L.toFixed(2)]})})]}),e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body1",fontWeight:"bold",align:"right",children:"Total Amount:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body1",fontWeight:"bold",align:"right",children:["₱",(le-(L||0)).toFixed(2)]})}),n.amount_received!=="0.00"&&n.amount_received&&e.jsxs(e.Fragment,{children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:"Amount Received:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",align:"right",children:["₱",parseFloat(n.amount_received).toFixed(2)]})})]}),n.change!=="0.00"&&n.change&&e.jsxs(e.Fragment,{children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(t,{variant:"body2",align:"right",children:"Change:"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",align:"right",children:["₱",parseFloat(n.change).toFixed(2)," ",typeof n.change]})})]})]})})]}),n.remarks&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(t,{variant:"subtitle2",children:"Remarks:"}),e.jsx(t,{variant:"body2",children:n.remarks})]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Prepared By"})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Checked By"})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Released By"})})})]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"center",gap:30},children:[e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Delivered By"})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:e.jsx(t,{variant:"caption",children:"Received By"})})})]})]})]}),e.jsx(Te,{open:d,onClose:F,returnItems:_,handleReturnQuantityChange:ae,returnReason:y,setReturnReason:R,handleSubmitCreditMemo:re,returns:n.returns}),n.returns&&n.returns.length>0&&e.jsx(Me,{open:C,onClose:E,returns:n.returns,report:n})]})},Se=()=>{const h=n=>Array(n).fill(0).map((d,c)=>e.jsxs(I,{children:[e.jsx(s,{children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"center",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})})]},c));return e.jsxs(k,{elevation:2,sx:{p:3,mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(r,{animation:"wave",height:40,width:"40%"}),e.jsx(a,{children:e.jsx(r,{animation:"wave",variant:"rectangular",width:170,height:36,sx:{borderRadius:1}})})]}),e.jsxs(a,{sx:{p:2},children:[e.jsxs(i,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,md:12,children:e.jsx(a,{sx:{textAlign:"center",mb:2},children:e.jsx(r,{animation:"wave",height:50,width:"50%",sx:{mx:"auto"}})})}),e.jsxs(i,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[e.jsx(r,{animation:"wave",height:30,width:200}),e.jsx(r,{animation:"wave",height:20,width:180}),e.jsx(r,{animation:"wave",height:20,width:160}),e.jsx(r,{animation:"wave",height:20,width:140})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[e.jsx(r,{animation:"wave",height:20,width:150}),e.jsx(r,{animation:"wave",height:20,width:150}),e.jsx(r,{animation:"wave",height:20,width:150}),e.jsx(r,{animation:"wave",height:20,width:150})]})]})]}),e.jsxs(i,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(i,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{mb:1},children:[e.jsx(r,{animation:"wave",height:24,width:"80%"}),e.jsx(r,{animation:"wave",height:20,width:"70%"}),e.jsx(r,{animation:"wave",height:20,width:"50%"}),e.jsx(r,{animation:"wave",height:20,width:"60%"})]})}),e.jsx(i,{item:!0,xs:6,md:6,children:e.jsxs(a,{sx:{textAlign:"right"},children:[e.jsx(r,{animation:"wave",height:24,width:"60%",sx:{ml:"auto"}}),e.jsx(r,{animation:"wave",height:24,width:"40%",sx:{ml:"auto"}})]})})]}),e.jsx(S,{sx:{my:1}}),e.jsx(r,{animation:"wave",height:28,width:"20%",sx:{mb:1}}),e.jsx(q,{component:k,variant:"outlined",sx:{mb:2},children:e.jsxs(P,{size:"small",children:[e.jsx(B,{children:e.jsxs(I,{children:[e.jsx(s,{children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"center",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})}),e.jsx(s,{align:"right",children:e.jsx(r,{animation:"wave",height:24})})]})}),e.jsx(O,{children:h(5)})]})}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-start"},children:[e.jsx(r,{animation:"wave",height:20,width:160}),e.jsx(r,{animation:"wave",height:20,width:140})]}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(i,{container:!0,spacing:0,sx:{maxWidth:"400px"},children:[e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{ml:"auto"}})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:20,width:"60%",sx:{ml:"auto"}})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{ml:"auto"}})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:20,width:"60%",sx:{ml:"auto"}})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:24,width:"90%",sx:{ml:"auto"}})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(r,{animation:"wave",height:24,width:"70%",sx:{ml:"auto"}})})]})})]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"space-between"},children:[e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})})]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:4,px:2,display:"flex",justifyContent:"center",gap:30},children:[e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})}),e.jsx(i,{item:!0,xs:2.4,children:e.jsx(a,{sx:{borderTop:"1px solid #e0e0e0",pt:1,textAlign:"center"},children:e.jsx(r,{animation:"wave",height:20,width:"80%",sx:{mx:"auto"}})})})]})]})]})},Ue=()=>{const{id:h}=oe(),n=he(),d=ee(),[c,C]=j.useState(!0),[D,_]=j.useState(null),{getSaleById:m}=te(),y=async b=>{C(!0);try{const o=await m(b);if(o)_(o);else return console.error("Delivery report not found"),null}catch(o){return console.error("Error fetching delivery report:",o),null}C(!1)};j.useEffect(()=>{(async()=>{var o;if((o=n.state)!=null&&o.reportData){_(n.state.reportData),C(!1);return}h&&y(h)})()},[h,n.state]);const R=()=>{d("/app/sales-list")};return e.jsxs(fe,{maxWidth:"xxl",sx:{mt:4,mb:4},children:[e.jsxs(ue,{sx:{mb:2},children:[e.jsxs(K,{underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>d("/app/dashboard"),children:[e.jsx(se,{style:{marginRight:8}}),"Dashboard"]}),e.jsxs(K,{underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>d("/app/sales-list"),children:[e.jsx(_e,{style:{marginRight:8}}),"Sales"]}),e.jsx(t,{color:"text.primary",children:"Delivery Report"})]}),e.jsx(a,{sx:{mb:2},children:e.jsx(T,{variant:"outlined",startIcon:e.jsx(be,{}),onClick:R,children:"Back to Sales"})}),c?e.jsx(Se,{}):D?e.jsx(ke,{refresh:y,report:D}):e.jsxs(k,{sx:{p:3,textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"error",children:"Delivery report not found or could not be loaded"}),e.jsx(T,{variant:"contained",sx:{mt:2},onClick:R,children:"Go to Sales List"})]})]})};export{Ue as default};

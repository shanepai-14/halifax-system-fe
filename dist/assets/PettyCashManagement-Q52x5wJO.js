import{r as x,a8 as ae,a9 as le,aC as or,S as G,bn as Or,bo as Mr,bp as $r,bq as Sr,br as Br,bs as Lr,bt as qr,bu as J,$ as M,bv as Vr,bw as Q,t as F,bx as Hr,by as Ur,bz as Gr,bA as rr,bB as Kr,bC as Oe,bD as Yr,bE as Jr,bF as Qr,bG as Xr,bH as Zr,bI as en,bJ as Ie,bK as Me,bL as Pe,bM as rn,bN as nn,bO as sn,bP as nr,bQ as sr,bR as tr,bS as tn,bT as an,bU as ln,bV as on,j as e,q as z,T as n,I as W,E as te,F as Y,bW as cn,G as c,P as V,D as ze,y as B,C as ee,x as re,ae as cr,af as we,H as K,ac as ar,ab as dn,M as un}from"./index-Chkw8LpN.js";import{u as $e,w as xn}from"./xlsx-DjuO7_Ju.js";import{D as ie}from"./Dialog-ACxKU5r-.js";import{D as oe,a as ce}from"./DialogTitle-Ch3X7RlB.js";import{R as ne}from"./CloseOutlined-B2N1Ghrl.js";import{T as O,S as X,c as pe,d as je,e as ge,a as N,b as a,f as fe}from"./TextField-Czzb7ycq.js";import{D as de}from"./DialogActions-WQ4-Ebxu.js";import{B as $,I as Z,a as De}from"./InputLabel-aB29g19v.js";import{C as ue}from"./CircularProgress-B2CTOErf.js";import{R as dr}from"./SaveOutlined-Cm8_oIR-.js";import{R as Te}from"./PlusOutlined-1JNR4_VJ.js";import{M as C}from"./MenuItem-DKP--nxm.js";import{R as qe}from"./DeleteOutlined-Cnk7YRvG.js";import{A as ur}from"./Alert-QgAfafU6.js";import{A as hn}from"./Autocomplete-LFVe6RBn.js";import{f as L,a as ve}from"./currencyFormat-jXf0VaAX.js";import{l as xr}from"./index-DjoJsxSL.js";import{R as Ae}from"./PrinterOutlined-CDDEv-TO.js";import{R as mn,a as pn}from"./ReloadOutlined-CEK2A_kA.js";import{R as hr}from"./SearchOutlined-K4PNmaK5.js";import{R as Ve}from"./FilterOutlined-2DlRXOcz.js";import{R as Be}from"./EyeOutlined-D0GiIrrB.js";import{R as He}from"./EditOutlined-jQCM4PCc.js";import{D as jn}from"./DialogContentText-CuwziPzK.js";import{R as gn}from"./WarningOutlined-3Nvk1Rhg.js";var fn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},vn=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:fn}))},bn=x.forwardRef(vn),yn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"},_n=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:yn}))},En=x.forwardRef(_n),wn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},Tn=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:wn}))},ke=x.forwardRef(Tn),An={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},Dn=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:An}))},mr=x.forwardRef(Dn),Fn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar-circle",theme:"outlined"},In=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:Fn}))},Pn=x.forwardRef(In),Rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"},zn=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:Rn}))},Ce=x.forwardRef(zn),kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"},Cn=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:kn}))},Wn=x.forwardRef(Cn),Nn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},On=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:Nn}))},Le=x.forwardRef(On),Mn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 464H528V448h312v128zm0 264H184V184h656v200H496c-17.7 0-32 14.3-32 32v192c0 17.7 14.3 32 32 32h344v200zM580 512a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"wallet",theme:"outlined"},$n=function(i,t){return x.createElement(ae,le({},i,{ref:t,icon:Mn}))},Sn=x.forwardRef($n);const be=()=>{const r=or(),i=G(Or),t=G(Mr),j=G($r),o=G(Sr),h=G(Br),E=G(Lr),g=G(qr);return{funds:i,transactions:t,stats:j,balance:o,loading:h,error:E,filters:g,getBalance:async()=>{var _,s;try{r(J());const l=await M.get("/petty-cash/balance");return r(Vr(l.data.data)),l.data.data}catch(l){return console.error("Error fetching petty cash balance:",l),r(Q(l.message)),F.error(((s=(_=l.response)==null?void 0:_.data)==null?void 0:s.message)||"Failed to fetch petty cash balance"),null}},getAllFunds:async(_={})=>{var s,l;try{r(J());const u={search:g.search||_.search,status:g.status!=="all"?g.status:void 0,date_from:g.startDate||_.startDate,date_to:g.endDate||_.endDate,sort_by:_.sort_by||"date",sort_order:_.sort_order||"desc"},v=await M.get("/petty-cash/funds",{params:u});return r(Hr(v.data.data)),v.data.data}catch(u){return console.error("Error fetching petty cash funds:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to fetch petty cash funds"),[]}},createFund:async _=>{var s,l;try{r(J());const v={...(await M.post("/petty-cash/funds",_)).data.data};return r(Ur(v)),F.success("Petty cash fund created successfully"),v}catch(u){throw console.error("Error creating petty cash fund:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to create petty cash fund"),u}},approveFund:async _=>{var s,l;try{r(J());const v={...(await M.put(`/petty-cash/funds/${_}/approve`)).data.data};return r(Gr(v)),F.success("Petty cash fund approved successfully"),v}catch(u){throw console.error("Error approving petty cash fund:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to approve petty cash fund"),u}},getAllTransactions:async(_={})=>{var s,l;try{r(J());const u={search:g.search||_.search,status:g.status!=="all"?g.status:void 0,employee_id:g.employeeId||_.employeeId,date_from:g.startDate||_.startDate,date_to:g.endDate||_.endDate},v=await M.get("/petty-cash/transactions",{params:u});return r(rr(v.data.data)),v.data.data}catch(u){return console.error("Error fetching petty cash transactions:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to fetch petty cash transactions"),[]}},createTransaction:async _=>{var s,l;try{r(J());let u;_ instanceof FormData?u=await M.post("/petty-cash/transactions",_,{headers:{"Content-Type":"multipart/form-data"}}):u=await M.post("/petty-cash/transactions",_);const v={...u.data.data,created_at:new Date().toISOString()};return r(Kr(v)),F.success("Petty cash transaction created successfully"),v}catch(u){throw console.error("Error creating petty cash transaction:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to create petty cash transaction"),u}},settleTransaction:async(_,s)=>{var l,u;try{r(J());let v;s instanceof FormData?v=await M.put(`/petty-cash/transactions/${_}/settle`,s,{headers:{"Content-Type":"multipart/form-data"}}):v=await M.put(`/petty-cash/transactions/${_}/settle`,s);const q={...v.data.data};return r(Oe(q)),F.success("Petty cash transaction settled successfully"),q}catch(v){throw console.error("Error settling petty cash transaction:",v),r(Q(v.message)),F.error(((u=(l=v.response)==null?void 0:l.data)==null?void 0:u.message)||"Failed to settle petty cash transaction"),v}},approveTransaction:async _=>{var s,l;try{r(J());const v={...(await M.put(`/petty-cash/transactions/${_}/approve`)).data.data};return r(Oe(v)),F.success("Petty cash transaction approved successfully"),v}catch(u){throw console.error("Error approving petty cash transaction:",u),r(Q(u.message)),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to approve petty cash transaction"),u}},cancelTransaction:async(_,s)=>{var l,u;try{r(J());const v=await M.put(`/petty-cash/transactions/${_}/cancel`,{reason:s});return r(Oe(v.data.data)),F.success("Petty cash transaction cancelled successfully"),v.data.data}catch(v){throw console.error("Error cancelling petty cash transaction:",v),r(Q(v.message)),F.error(((u=(l=v.response)==null?void 0:l.data)==null?void 0:u.message)||"Failed to cancel petty cash transaction"),v}},getStats:async()=>{var _,s;try{r(J());const l=await M.get("/petty-cash/stats");return r(Yr(l.data.data)),l.data.data}catch(l){return console.error("Error fetching petty cash stats:",l),r(Q(l.message)),F.error(((s=(_=l.response)==null?void 0:_.data)==null?void 0:s.message)||"Failed to fetch petty cash statistics"),null}},getEmployeeTransactions:async(_,s={})=>{var l,u;try{r(J());const v={status:g.status!=="all"?g.status:void 0,date_from:g.startDate||s.startDate,date_to:g.endDate||s.endDate,sort_by:s.sort_by||"date",sort_order:s.sort_order||"desc"},q=await M.get(`/petty-cash/employees/${_}/transactions`,{params:v});return r(rr(q.data.data)),q.data.data}catch(v){return console.error("Error fetching employee transactions:",v),r(Q(v.message)),F.error(((u=(l=v.response)==null?void 0:l.data)==null?void 0:u.message)||"Failed to fetch employee transactions"),[]}}}},Fe=()=>{const r=or(),i=G(Jr),t=G(Qr),j=G(Xr),o=G(Zr),h=G(en);return{employees:i,stats:t,loading:j,error:o,filters:h,getAllEmployees:async(y={})=>{var f,d;try{r(Ie());const m={search:h.search||y.search,status:h.status!=="all"?h.status:void 0,department:h.department!=="all"?h.department:void 0,sort_by:y.sort_by||"created_at",sort_order:y.sort_order||"desc"},D=await M.get("/employees",{params:m});return r(Me(D.data.data)),D.data.data}catch(m){return console.error("Error fetching employees:",m),r(Pe(m.message)),F.error(((d=(f=m.response)==null?void 0:f.data)==null?void 0:d.message)||"Failed to fetch employees"),[]}},getEmployeeById:async y=>{var f,d;try{r(Ie());const m=await M.get(`/employees/${y}`);return r(Me([m.data.data])),m.data.data}catch(m){return console.error("Error fetching employee:",m),r(Pe(m.message)),F.error(((d=(f=m.response)==null?void 0:f.data)==null?void 0:d.message)||"Failed to fetch employee"),null}},createEmployee:async y=>{var f,d;try{r(rn());const m=await M.post("/employees",y);return r(nn(m.data.data)),F.success("Employee created successfully"),m.data.data}catch(m){throw console.error("Error creating employee:",m),r(sn(m.message)),F.error(((d=(f=m.response)==null?void 0:f.data)==null?void 0:d.message)||"Failed to create employee"),m}},updateEmployee:async(y,f)=>{var d,m;try{r(nr());const D=await M.put(`/employees/${y}`,f);return r(sr(D.data.data)),F.success("Employee updated successfully"),D.data.data}catch(D){throw console.error("Error updating employee:",D),r(tr(D.message)),F.error(((m=(d=D.response)==null?void 0:d.data)==null?void 0:m.message)||"Failed to update employee"),D}},deleteEmployee:async y=>{var f,d;try{return r(tn()),await M.delete(`/employees/${y}`),r(an(y)),F.success("Employee deleted successfully"),!0}catch(m){throw console.error("Error deleting employee:",m),r(ln(m.message)),F.error(((d=(f=m.response)==null?void 0:f.data)==null?void 0:d.message)||"Failed to delete employee"),m}},getEmployeeStats:async()=>{var y,f;try{r(Ie());const d=await M.get("/employees/stats");return r(on(d.data.data)),d.data.data}catch(d){return console.error("Error fetching employee statistics:",d),r(Pe(d.message)),F.error(((f=(y=d.response)==null?void 0:y.data)==null?void 0:f.message)||"Failed to fetch employee statistics"),null}},getTrashedEmployees:async()=>{var y,f;try{r(Ie());const d=await M.get("/employees/trashed");return r(Me(d.data.data)),d.data.data}catch(d){return console.error("Error fetching trashed employees:",d),r(Pe(d.message)),F.error(((f=(y=d.response)==null?void 0:y.data)==null?void 0:f.message)||"Failed to fetch trashed employees"),[]}},restoreEmployee:async y=>{var f,d;try{r(nr());const m=await M.post(`/employees/${y}/restore`);return r(sr(m.data.data)),F.success("Employee restored successfully"),m.data.data}catch(m){throw console.error("Error restoring employee:",m),r(tr(m.message)),F.error(((d=(f=m.response)==null?void 0:f.data)==null?void 0:d.message)||"Failed to restore employee"),m}}}},Bn=({open:r,onClose:i,onSuccess:t})=>{const[j,o]=x.useState({date:new Date().toISOString().split("T")[0],amount:"",description:""}),[h,E]=x.useState({}),{createFund:g,loading:I}=be(),T=b=>{const{name:y,value:f}=b.target;o(d=>({...d,[y]:f})),h[y]&&E(d=>({...d,[y]:null}))},k=()=>{const b={};return j.date||(b.date="Date is required"),j.amount?parseFloat(j.amount)<=0&&(b.amount="Amount must be greater than 0"):b.amount="Amount is required",j.description.trim()||(b.description="Description is required"),E(b),Object.keys(b).length===0},P=async b=>{if(b.preventDefault(),!!k())try{const y={...j,amount:parseFloat(j.amount)},f=await g(y);w(!0,f)}catch(y){console.error("Error adding fund:",y)}},w=(b=!1,y=null)=>{o({date:new Date().toISOString().split("T")[0],amount:"",description:""}),E({}),b?t(y):i()};return e.jsxs(ie,{open:r,onClose:()=>w(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(n,{variant:"h6",children:"Add Petty Cash Fund"}),e.jsx(W,{edge:"end",color:"inherit",onClick:()=>w(),"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs("form",{onSubmit:P,children:[e.jsxs(ce,{children:[e.jsx(O,{margin:"dense",fullWidth:!0,label:"Date",type:"date",name:"date",value:j.date,onChange:T,error:!!h.date,helperText:h.date,InputLabelProps:{shrink:!0}}),e.jsx(O,{margin:"dense",fullWidth:!0,label:"Amount",type:"number",name:"amount",value:j.amount,onChange:T,error:!!h.amount,helperText:h.amount,InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(Ce,{})})}}),e.jsx(O,{margin:"dense",fullWidth:!0,label:"Description",name:"description",value:j.description,onChange:T,error:!!h.description,helperText:h.description,multiline:!0,rows:3})]}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>w(),color:"primary",disabled:I,children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",color:"primary",disabled:I,startIcon:I?e.jsx(ue,{size:24}):null,children:I?"Submitting...":"Add Fund"})]})]})]})},Ln=({value:r,onChange:i,error:t,helperText:j,name:o="purpose",label:h="Purpose *"})=>{const[E,g]=x.useState([]),[I,T]=x.useState(!1),[k,P]=x.useState(!1),[w,b]=x.useState("");x.useEffect(()=>{y()},[]);const y=async()=>{T(!0);try{const s=await M.get("/purposes");g(s.data.data)}catch(s){console.error("Error loading purposes:",s),F.error("Failed to load purposes")}finally{T(!1)}},f=s=>{console.log(s.target.value),i({target:{name:o,value:s.target.value}})},d=()=>{P(!0)},m=()=>{P(!1),b("")},D=async()=>{var s,l;if(!w.trim()){F.error("Purpose name cannot be empty");return}try{const v=(await M.post("/purposes",{name:w})).data.data;g([...E,v]),i({target:{name:o,value:v.id}}),F.success("Purpose created successfully"),P(!1),b("")}catch(u){console.error("Error creating purpose:",u),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to create purpose")}},_=async(s,l)=>{var u,v;l.stopPropagation();try{await M.delete(`/purposes/${s.id}`),g(E.filter(q=>q.id!==s.id)),r===s.id&&i({target:{name:o,value:""}}),F.success("Purpose deleted successfully")}catch(q){console.error("Error deleting purpose:",q),F.error(((v=(u=q.response)==null?void 0:u.data)==null?void 0:v.message)||"Failed to delete purpose")}};return e.jsx(e.Fragment,{children:k?e.jsxs(z,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:[e.jsx(O,{fullWidth:!0,label:"New Purpose Name",value:w,onChange:s=>b(s.target.value),autoFocus:!0,size:"small",margin:"dense"}),e.jsx(W,{color:"primary",onClick:D,size:"small",sx:{mt:1},children:e.jsx(dr,{})}),e.jsx(W,{onClick:m,size:"small",sx:{mt:1},children:e.jsx(ne,{})})]}):e.jsxs(Y,{fullWidth:!0,error:!!t,margin:"dense",children:[e.jsx(Z,{id:`${o}-label`,children:h}),e.jsx(X,{labelId:`${o}-label`,value:r||"",onChange:f,label:h,disabled:I,endAdornment:e.jsx(te,{position:"end",children:e.jsx(W,{onClick:d,edge:"end",size:"small",sx:{mr:1},children:e.jsx(Te,{})})}),renderValue:s=>{const l=E.find(u=>u.name===s);return(l==null?void 0:l.name)||""},children:E.length===0?e.jsx(C,{disabled:!0,children:I?"Loading...":"No purposes available"}):E.map(s=>e.jsxs(C,{value:s.name,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:s.name}),e.jsx(W,{size:"small",color:"error",onClick:l=>_(s,l),children:e.jsx(qe,{})})]},s.name))}),j&&e.jsx(De,{children:j})]})})},qn=({value:r,onChange:i,error:t,helperText:j,name:o="expense",label:h="Expense *"})=>{const[E,g]=x.useState([]),[I,T]=x.useState(!1),[k,P]=x.useState(!1),[w,b]=x.useState("");x.useEffect(()=>{y()},[]);const y=async()=>{T(!0);try{const s=await M.get("/expenses");g(s.data.data)}catch(s){console.error("Error loading expenses:",s),F.error("Failed to load expenses")}finally{T(!1)}},f=s=>{i({target:{name:o,value:s.target.value}})},d=()=>{P(!0)},m=()=>{P(!1),b("")},D=async()=>{var s,l;if(!w.trim()){F.error("Expense name cannot be empty");return}try{const v=(await M.post("/expenses",{name:w})).data.data;g([...E,v]),i({target:{name:o,value:v.id}}),F.success("Expense created successfully"),P(!1),b("")}catch(u){console.error("Error creating expense:",u),F.error(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to create expense")}},_=async(s,l)=>{var u,v;l.stopPropagation();try{await M.delete(`/expenses/${s.id}`),g(E.filter(q=>q.id!==s.id)),r===s.id&&i({target:{name:o,value:""}}),F.success("Expense deleted successfully")}catch(q){console.error("Error deleting expense:",q),F.error(((v=(u=q.response)==null?void 0:u.data)==null?void 0:v.message)||"Failed to delete expense")}};return e.jsx(e.Fragment,{children:k?e.jsxs(z,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:[e.jsx(O,{fullWidth:!0,label:"New Expense Name",value:w,onChange:s=>b(s.target.value),autoFocus:!0,size:"small",margin:"dense"}),e.jsx(W,{color:"primary",onClick:D,size:"small",sx:{mt:1},children:e.jsx(dr,{})}),e.jsx(W,{onClick:m,size:"small",sx:{mt:1},children:e.jsx(ne,{})})]}):e.jsxs(Y,{fullWidth:!0,error:!!t,margin:"dense",children:[e.jsx(Z,{id:`${o}-label`,children:h}),e.jsx(X,{labelId:`${o}-label`,value:r||"",onChange:f,label:h,disabled:I,endAdornment:e.jsx(te,{position:"end",children:e.jsx(W,{onClick:d,edge:"end",size:"small",sx:{mr:1},children:e.jsx(Te,{})})}),renderValue:s=>{const l=E.find(u=>u.name===s);return(l==null?void 0:l.name)||""},children:E.length===0?e.jsx(C,{disabled:!0,children:I?"Loading...":"No expenses available"}):E.map(s=>e.jsxs(C,{value:s.name,sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:s.name}),e.jsx(W,{size:"small",color:"error",onClick:l=>_(s,l),children:e.jsx(qe,{})})]},s.name))}),j&&e.jsx(De,{children:j})]})})},Vn=({open:r,onClose:i,onSuccess:t,employees:j,balance:o})=>{const[h,E]=x.useState({employee_id:"",purpose:"",expense:"",description:"",amount_issued:""}),[g,I]=x.useState({}),{createTransaction:T,loading:k}=be(),P=f=>{const{name:d,value:m}=f.target;E(D=>({...D,[d]:m})),g[d]&&I(D=>({...D,[d]:null}))},w=()=>{const f={};return h.employee_id||(f.employee_id="Employee is required"),h.purpose.trim()||(f.purpose="Purpose is required"),h.expense.trim()||(f.expense="Expense is required"),h.amount_issued?parseFloat(h.amount_issued)<=0?f.amount_issued="Amount must be greater than 0":parseFloat(h.amount_issued)>o&&(f.amount_issued="Amount cannot exceed available balance"):f.amount_issued="Amount is required",I(f),Object.keys(f).length===0},b=async f=>{if(f.preventDefault(),!!w())try{const d={...h,amount_issued:parseFloat(h.amount_issued)},m=await T(d);y(!0,m)}catch(d){console.error("Error adding transaction:",d)}},y=(f=!1,d=null)=>{E({employee_id:"",purpose:"",expense:"",description:"",amount_issued:""}),I({}),f?t(d):i()};return e.jsxs(ie,{open:r,onClose:()=>y(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(n,{variant:"h6",children:"New Petty Cash Transaction"}),e.jsx(W,{edge:"end",color:"inherit",onClick:()=>y(),"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs("form",{onSubmit:b,children:[e.jsxs(ce,{children:[e.jsxs(ur,{severity:"info",sx:{mb:2},children:["Available Balance: ",new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(o)]}),e.jsx(Y,{fullWidth:!0,margin:"dense",error:!!g.employee_id,children:e.jsx(hn,{id:"employee-autocomplete",options:j||[],getOptionLabel:f=>`${f.full_name} - ${f.position}`,value:j.find(f=>f.id===h.employee_id)||null,onChange:(f,d)=>{P({target:{name:"employee_id",value:d?d.id:""}})},renderInput:f=>e.jsx(O,{...f,label:"Employee *",error:!!g.employee_id,helperText:g.employee_id,InputProps:{...f.InputProps,startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(te,{position:"start",children:e.jsx(cn,{})}),f.InputProps.startAdornment]})}}),noOptionsText:"No employees available",loading:j.length===0,loadingText:"Loading employees..."})}),e.jsx(Ln,{value:h.purpose,onChange:P,error:!!g.purpose,helperText:g.purpose,name:"purpose",label:"Purpose *"}),e.jsx(qn,{value:h.expense,onChange:P,error:!!g.expense,helperText:g.expense,name:"expense",label:"Expense Type *"}),e.jsx(O,{margin:"dense",fullWidth:!0,label:"Description",name:"description",value:h.description,onChange:P,multiline:!0,rows:2}),e.jsx(O,{margin:"dense",fullWidth:!0,label:"Amount to Issue *",type:"number",name:"amount_issued",value:h.amount_issued,onChange:P,error:!!g.amount_issued,helperText:g.amount_issued,InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(Ce,{})})}})]}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>y(),color:"primary",disabled:k,children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",color:"primary",disabled:k||!j.length,startIcon:k?e.jsx(ue,{size:24}):null,children:k?"Submitting...":"Create Transaction"})]})]})]})},pr=({open:r,onClose:i,onSuccess:t,transaction:j})=>{var _;const[o,h]=x.useState({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),[E,g]=x.useState({}),[I,T]=x.useState(""),[k,P]=x.useState(0),{settleTransaction:w,loading:b}=be();x.useEffect(()=>{j&&(h({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),g({}),T(""))},[j]),x.useEffect(()=>{if(j&&o.amount_spent){const s=parseFloat(j.amount_issued),l=parseFloat(o.amount_spent)||0,u=s-l;P(u>=0?u:0),u>=0&&h(v=>({...v,amount_returned:Number(u)}))}},[o.amount_spent,j]);const y=s=>{const{name:l,value:u}=s.target;h(v=>({...v,[l]:u})),E[l]&&g(v=>({...v,[l]:null}))},f=s=>{const l=s.target.files[0];if(T(""),l){if(l.size>2*1024*1024){T("File size must be less than 2MB");return}if(!["image/jpeg","image/png","application/pdf"].includes(l.type)){T("Only JPG, PNG, and PDF files are allowed");return}h(v=>({...v,receipt_attachment:l}))}},d=()=>{const s={};if(o.amount_spent?parseFloat(o.amount_spent)<0?s.amount_spent="Amount spent cannot be negative":j&&parseFloat(o.amount_spent)>parseFloat(j.amount_issued)&&(s.amount_spent="Amount spent cannot exceed issued amount"):s.amount_spent="Amount spent is required",o.amount_returned===null||o.amount_returned===""||o.amount_returned===void 0?s.amount_returned="Amount returned is required":parseFloat(o.amount_returned)<0&&(s.amount_returned="Amount returned cannot be negative"),j&&o.amount_spent&&o.amount_returned&&!s.amount_spent&&!s.amount_returned){const l=parseFloat(j.amount_issued),u=parseFloat(o.amount_spent),v=parseFloat(o.amount_returned);Math.abs(u+v-l)>.01&&(s.amount_returned="Total of spent and returned must equal issued amount")}return g(s),Object.keys(s).length===0},m=async s=>{if(s.preventDefault(),!(!d()||I))try{let l;o.receipt_attachment?(l=new FormData,l.append("amount_spent",o.amount_spent),l.append("amount_returned",o.amount_returned),l.append("remarks",o.remarks),l.append("receipt_attachment",o.receipt_attachment)):l={amount_spent:parseFloat(o.amount_spent),amount_returned:parseFloat(o.amount_returned),remarks:o.remarks},await w(j.id,l),D(!0)}catch(l){console.error("Error settling transaction:",l)}},D=(s=!1)=>{h({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),g({}),T(""),s?t():i()};return j?e.jsxs(ie,{open:r,onClose:()=>D(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(n,{variant:"h6",children:"Settle Transaction"}),e.jsx(W,{edge:"end",color:"inherit",onClick:()=>D(),"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs("form",{onSubmit:m,children:[e.jsxs(ce,{children:[e.jsxs(ur,{severity:"info",sx:{mb:2},children:["Transaction Reference: ",j.transaction_reference,e.jsx("br",{}),"Employee: ",(_=j.employee)==null?void 0:_.full_name,e.jsx("br",{}),"Issued Amount: ",L(j.amount_issued)]}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{margin:"dense",fullWidth:!0,label:"Amount Spent *",type:"number",name:"amount_spent",value:o.amount_spent,onChange:y,error:!!E.amount_spent,helperText:E.amount_spent,InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(Ce,{})})}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{margin:"dense",fullWidth:!0,label:"Amount Returned *",type:"number",name:"amount_returned",value:o.amount_returned,onChange:y,error:!!E.amount_returned,helperText:E.amount_returned,InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(Ce,{})})}})})]}),o.amount_spent&&e.jsxs(n,{variant:"body2",color:"textSecondary",sx:{mt:1},children:["Remaining amount to be returned: ",L(k)]}),e.jsx(O,{margin:"dense",fullWidth:!0,label:"Remarks",name:"remarks",value:o.remarks,onChange:y,multiline:!0,rows:2}),e.jsxs(z,{sx:{mt:2},children:[e.jsx(n,{variant:"body2",gutterBottom:!0,children:"Receipt Attachment"}),e.jsxs($,{variant:"outlined",component:"label",startIcon:e.jsx(Wn,{}),fullWidth:!0,children:["Upload Receipt",e.jsx("input",{type:"file",hidden:!0,accept:"image/jpeg,image/png,application/pdf",onChange:f})]}),o.receipt_attachment&&e.jsxs(n,{variant:"caption",display:"block",sx:{mt:1},children:["Selected file: ",o.receipt_attachment.name]}),I&&e.jsx(De,{error:!0,children:I})]})]}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>D(),color:"primary",disabled:b,children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",color:"primary",disabled:b,startIcon:b?e.jsx(ue,{size:24}):null,children:b?"Submitting...":"Settle Transaction"})]})]})]}):null},Hn=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",lr=({open:r,onClose:i,transaction:t,isNew:j=!1})=>{var g,I,T,k,P,w,b;const o=x.useRef(),h=xr.useReactToPrint({contentRef:o});if(!t)return null;const E=y=>({issued:"ISSUED",settled:"SETTLED",approved:"APPROVED",cancelled:"CANCELLED"})[y]||y.toUpperCase();return e.jsxs(ie,{open:r,onClose:i,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(oe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[e.jsx(n,{variant:"h6",children:j?"New Transaction Receipt":"Transaction Receipt"}),e.jsxs(z,{children:[e.jsx(W,{color:"primary",onClick:h,sx:{mr:1},children:e.jsx(Ae,{})}),e.jsx(W,{onClick:i,children:e.jsx(ne,{})})]})]}),e.jsx(ce,{dividers:!0,children:e.jsxs(z,{ref:o,sx:{p:3},children:[e.jsxs(z,{sx:{textAlign:"center",mb:3},children:[e.jsx(n,{variant:"h4",children:"PETTY CASH TRANSACTION"}),e.jsx(n,{variant:"h6",children:t.transaction_reference}),e.jsx(z,{sx:{display:"inline-block",border:1,borderColor:"divider",borderRadius:1,px:2,py:.5,mt:1,backgroundColor:t.status==="approved"?"success.light":t.status==="issued"?"primary.light":t.status==="settled"?"info.light":"error.light"},children:e.jsx(n,{variant:"subtitle1",fontWeight:"bold",children:E(t.status)})})]}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{children:"Halifax Glass & Aluminum Supply"}),e.jsx(n,{children:"Malagamot Road, Panacan"}),e.jsx(n,{children:"glasshalifax@gmail.com"}),e.jsx(n,{children:"0939 924 3876"})]}),e.jsxs(c,{item:!0,xs:6,sx:{textAlign:"right"},children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Date:"})," ",Hn(t.created_at)]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Purpose:"})," ",t.purpose]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Expense:"})," ",t.expense]}),t.status==="settled"||t.status==="approved"?e.jsxs(n,{children:[e.jsx("strong",{children:"Settled on:"})," ",ve(t.updated_at)]}):null]})]}),e.jsxs(V,{variant:"outlined",sx:{p:2,mb:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Employee Information"}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsxs(c,{item:!0,xs:6,children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Name:"})," ",((g=t.employee)==null?void 0:g.full_name)||"N/A"]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Position:"})," ",((I=t.employee)==null?void 0:I.position)||"N/A"]})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Department:"})," ",((T=t.employee)==null?void 0:T.department)||"N/A"]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Contact:"})," ",((k=t.employee)==null?void 0:k.phone_number)||"N/A"]})]})]})]}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Transaction Summary"}),e.jsx(pe,{component:V,variant:"outlined",sx:{mb:3},children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:e.jsx("strong",{children:"Description"})}),e.jsx(a,{align:"right",children:e.jsx("strong",{children:"Amount"})})]})}),e.jsxs(fe,{children:[e.jsxs(N,{children:[e.jsx(a,{children:"Amount Issued"}),e.jsx(a,{align:"right",children:L(t.amount_issued)})]}),(t.status==="settled"||t.status==="approved")&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(a,{children:"Amount Spent"}),e.jsx(a,{align:"right",children:L(t.amount_spent)})]}),e.jsxs(N,{children:[e.jsx(a,{children:"Amount Returned"}),e.jsx(a,{align:"right",children:L(t.amount_returned)})]})]})]})]})}),t.description&&e.jsxs(z,{sx:{mb:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Description"}),e.jsx(V,{variant:"outlined",sx:{p:2},children:e.jsx(n,{children:t.description})})]}),t.remarks&&e.jsxs(z,{sx:{mb:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Remarks"}),e.jsx(V,{variant:"outlined",sx:{p:2},children:e.jsx(n,{children:t.remarks})})]}),e.jsx(ze,{sx:{my:3}}),e.jsxs(c,{container:!0,spacing:4,sx:{mt:3},children:[e.jsx(c,{item:!0,xs:4,children:e.jsxs(z,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:[e.jsx(n,{children:"Issued By"}),e.jsx(n,{variant:"caption",children:((P=t.issuer)==null?void 0:P.name)||"System User"})]})}),e.jsx(c,{item:!0,xs:4,children:e.jsxs(z,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:[e.jsx(n,{children:"Received By"}),e.jsx(n,{variant:"caption",children:((w=t.employee)==null?void 0:w.full_name)||"Employee"})]})}),e.jsx(c,{item:!0,xs:4,children:e.jsxs(z,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:[e.jsx(n,{children:"Approved By"}),e.jsx(n,{variant:"caption",children:t.status==="approved"?((b=t.approver)==null?void 0:b.name)||"Manager":""})]})})]}),e.jsx(z,{sx:{mt:4,textAlign:"center"},children:e.jsx(n,{variant:"caption",color:"textSecondary",children:"This document serves as an official record of petty cash disbursement."})})]})}),e.jsxs(de,{sx:{p:2},children:[e.jsx($,{variant:"outlined",startIcon:e.jsx(Ae,{}),onClick:h,children:"Print Receipt"}),e.jsx($,{variant:"contained",onClick:i,children:"Close"})]})]})},Re=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",ir=({open:r,onClose:i,fund:t,isNew:j=!1})=>{var g,I,T,k;const o=x.useRef(),h=xr.useReactToPrint({contentRef:o});if(!t)return null;const E=P=>{switch(P){case"approved":return e.jsx(B,{label:"APPROVED",color:"success"});case"pending":return e.jsx(B,{label:"PENDING",color:"warning"});case"rejected":return e.jsx(B,{label:"REJECTED",color:"error"});default:return e.jsx(B,{label:P.toUpperCase()})}};return e.jsxs(ie,{open:r,onClose:i,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsxs(oe,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[e.jsx(n,{variant:"h6",children:j?"New Fund Receipt":"Fund Receipt"}),e.jsxs(z,{children:[e.jsx(W,{color:"primary",onClick:h,sx:{mr:1},children:e.jsx(Ae,{})}),e.jsx(W,{onClick:i,children:e.jsx(ne,{})})]})]}),e.jsx(ce,{dividers:!0,children:e.jsxs(z,{ref:o,sx:{p:3},children:[e.jsxs(z,{sx:{textAlign:"center",mb:3},children:[e.jsx(n,{variant:"h4",children:"PETTY CASH FUND"}),e.jsx(n,{variant:"h6",children:t.transaction_reference}),e.jsx(z,{sx:{mt:1},children:E(t.status)})]}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{children:"Halifax Glass & Aluminum Supply"}),e.jsx(n,{children:"Malagamot Road, Panacan"}),e.jsx(n,{children:"glasshalifax@gmail.com"}),e.jsx(n,{children:"0939 924 3876"})]}),e.jsxs(c,{item:!0,xs:6,sx:{textAlign:"right"},children:[e.jsxs(n,{children:[e.jsx("strong",{children:"Created on:"})," ",Re(t.created_at)]}),t.status==="approved"&&e.jsxs(n,{children:[e.jsx("strong",{children:"Approved on:"})," ",Re(t.updated_at)]})]})]}),e.jsxs(V,{variant:"outlined",sx:{p:3,mb:3,textAlign:"center",backgroundColor:t.status==="approved"?"success.light":"background.paper"},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Fund Amount"}),e.jsx(n,{variant:"h3",children:L(t.amount)})]}),e.jsxs(V,{variant:"outlined",sx:{p:2,mb:3},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Description"}),e.jsx(n,{children:t.description})]}),e.jsxs(c,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(c,{item:!0,xs:6,children:e.jsxs(V,{variant:"outlined",sx:{p:2,height:"100%"},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Created By"}),e.jsx(n,{children:((g=t.creator)==null?void 0:g.name)||"System User"}),e.jsx(n,{variant:"caption",color:"textSecondary",children:Re(t.created_at)})]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(V,{variant:"outlined",sx:{p:2,height:"100%"},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Approved By"}),t.status==="approved"?e.jsxs(e.Fragment,{children:[e.jsx(n,{children:((I=t.approver)==null?void 0:I.name)||"Manager"}),e.jsx(n,{variant:"caption",color:"textSecondary",children:Re(t.updated_at)})]}):e.jsx(n,{color:"textSecondary",children:"Pending approval"})]})})]}),e.jsx(ze,{sx:{my:3}}),e.jsxs(c,{container:!0,spacing:4,sx:{mt:3},children:[e.jsx(c,{item:!0,xs:6,children:e.jsxs(z,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:[e.jsx(n,{children:"Prepared By"}),e.jsx(n,{variant:"caption",children:((T=t.creator)==null?void 0:T.name)||"System User"})]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(z,{sx:{borderTop:"1px solid #000",pt:1,textAlign:"center"},children:[e.jsx(n,{children:"Approved By"}),e.jsx(n,{variant:"caption",children:t.status==="approved"?((k=t.approver)==null?void 0:k.name)||"Manager":""})]})})]}),e.jsx(z,{sx:{mt:4,textAlign:"center"},children:e.jsx(n,{variant:"caption",color:"textSecondary",children:"This document serves as an official record of petty cash fund allocation."})})]})}),e.jsxs(de,{sx:{p:2},children:[e.jsx($,{variant:"outlined",startIcon:e.jsx(Ae,{}),onClick:h,children:"Print Receipt"}),e.jsx($,{variant:"contained",onClick:i,children:"Close"})]})]})},Un=()=>{const[r,i]=x.useState(0),[t,j]=x.useState(!1),[o,h]=x.useState(!1),[E,g]=x.useState(!1),[I,T]=x.useState(!1),[k,P]=x.useState(!1),[w,b]=x.useState(null),[y,f]=x.useState(null),[d,m]=x.useState("all"),[D,_]=x.useState(""),[s,l]=x.useState("all"),[u,v]=x.useState(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[q,ye]=x.useState(new Date().toISOString().split("T")[0]),[_e,A]=x.useState(!1),[H,R]=x.useState(!1),[jr,Ue]=x.useState(null),[gr,Ge]=x.useState(null),[fr,vr]=x.useState(0),{funds:xe,transactions:he,balance:Ke,getBalance:br,getAllFunds:yr,getAllTransactions:_r,approveFund:Er,approveTransaction:wr,cancelTransaction:Tr,settleTransaction:Ar,loading:Ee}=be(),{employees:Ye,getAllEmployees:Dr,loading:Xn}=Fe();x.useEffect(()=>{me(),Dr()},[r,fr]);const me=async()=>{try{const p={search:D,status:s!=="all"?s:void 0,startDate:u,endDate:q,employeeId:d!=="all"?d:void 0};r===0?await _r(p):await yr(p),await br()}catch(p){console.error("Error loading data:",p)}},Fr=()=>{vr(p=>p+1)},Je=()=>{me()},Ir=(p,S)=>{i(S)},Qe=async(p,S)=>{try{if(S==="fund"){const se=await Er(p);se&&(f(se),P(!0))}else{const se=await wr(p);se&&(b(se),T(!0))}me()}catch(se){console.error("Error approving item:",se)}},Pr=async p=>{try{const S=prompt("Please enter a reason for cancellation:");S&&(await Tr(p,S),me())}catch(S){console.error("Error cancelling transaction:",S)}},Rr=p=>{b(p),g(!0)},zr=async p=>{try{const S=await Ar(w.id,p);S&&(g(!1),b(S),T(!0),me())}catch(S){console.error("Error settling transaction:",S)}},We=p=>{b(p),T(!0)},Ne=p=>{f(p),P(!0)},kr=p=>{j(!1),Ue(p),A(!0),me()},Cr=p=>{h(!1),Ge(p),R(!0),me()},Xe=p=>{switch(p){case"approved":return e.jsx(B,{label:"Approved",color:"success",size:"small"});case"pending":return e.jsx(B,{label:"Pending",color:"warning",size:"small"});case"settled":return e.jsx(B,{label:"Settled",color:"info",size:"small"});case"issued":return e.jsx(B,{label:"Issued",color:"primary",size:"small"});case"cancelled":return e.jsx(B,{label:"Cancelled",color:"error",size:"small"});case"rejected":return e.jsx(B,{label:"Rejected",color:"error",size:"small"});default:return e.jsx(B,{label:p,size:"small"})}},Wr=()=>{try{const p=r===0?he:xe;let S=[];r===0?(S.push(["Reference","Date","Employee","Purpose","Expense","Issued Amount","Spent Amount","Returned Amount","Status"]),p.forEach(U=>{var er;S.push([U.transaction_reference||"",ve(U.date)||"",((er=U.employee)==null?void 0:er.full_name)||"",U.purpose||"",U.expense||"",U.amount_issued||0,U.amount_spent||0,U.amount_returned||0,U.status||""])})):(S.push(["Reference","Date","Description","Amount","Status"]),p.forEach(U=>{S.push([U.transaction_reference||"",ve(U.date)||"",U.description||"",U.amount||0,U.status||""])}));const se=$e.aoa_to_sheet(S),Ze=$e.book_new();$e.book_append_sheet(Ze,se,r===0?"Transactions":"Funds");const Nr=`PettyCash_${r===0?"Transactions":"Funds"}_${new Date().toISOString().split("T")[0]}.xlsx`;xn(Ze,Nr),F.success(`${r===0?"Transactions":"Funds"} exported successfully`)}catch(p){console.error("Error exporting to Excel:",p),F.error("Failed to export data")}};return e.jsxs(z,{children:[e.jsx(ee,{sx:{mb:3},children:e.jsx(re,{children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsxs(c,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Current Balance"}),e.jsx(n,{variant:"h4",children:L(Ke||0)})]}),e.jsx(c,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs(z,{children:[e.jsx($,{variant:"outlined",color:"primary",startIcon:e.jsx(mn,{}),onClick:Fr,sx:{mr:2},disabled:Ee,children:"Refresh"}),e.jsx($,{variant:"contained",color:"primary",startIcon:e.jsx(Te,{}),onClick:()=>j(!0),sx:{mr:2},children:"Add Funds"}),e.jsx($,{variant:"contained",color:"secondary",startIcon:e.jsx(Te,{}),onClick:()=>h(!0),children:"New Transaction"})]})})]})})}),e.jsxs(z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(z,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(cr,{value:r,onChange:Ir,"aria-label":"petty cash sub-tabs",textColor:"primary",indicatorColor:"primary",children:[e.jsx(we,{label:"Transactions",id:"petty-cash-subtab-0"}),e.jsx(we,{label:"Funds",id:"petty-cash-subtab-1"})]})}),e.jsxs(z,{children:[e.jsx($,{variant:"outlined",color:"primary",startIcon:e.jsx(Ae,{}),onClick:()=>{r===0&&he.length>0?We(he[0]):r===1&&xe.length>0?Ne(xe[0]):F.info("No records available to view")},sx:{mr:2},disabled:Ee||(r===0?he.length===0:xe.length===0),children:"View Latest"}),e.jsx($,{variant:"outlined",color:"primary",startIcon:e.jsx(pn,{}),onClick:Wr,disabled:Ee||(r===0?he.length===0:xe.length===0),children:"Export to Excel"})]})]}),e.jsx(V,{sx:{p:2,mb:3},children:e.jsxs(c,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(c,{item:!0,xs:12,md:3,children:e.jsx(O,{fullWidth:!0,placeholder:"Search",value:D,onChange:p=>_(p.target.value),onKeyPress:p=>p.key==="Enter"&&Je(),InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(hr,{})})},size:"small"})}),e.jsx(c,{item:!0,xs:12,md:2,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(Z,{children:"Status"}),e.jsxs(X,{value:s,onChange:p=>l(p.target.value),label:"Status",children:[e.jsx(C,{value:"all",children:"All Status"}),e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"approved",children:"Approved"}),r===0&&[e.jsx(C,{value:"issued",children:"Issued"},"issued"),e.jsx(C,{value:"settled",children:"Settled"},"settled"),e.jsx(C,{value:"cancelled",children:"Cancelled"},"cancelled")],r===1&&e.jsx(C,{value:"rejected",children:"Rejected"})]})]})}),r===0&&e.jsx(c,{item:!0,xs:12,md:2,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(Z,{children:"Employee"}),e.jsxs(X,{value:d,onChange:p=>m(p.target.value),label:"Employee",children:[e.jsx(C,{value:"all",children:"All Employees"}),[...Ye.map(p=>e.jsx(C,{value:p.id,children:p.full_name},p.id))]]})]})}),e.jsx(c,{item:!0,xs:6,md:2,children:e.jsx(O,{label:"Start Date",type:"date",value:u,onChange:p=>v(p.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,size:"small"})}),e.jsx(c,{item:!0,xs:6,md:2,children:e.jsx(O,{label:"End Date",type:"date",value:q,onChange:p=>ye(p.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,size:"small",inputProps:{min:u}})}),e.jsx(c,{item:!0,xs:12,md:1,children:e.jsx($,{variant:"contained",color:"primary",fullWidth:!0,onClick:Je,startIcon:e.jsx(Ve,{}),children:"Filter"})})]})}),r===1?e.jsx(pe,{component:V,children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Reference"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Description"}),e.jsx(a,{align:"right",children:"Amount"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Created By"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(fe,{children:Ee?e.jsx(N,{children:e.jsx(a,{colSpan:7,align:"center",children:e.jsx(ue,{size:24})})}):xe.length===0?e.jsx(N,{children:e.jsx(a,{colSpan:7,align:"center",children:"No funds found"})}):xe.map(p=>{var S;return e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(n,{component:"span",sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},onClick:()=>Ne(p),children:p.transaction_reference})}),e.jsx(a,{children:ve(p.date)}),e.jsx(a,{children:p.description}),e.jsx(a,{align:"right",children:L(p.amount)}),e.jsx(a,{children:Xe(p.status)}),e.jsx(a,{children:((S=p.creator)==null?void 0:S.name)||"-"}),e.jsxs(a,{children:[e.jsx(K,{title:"View Receipt",children:e.jsx(W,{color:"primary",size:"small",onClick:()=>Ne(p),children:e.jsx(Be,{})})}),p.status==="pending"&&e.jsx(K,{title:"Approve",children:e.jsx(W,{color:"success",size:"small",onClick:()=>Qe(p.id,"fund"),children:e.jsx(ke,{})})})]})]},p.id)})})]})}):e.jsx(pe,{component:V,children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Reference"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Employee"}),e.jsx(a,{children:"Purpose"}),e.jsx(a,{children:"Expense"}),e.jsx(a,{align:"right",children:"Issued"}),e.jsx(a,{align:"right",children:"Spent"}),e.jsx(a,{align:"right",children:"Returned"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(fe,{children:Ee?e.jsx(N,{children:e.jsx(a,{colSpan:9,align:"center",children:e.jsx(ue,{size:24})})}):he.length===0?e.jsx(N,{children:e.jsx(a,{colSpan:9,align:"center",children:"No transactions found"})}):he.map(p=>{var S;return e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(n,{component:"span",sx:{cursor:"pointer",color:"primary.main","&:hover":{textDecoration:"underline"}},onClick:()=>We(p),children:p.transaction_reference})}),e.jsx(a,{children:ve(p.date)}),e.jsx(a,{children:((S=p.employee)==null?void 0:S.full_name)||"-"}),e.jsx(a,{children:p.purpose}),e.jsx(a,{children:p.expense}),e.jsx(a,{align:"right",children:L(p.amount_issued)}),e.jsx(a,{align:"right",children:L(p.amount_spent||0)}),e.jsx(a,{align:"right",children:L(p.amount_returned||0)}),e.jsx(a,{children:Xe(p.status)}),e.jsxs(a,{children:[e.jsx(K,{title:"View Receipt",children:e.jsx(W,{color:"primary",size:"small",onClick:()=>We(p),children:e.jsx(Be,{})})}),p.status==="issued"&&e.jsx(K,{title:"Settle",children:e.jsx(W,{color:"primary",size:"small",onClick:()=>Rr(p),children:e.jsx(He,{})})}),p.status==="settled"&&e.jsx(K,{title:"Approve",children:e.jsx(W,{color:"success",size:"small",onClick:()=>Qe(p.id,"transaction"),children:e.jsx(ke,{})})}),(p.status==="issued"||p.status==="settled")&&e.jsx(K,{title:"Cancel",children:e.jsx(W,{color:"error",size:"small",onClick:()=>Pr(p.id),children:e.jsx(mr,{})})})]})]},p.id)})})]})}),e.jsx(Bn,{open:t,onClose:()=>j(!1),onSuccess:kr}),e.jsx(Vn,{open:o,onClose:()=>h(!1),onSuccess:Cr,employees:Ye,balance:Ke||0}),e.jsx(pr,{open:E,onClose:()=>{g(!1),b(null)},onSuccess:zr,transaction:w}),e.jsx(ir,{open:k,onClose:()=>{P(!1),f(null)},fund:y}),e.jsx(lr,{open:I,onClose:()=>{T(!1),b(null)},transaction:w}),e.jsx(ir,{open:_e,onClose:()=>{A(!1),Ue(null)},fund:jr,isNew:!0}),e.jsx(lr,{open:H,onClose:()=>{R(!1),Ge(null)},transaction:gr,isNew:!0})]})},Gn=({open:r,onClose:i,onSuccess:t,departments:j=[]})=>{const[o,h]=x.useState({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),[E,g]=x.useState({}),[I,T]=x.useState(""),{createEmployee:k,loading:P}=Fe(),w=d=>{const{name:m,value:D}=d.target;h(_=>({..._,[m]:D})),E[m]&&g(_=>({..._,[m]:null}))},b=()=>{const d={};return o.full_name.trim()||(d.full_name="Full name is required"),o.position.trim()||(d.position="Position is required"),!o.department.trim()&&!I.trim()&&(d.department="Department is required"),o.email&&!/^\S+@\S+\.\S+$/.test(o.email)&&(d.email="Invalid email address"),g(d),Object.keys(d).length===0},y=async d=>{if(d.preventDefault(),!!b())try{const m={...o,department:o.department==="new"?I:o.department};await k(m),f(!0)}catch(m){console.error("Error adding employee:",m)}},f=(d=!1)=>{h({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),T(""),g({}),d?t():i()};return e.jsxs(ie,{open:r,onClose:()=>f(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(n,{variant:"h6",children:"Add Employee"}),e.jsx(W,{edge:"end",color:"inherit",onClick:()=>f(),"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs("form",{onSubmit:y,children:[e.jsx(ce,{children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,required:!0,label:"Full Name",name:"full_name",value:o.full_name,onChange:w,error:!!E.full_name,helperText:E.full_name})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,required:!0,label:"Position",name:"position",value:o.position,onChange:w,error:!!E.position,helperText:E.position})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(Y,{fullWidth:!0,error:!!E.department,required:!0,children:[e.jsx(Z,{children:"Department"}),e.jsxs(X,{name:"department",value:o.department,onChange:w,label:"Department *",children:[j.map(d=>e.jsx(C,{value:d,children:d},d)),e.jsx(C,{value:"new",children:e.jsx("em",{children:"Add New Department"})})]}),E.department&&e.jsx(De,{children:E.department})]})}),o.department==="new"&&e.jsx(c,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,required:!0,label:"New Department Name",value:I,onChange:d=>T(d.target.value),error:o.department==="new"&&!I.trim(),helperText:o.department==="new"&&!I.trim()?"New department name is required":""})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Email",name:"email",type:"email",value:o.email,onChange:w,error:!!E.email,helperText:E.email})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Phone Number",name:"phone_number",value:o.phone_number,onChange:w})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(Y,{fullWidth:!0,children:[e.jsx(Z,{children:"Status"}),e.jsxs(X,{name:"status",value:o.status,onChange:w,label:"Status",children:[e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"inactive",children:"Inactive"})]})]})})]})}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>f(),color:"primary",disabled:P,children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",color:"primary",disabled:P,startIcon:P?e.jsx(ue,{size:24}):null,children:P?"Adding...":"Add Employee"})]})]})]})},Kn=({open:r,onClose:i,onSuccess:t,employee:j,departments:o=[]})=>{const[h,E]=x.useState({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),[g,I]=x.useState({}),[T,k]=x.useState(""),{updateEmployee:P,loading:w}=Fe();x.useEffect(()=>{j&&E({full_name:j.full_name||"",position:j.position||"",department:j.department||"",email:j.email||"",phone_number:j.phone_number||"",status:j.status||"active"})},[j]);const b=m=>{const{name:D,value:_}=m.target;E(s=>({...s,[D]:_})),g[D]&&I(s=>({...s,[D]:null}))},y=()=>{const m={};return h.full_name.trim()||(m.full_name="Full name is required"),h.position.trim()||(m.position="Position is required"),!h.department.trim()&&!T.trim()&&(m.department="Department is required"),h.email&&!/^\S+@\S+\.\S+$/.test(h.email)&&(m.email="Invalid email address"),I(m),Object.keys(m).length===0},f=async m=>{if(m.preventDefault(),!(!j||!y()))try{const D={...h,department:h.department==="new"?T:h.department};await P(j.id,D),d(!0)}catch(D){console.error("Error updating employee:",D)}},d=(m=!1)=>{k(""),I({}),m?t():i()};return j?e.jsxs(ie,{open:r,onClose:()=>d(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(n,{variant:"h6",children:"Edit Employee"}),e.jsx(W,{edge:"end",color:"inherit",onClick:()=>d(),"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs("form",{onSubmit:f,children:[e.jsxs(ce,{children:[e.jsx(O,{margin:"dense",fullWidth:!0,label:"Employee Code",value:j.employee_code||"",disabled:!0}),e.jsxs(c,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,required:!0,label:"Full Name",name:"full_name",value:h.full_name,onChange:b,error:!!g.full_name,helperText:g.full_name})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,required:!0,label:"Position",name:"position",value:h.position,onChange:b,error:!!g.position,helperText:g.position})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(Y,{fullWidth:!0,error:!!g.department,required:!0,children:[e.jsx(Z,{children:"Department"}),e.jsxs(X,{name:"department",value:h.department,onChange:b,label:"Department *",children:[o.map(m=>e.jsx(C,{value:m,children:m},m)),e.jsx(C,{value:"new",children:e.jsx("em",{children:"Add New Department"})})]}),g.department&&e.jsx(De,{children:g.department})]})}),h.department==="new"&&e.jsx(c,{item:!0,xs:12,children:e.jsx(O,{fullWidth:!0,required:!0,label:"New Department Name",value:T,onChange:m=>k(m.target.value),error:h.department==="new"&&!T.trim(),helperText:h.department==="new"&&!T.trim()?"New department name is required":""})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Email",name:"email",type:"email",value:h.email,onChange:b,error:!!g.email,helperText:g.email})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(O,{fullWidth:!0,label:"Phone Number",name:"phone_number",value:h.phone_number,onChange:b})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(Y,{fullWidth:!0,children:[e.jsx(Z,{children:"Status"}),e.jsxs(X,{name:"status",value:h.status,onChange:b,label:"Status",children:[e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"inactive",children:"Inactive"})]})]})})]})]}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>d(),color:"primary",disabled:w,children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",color:"primary",disabled:w,startIcon:w?e.jsx(ue,{size:24}):null,children:w?"Updating...":"Update Employee"})]})]})]}):null},Yn=({open:r,onClose:i,employee:t})=>{const[j,o]=x.useState(new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0]),[h,E]=x.useState(new Date().toISOString().split("T")[0]),[g,I]=x.useState("all"),[T,k]=x.useState(!1),[P,w]=x.useState(null),{transactions:b,getEmployeeTransactions:y,approveTransaction:f,cancelTransaction:d,loading:m}=be();x.useEffect(()=>{r&&t&&D()},[r,t]);const D=async()=>{if(t)try{const A={status:g!=="all"?g:void 0,startDate:j,endDate:h};await y(t.id,A)}catch(A){console.error("Error loading employee transactions:",A)}},_=()=>{D()},s=async A=>{try{await f(A),D()}catch(H){console.error("Error approving transaction:",H)}},l=async A=>{try{const H=prompt("Please enter a reason for cancellation:");H&&(await d(A,H),D())}catch(H){console.error("Error cancelling transaction:",H)}},u=A=>{w(A),k(!0)},v=A=>{switch(A){case"approved":return e.jsx(B,{label:"Approved",color:"success",size:"small"});case"pending":return e.jsx(B,{label:"Pending",color:"warning",size:"small"});case"settled":return e.jsx(B,{label:"Settled",color:"info",size:"small"});case"issued":return e.jsx(B,{label:"Issued",color:"primary",size:"small"});case"cancelled":return e.jsx(B,{label:"Cancelled",color:"error",size:"small"});default:return e.jsx(B,{label:A,size:"small"})}},q=()=>b.reduce((A,H)=>A+parseFloat(H.amount_issued||0),0),ye=()=>b.reduce((A,H)=>A+parseFloat(H.amount_spent||0),0),_e=()=>b.reduce((A,H)=>A+parseFloat(H.amount_returned||0),0);return t?e.jsxs(e.Fragment,{children:[e.jsxs(ie,{open:r,onClose:i,maxWidth:"md",fullWidth:!0,children:[e.jsx(oe,{children:e.jsxs(z,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{variant:"h6",children:[t.full_name,"'s Transactions"]}),e.jsx(W,{edge:"end",color:"inherit",onClick:i,"aria-label":"close",children:e.jsx(ne,{})})]})}),e.jsxs(ce,{children:[e.jsx(V,{sx:{p:2,mb:3},children:e.jsxs(c,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(c,{item:!0,xs:12,md:3,children:e.jsx(O,{fullWidth:!0,label:"Start Date",type:"date",value:j,onChange:A=>o(A.target.value),InputLabelProps:{shrink:!0},size:"small"})}),e.jsx(c,{item:!0,xs:12,md:3,children:e.jsx(O,{fullWidth:!0,label:"End Date",type:"date",value:h,onChange:A=>E(A.target.value),InputLabelProps:{shrink:!0},size:"small",inputProps:{min:j}})}),e.jsx(c,{item:!0,xs:12,md:3,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(Z,{children:"Status"}),e.jsxs(X,{value:g,onChange:A=>I(A.target.value),label:"Status",children:[e.jsx(C,{value:"all",children:"All Status"}),e.jsx(C,{value:"issued",children:"Issued"}),e.jsx(C,{value:"settled",children:"Settled"}),e.jsx(C,{value:"approved",children:"Approved"}),e.jsx(C,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(c,{item:!0,xs:12,md:3,children:e.jsx($,{variant:"contained",color:"primary",fullWidth:!0,onClick:_,startIcon:e.jsx(Ve,{}),children:"Filter"})})]})}),e.jsx(z,{sx:{mb:3},children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(V,{sx:{p:2,textAlign:"center"},children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Issued"}),e.jsx(n,{variant:"h5",children:L(q())})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(V,{sx:{p:2,textAlign:"center"},children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Spent"}),e.jsx(n,{variant:"h5",children:L(ye())})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(V,{sx:{p:2,textAlign:"center"},children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Returned"}),e.jsx(n,{variant:"h5",children:L(_e())})]})})]})}),e.jsx(pe,{component:V,children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Reference"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Purpose"}),e.jsx(a,{align:"right",children:"Issued"}),e.jsx(a,{align:"right",children:"Spent"}),e.jsx(a,{align:"right",children:"Returned"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(fe,{children:m?e.jsx(N,{children:e.jsx(a,{colSpan:8,align:"center",children:e.jsx(ue,{size:24})})}):b.length===0?e.jsx(N,{children:e.jsx(a,{colSpan:8,align:"center",children:"No transactions found for this period"})}):b.map(A=>e.jsxs(N,{children:[e.jsx(a,{children:A.transaction_reference}),e.jsx(a,{children:ve(A.date)}),e.jsx(a,{children:A.purpose}),e.jsx(a,{align:"right",children:L(A.amount_issued)}),e.jsx(a,{align:"right",children:L(A.amount_spent||0)}),e.jsx(a,{align:"right",children:L(A.amount_returned||0)}),e.jsx(a,{children:v(A.status)}),e.jsxs(a,{children:[A.status==="issued"&&e.jsx(K,{title:"Settle",children:e.jsx(W,{color:"primary",size:"small",onClick:()=>u(A),children:e.jsx(He,{})})}),A.status==="settled"&&e.jsx(K,{title:"Approve",children:e.jsx(W,{color:"success",size:"small",onClick:()=>s(A.id),children:e.jsx(ke,{})})}),(A.status==="issued"||A.status==="settled")&&e.jsx(K,{title:"Cancel",children:e.jsx(W,{color:"error",size:"small",onClick:()=>l(A.id),children:e.jsx(mr,{})})})]})]},A.id))})]})})]}),e.jsx(de,{children:e.jsx($,{onClick:i,color:"primary",children:"Close"})})]}),e.jsx(pr,{open:T,onClose:()=>{k(!1),w(null)},onSuccess:()=>{k(!1),w(null),D()},transaction:P})]}):null},Jn=()=>{const[r,i]=x.useState(""),[t,j]=x.useState("all"),[o,h]=x.useState("all"),[E,g]=x.useState(!1),[I,T]=x.useState(!1),[k,P]=x.useState(!1),[w,b]=x.useState(null),[y,f]=x.useState(!1),{employees:d,getAllEmployees:m,deleteEmployee:D,stats:_,loading:s}=Fe();x.useEffect(()=>{l()},[]);const l=async()=>{try{await m({search:r,status:t!=="all"?t:void 0,department:o!=="all"?o:void 0})}catch(R){console.error("Error loading employees:",R)}},u=()=>{l()},v=R=>{b(R),T(!0)},q=R=>{b(R),P(!0)},ye=async()=>{if(w)try{await D(w.id),f(!1),b(null),l()}catch(R){console.error("Error deleting employee:",R)}},_e=R=>{b(R),f(!0)},A=()=>!_||!_.departments?[]:_.departments,H=R=>{switch(R){case"active":return e.jsx(B,{label:"Active",color:"success",size:"small"});case"inactive":return e.jsx(B,{label:"Inactive",color:"error",size:"small"});default:return e.jsx(B,{label:R,size:"small"})}};return e.jsxs(z,{children:[e.jsx(ee,{sx:{mb:3},children:e.jsx(re,{children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsxs(c,{item:!0,xs:12,md:6,children:[e.jsx(n,{variant:"h6",children:"Employees Management"}),e.jsx(n,{variant:"body2",color:"textSecondary",children:"Manage employees for petty cash transactions"})]}),e.jsx(c,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx($,{variant:"contained",color:"primary",startIcon:e.jsx(Te,{}),onClick:()=>g(!0),children:"Add Employee"})})]})})}),e.jsx(V,{sx:{p:2,mb:3},children:e.jsxs(c,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(c,{item:!0,xs:12,md:4,children:e.jsx(O,{fullWidth:!0,placeholder:"Search name, code, position...",value:r,onChange:R=>i(R.target.value),onKeyPress:R=>R.key==="Enter"&&u(),InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(hr,{})})},size:"small"})}),e.jsx(c,{item:!0,xs:12,md:3,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(Z,{children:"Status"}),e.jsxs(X,{value:t,onChange:R=>j(R.target.value),label:"Status",children:[e.jsx(C,{value:"all",children:"All Status"}),e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"inactive",children:"Inactive"})]})]})}),e.jsx(c,{item:!0,xs:12,md:3,children:e.jsxs(Y,{fullWidth:!0,size:"small",children:[e.jsx(Z,{children:"Department"}),e.jsxs(X,{value:o,onChange:R=>h(R.target.value),label:"Department",children:[e.jsx(C,{value:"all",children:"All Departments"}),A().map(R=>e.jsx(C,{value:R,children:R},R))]})]})}),e.jsx(c,{item:!0,xs:12,md:2,children:e.jsx($,{variant:"contained",color:"primary",fullWidth:!0,onClick:u,startIcon:e.jsx(Ve,{}),children:"Filter"})})]})}),e.jsx(pe,{component:V,children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Employee Code"}),e.jsx(a,{children:"Full Name"}),e.jsx(a,{children:"Position"}),e.jsx(a,{children:"Department"}),e.jsx(a,{children:"Contact"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(fe,{children:s?e.jsx(N,{children:e.jsx(a,{colSpan:7,align:"center",children:"Loading..."})}):d.length===0?e.jsx(N,{children:e.jsx(a,{colSpan:7,align:"center",children:"No employees found"})}):d.map(R=>e.jsxs(N,{children:[e.jsx(a,{children:R.employee_code}),e.jsx(a,{children:R.full_name}),e.jsx(a,{children:R.position}),e.jsx(a,{children:R.department}),e.jsx(a,{children:R.phone_number?e.jsxs("div",{children:[e.jsx("div",{children:R.phone_number}),e.jsx(n,{variant:"caption",color:"textSecondary",children:R.email})]}):R.email}),e.jsx(a,{children:H(R.status)}),e.jsxs(a,{children:[e.jsx(K,{title:"View Transactions",children:e.jsx(W,{color:"primary",size:"small",onClick:()=>q(R),children:e.jsx(Be,{})})}),e.jsx(K,{title:"Edit",children:e.jsx(W,{color:"info",size:"small",onClick:()=>v(R),children:e.jsx(He,{})})}),e.jsx(K,{title:"Delete",children:e.jsx(W,{color:"error",size:"small",onClick:()=>_e(R),children:e.jsx(qe,{})})})]})]},R.id))})]})}),e.jsxs(ie,{open:y,onClose:()=>f(!1),children:[e.jsx(oe,{children:"Confirm Delete"}),e.jsx(ce,{children:e.jsxs(jn,{children:['Are you sure you want to delete the employee "',w==null?void 0:w.full_name,'"? This action cannot be undone.']})}),e.jsxs(de,{children:[e.jsx($,{onClick:()=>f(!1),color:"primary",children:"Cancel"}),e.jsx($,{onClick:ye,color:"error",children:"Delete"})]})]}),e.jsx(Gn,{open:E,onClose:()=>g(!1),onSuccess:()=>{g(!1),l()},departments:A()}),e.jsx(Kn,{open:I,onClose:()=>{T(!1),b(null)},onSuccess:()=>{T(!1),b(null),l()},employee:w,departments:A()}),e.jsx(Yn,{open:k,onClose:()=>{P(!1),b(null)},employee:w})]})},Qn=({pettyCashStats:r,employeeStats:i,balance:t})=>{var j;return e.jsxs(z,{children:[e.jsxs(c,{container:!0,spacing:3,mb:2,children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Fund Usage Rate"}),e.jsxs(n,{variant:"h4",children:[(r==null?void 0:r.total_funds)>0?Math.round((r.total_funds-r.available_balance)/r.total_funds*100):0,"%"]}),e.jsxs(z,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(bn,{style:{color:"#ff4d4f",marginRight:8}}),e.jsxs(n,{variant:"body2",color:"error",children:["Used: ",L((r==null?void 0:r.total_funds)-(r==null?void 0:r.available_balance)||0)]})]})]})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Transaction Success Rate"}),e.jsxs(n,{variant:"h4",children:[(r==null?void 0:r.total_transactions)>0?Math.round(r.approved_transactions/r.total_transactions*100):0,"%"]}),e.jsxs(z,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{style:{color:"#52c41a",marginRight:8}}),e.jsxs(n,{variant:"body2",color:"success.main",children:["Approved: ",(r==null?void 0:r.approved_transactions)||0," of ",(r==null?void 0:r.total_transactions)||0]})]})]})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Pending Actions"}),e.jsx(n,{variant:"h4",children:((r==null?void 0:r.pending_transactions)||0)+((r==null?void 0:r.settled_transactions)||0)}),e.jsxs(z,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(gn,{style:{color:"#faad14",marginRight:8}}),e.jsxs(n,{variant:"body2",color:"warning.main",children:[(r==null?void 0:r.pending_transactions)||0," pending, ",(r==null?void 0:r.settled_transactions)||0," to approve"]})]})]})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Employee Engagement"}),e.jsx(n,{variant:"h4",children:i!=null&&i.active_employees?Math.round(((r==null?void 0:r.total_transactions)||0)/i.active_employees):0}),e.jsxs(z,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Le,{style:{color:"#1890ff",marginRight:8}}),e.jsx(n,{variant:"body2",color:"primary",children:"Avg. transactions per employee"})]})]})})})]}),e.jsxs(c,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsxs(ar,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(Pn,{style:{fontSize:24}}),e.jsx(n,{variant:"h6",children:"Petty Cash Statistics"})]}),e.jsx(ze,{sx:{mb:2}}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Available Balance"}),e.jsx(n,{variant:"h5",children:L(t||0)})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Funds"}),e.jsx(n,{variant:"h5",children:L((r==null?void 0:r.total_funds)||0)})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Issued"}),e.jsx(n,{variant:"h5",color:"error",children:L((r==null?void 0:r.total_issued)||0)})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Spent"}),e.jsx(n,{variant:"h5",color:"warning.main",children:L((r==null?void 0:r.total_spent)||0)})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Returned"}),e.jsx(n,{variant:"h5",color:"success.main",children:L((r==null?void 0:r.total_returned)||0)})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Pending Funds"}),e.jsx(n,{variant:"h5",color:"info.main",children:L((r==null?void 0:r.pending_funds)||0)})]})]})]})})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsxs(ar,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(Le,{style:{fontSize:24}}),e.jsx(n,{variant:"h6",children:"Employee Statistics"})]}),e.jsx(ze,{sx:{mb:2}}),e.jsxs(c,{container:!0,spacing:1.5,children:[e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Employees"}),e.jsx(n,{variant:"h5",children:(i==null?void 0:i.total_employees)||0})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Active Employees"}),e.jsx(n,{variant:"h5",color:"success.main",children:(i==null?void 0:i.active_employees)||0})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Inactive Employees"}),e.jsx(n,{variant:"h5",color:"error",children:(i==null?void 0:i.inactive_employees)||0})]}),e.jsxs(c,{item:!0,xs:6,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",children:"Total Departments"}),e.jsx(n,{variant:"h5",children:((j=i==null?void 0:i.departments)==null?void 0:j.length)||0})]}),e.jsxs(c,{item:!0,xs:12,children:[e.jsx(n,{variant:"subtitle2",color:"textSecondary",gutterBottom:!0,children:"Active Rate"}),e.jsxs(z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(z,{sx:{flexGrow:1,mr:2},children:e.jsx(dn,{variant:"determinate",value:i!=null&&i.total_employees?i.active_employees/i.total_employees*100:0,sx:{height:10,borderRadius:5},color:"success"})}),e.jsxs(n,{variant:"body2",sx:{minWidth:"fit-content"},children:[i!=null&&i.total_employees?Math.round(i.active_employees/i.total_employees*100):0,"%"]})]})]})]})]})})})]}),e.jsxs(c,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Transaction Status"}),e.jsx(pe,{children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Status"}),e.jsx(a,{align:"right",children:"Count"}),e.jsx(a,{align:"right",children:"Percentage"})]})}),e.jsxs(fe,{children:[e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(B,{label:"Pending",color:"warning",size:"small"})}),e.jsx(a,{align:"right",children:(r==null?void 0:r.pending_transactions)||0}),e.jsxs(a,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.pending_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(B,{label:"Settled",color:"info",size:"small"})}),e.jsx(a,{align:"right",children:(r==null?void 0:r.settled_transactions)||0}),e.jsxs(a,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.settled_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(B,{label:"Approved",color:"success",size:"small"})}),e.jsx(a,{align:"right",children:(r==null?void 0:r.approved_transactions)||0}),e.jsxs(a,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.approved_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(N,{children:[e.jsx(a,{children:e.jsx(B,{label:"Cancelled",color:"error",size:"small"})}),e.jsx(a,{align:"right",children:(r==null?void 0:r.cancelled_transactions)||0}),e.jsxs(a,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.cancelled_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(N,{children:[e.jsx(a,{sx:{fontWeight:"bold"},children:"Total"}),e.jsx(a,{align:"right",sx:{fontWeight:"bold"},children:(r==null?void 0:r.total_transactions)||0}),e.jsx(a,{align:"right",sx:{fontWeight:"bold"},children:"100%"})]})]})]})})]})})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(ee,{children:e.jsxs(re,{children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Department Breakdown"}),i!=null&&i.departments&&i.departments.length>0?e.jsx(pe,{children:e.jsxs(je,{size:"small",children:[e.jsx(ge,{children:e.jsxs(N,{children:[e.jsx(a,{children:"Department"}),e.jsx(a,{align:"right",children:"Employees"})]})}),e.jsx(fe,{children:i.departments.map(o=>e.jsxs(N,{children:[e.jsx(a,{children:o}),e.jsx(a,{align:"right",children:"-"})]},o))})]})}):e.jsx(n,{variant:"body2",color:"textSecondary",align:"center",sx:{py:4},children:"No department data available"})]})})})]})]})};function Se(r){const{children:i,value:t,index:j,...o}=r;return e.jsx("div",{role:"tabpanel",hidden:t!==j,id:`petty-cash-tabpanel-${j}`,"aria-labelledby":`petty-cash-tab-${j}`,...o,children:t===j&&e.jsx(z,{children:i})})}const ws=()=>{const[r,i]=x.useState(0),[t,j]=x.useState(!1),{getBalance:o,getStats:h,balance:E,stats:g,loading:I}=be(),{getEmployeeStats:T,stats:k,loading:P}=Fe();x.useEffect(()=>{if(t)return;(async()=>{if(!t)try{await Promise.all([o(),h(),T()]),j(!0)}catch(y){console.error("Error loading data:",y)}})()},[]);const w=(b,y)=>{i(y)};return e.jsxs(un,{children:[e.jsx(z,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(cr,{value:r,onChange:w,"aria-label":"petty cash management tabs",textColor:"primary",indicatorColor:"primary",children:[e.jsx(we,{icon:e.jsx(Sn,{}),iconPosition:"start",label:"Petty Cash",id:"petty-cash-tab-0"}),e.jsx(we,{icon:e.jsx(Le,{}),iconPosition:"start",label:"Employees",id:"petty-cash-tab-1"}),e.jsx(we,{icon:e.jsx(En,{}),iconPosition:"start",label:"Statistics",id:"petty-cash-tab-2"})]})}),e.jsx(Se,{value:r,index:0,children:e.jsx(Un,{})}),e.jsx(Se,{value:r,index:1,children:e.jsx(Jn,{})}),e.jsx(Se,{value:r,index:2,children:e.jsx(Qn,{pettyCashStats:g,employeeStats:k,balance:E})})]})};export{ws as default};

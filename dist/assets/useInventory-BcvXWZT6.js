import{r as f,j as t,q,G as d,T as j,F as E,a5 as l,a6 as G,a7 as R,$ as i,t as w}from"./index-CZ5vWdVC.js";import{A as Q}from"./Autocomplete-CZ9Ow-UA.js";import{T as h,S as $}from"./TextField-MKyOjL9Y.js";import{I as K,a as S,B as F}from"./InputLabel-qvKctQmS.js";import{M as I}from"./MenuItem-E9fZXLAt.js";import{R as W}from"./CloseOutlined-Bz2bw4kF.js";import{R as L}from"./SaveOutlined-DfpAXdOS.js";const z=({product:e,products:r,adjustmentTypes:u,onSubmit:p,onCancel:C,onSelectedProduct:_})=>{console.log(e);const[a,v]=f.useState({id:(e==null?void 0:e.id)||"",product_id:(e==null?void 0:e.id)||"",quantity:"",type:"addition",reason:"",notes:""}),[o,g]=f.useState({});f.useEffect(()=>{e&&v(n=>({...n,id:e.id||"",product_id:e.id||""}))},[e]);const P=()=>{const n={};return console.log("formData",a),a.product_id||(n.product_id="Product is required"),(!a.quantity||a.quantity<=0)&&(n.quantity="Quantity must be greater than 0"),a.reason||(n.reason="Reason is required"),g(n),Object.keys(n).length===0},x=n=>{const{name:s,value:m}=n.target;v(c=>({...c,[s]:m})),o[s]&&g(c=>{const b={...c};return delete b[s],b})},T=(n,s)=>{v(m=>({...m,product_id:s?s.id:"",id:s?s.id:""})),console.log("newValue",s),_(s),o.product_id&&g(m=>{const c={...m};return delete c.product_id,c})},A=n=>{n.preventDefault(),P()&&p(a)},y=e||r.find(n=>n.id===a.id);return console.log("product",e),console.log("products",r),t.jsx(q,{component:"form",onSubmit:A,sx:{mt:2},children:t.jsxs(d,{container:!0,spacing:3,children:[t.jsx(d,{item:!0,xs:12,children:t.jsx(Q,{value:y||null,onChange:T,options:r||[],getOptionLabel:n=>`${n.product_code} - ${n.product_name}`,isOptionEqualToValue:(n,s)=>n.id===s.id,renderInput:n=>t.jsx(h,{...n,fullWidth:!0,label:"Product",error:!!o.product_id,helperText:o.product_id,disabled:e!==null&&e.product_id})})}),y&&t.jsx(d,{item:!0,xs:12,children:t.jsxs(q,{sx:{mb:2,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid #e0e0e0"},children:[t.jsx(j,{variant:"subtitle1",fontWeight:"bold",children:"Current Inventory:"}),t.jsxs(j,{children:["Product: ",y.product_name]}),t.jsxs(j,{children:["Current Quantity: ",y.quantity||0]}),t.jsxs(j,{children:["Reorder Level: ",y.reorder_level||"Not set"]})]})}),t.jsx(d,{item:!0,xs:12,md:6,children:t.jsxs(E,{fullWidth:!0,error:!!o.type,children:[t.jsx(K,{children:"Adjustment Type"}),t.jsx($,{name:"type",value:a.type,onChange:x,label:"Adjustment Type",children:u.map(n=>t.jsx(I,{value:n.value,children:n.label},n.value))}),o.type&&t.jsx(S,{children:o.type})]})}),t.jsx(d,{item:!0,xs:12,md:6,children:t.jsx(h,{fullWidth:!0,label:"Quantity",name:"quantity",type:"number",value:a.quantity,onChange:x,error:!!o.quantity,helperText:o.quantity||"Enter quantity to adjust",InputProps:{inputProps:{min:1}}})}),t.jsx(d,{item:!0,xs:12,children:t.jsx(h,{fullWidth:!0,label:"Reason",name:"reason",value:a.reason,onChange:x,error:!!o.reason,helperText:o.reason||"Provide reason for this adjustment",required:!0})}),t.jsx(d,{item:!0,xs:12,children:t.jsx(h,{fullWidth:!0,label:"Additional Notes",name:"notes",value:a.notes,onChange:x,multiline:!0,rows:3,helperText:"Optional: Add any additional notes or details"})}),t.jsx(d,{item:!0,xs:12,children:t.jsxs(q,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[t.jsx(F,{variant:"outlined",color:"inherit",onClick:C,startIcon:t.jsx(W,{}),children:"Cancel"}),t.jsx(F,{type:"submit",variant:"contained",color:"primary",startIcon:t.jsx(L,{}),children:"Save Adjustment"})]})})]})})},J=()=>l({queryKey:["inventory"],queryFn:async()=>(await i.get("/inventory")).data.data}),U=e=>l({queryKey:["inventory",e],queryFn:async()=>(await i.get(`/inventory/product/${e}`)).data.data,enabled:!!e}),X=()=>{const e=G();return R({mutationFn:async r=>(await i.post("/inventory/adjustments",r)).data,onSuccess:(r,u)=>{e.invalidateQueries(["inventory"]),e.invalidateQueries(["inventory",u.product_id]),e.invalidateQueries(["inventory-adjustments"]),e.invalidateQueries(["inventory-adjustments",u.product_id])},onError:r=>{var u,p;w.error(((p=(u=r.response)==null?void 0:u.data)==null?void 0:p.message)||"Failed to create adjustment")}})},Y=(e={})=>l({queryKey:["inventory-adjustments",e],queryFn:async()=>(await i.get("/inventory/adjustments",{params:e})).data.data}),Z=e=>l({queryKey:["inventory-adjustments",e],queryFn:async()=>(await i.get(`/inventory/adjustments/product/${e}`)).data.data,enabled:!!e}),V=(e={})=>l({queryKey:["inventory-logs",e],queryFn:async()=>(await i.get("/inventory/logs",{params:e})).data.data}),ee=e=>l({queryKey:["inventory-logs",e],queryFn:async()=>(await i.get(`/inventory/logs/product/${e}`)).data.data,enabled:!!e}),te=e=>l({queryKey:["product-transactions",e],queryFn:async()=>(await i.get(`/inventory/transactions/product/${e}`)).data.data,enabled:!!e}),ne=e=>l({queryKey:["product-reports",e],queryFn:async()=>(await i.get(`/inventory/report/product/${e}`)).data.data,enabled:!!e});export{z as I,Y as a,X as b,V as c,U as d,Z as e,ee as f,te as g,ne as h,J as u};

import{r as m,Z as L,ah as O,ai as B,j as e,T as N,I as T,G as h,l as b,X as J,K as Q,aj as Y,v as A,F as ee,P as se,af as ae}from"./index-VYacBzdn.js";import{c as W}from"./cities-nh0Rcspy.js";import{D as $}from"./Dialog-KIaZwdXs.js";import{D as z,a as M}from"./DialogTitle-sNzQWAp3.js";import{R as ne}from"./CloseOutlined-BzQ1yUQH.js";import{T as j}from"./TextField-DcFzWKp_.js";import{A as re}from"./Autocomplete-CTmCWFbU.js";import{D as F}from"./DialogActions-Cf0C3-gn.js";import"./sweetalert2.esm.all-D3pEHXw3.js";import{C as te}from"./Container-g1D49Be8.js";import{R as ie}from"./SearchOutlined-CuhT5l3w.js";import{R as le}from"./ClearOutlined-Ck6tTetQ.js";import{R as oe}from"./PlusOutlined-NVaeiLU6.js";import{b as de,c as ce,d as me,T as P,a,e as ue}from"./TableRow-F8UK-irz.js";import{R as xe}from"./EditOutlined-CdhJH0Bk.js";import{R as he}from"./DeleteOutlined-CknXjhA9.js";import{T as je}from"./TablePagination-Dq0YRuKk.js";import{D as pe}from"./DialogContentText-D1_q2Iju.js";import{S as u}from"./Skeleton-wlVAb656.js";import"./InputLabel-Cn1m3Ebo.js";import"./Close-aB77mB-e.js";import"./KeyboardArrowRight-CWBZhDWc.js";import"./LastPage-DIxfCoDv.js";import"./MenuItem--hotehpj.js";const Ce=({open:y,handleClose:p,customer:l=null,handleSuccess:_})=>{const w={customer_name:"",contact_number:"",email:"",address:"",city:"",business_name:"",business_address:""},[i,C]=m.useState(w),[r,f]=m.useState({}),t=L(O),{createCustomer:S,updateCustomer:D}=B(),x=!!l;m.useEffect(()=>{y&&(C(l?{customer_name:l.customer_name||"",contact_number:l.contact_number||"",email:l.email||"",address:l.address||"",city:l.city||"",business_name:l.business_name||"",business_address:l.business_address||""}:w),f({}))},[y,l]);const g=()=>{const n={};return i.customer_name.trim()||(n.customer_name="Customer name is required"),i.email&&!/\S+@\S+\.\S+/.test(i.email)&&(n.email="Email address is invalid"),f(n),Object.keys(n).length===0},c=n=>{const{name:o,value:d}=n.target;C(v=>({...v,[o]:d})),r[o]&&f(v=>({...v,[o]:void 0}))},R=async()=>{var n,o;if(g())try{let d;x?d=await D(l.id,i):d=await S(i),_&&_(d),p()}catch(d){console.error("Error saving customer:",d),(o=(n=d.response)==null?void 0:n.data)!=null&&o.errors&&f(d.response.data.errors)}};return e.jsxs($,{open:y,onClose:p,maxWidth:"md",fullWidth:!0,"aria-labelledby":"customer-dialog-title",children:[e.jsxs(z,{id:"customer-dialog-title",sx:{m:0,p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(N,{variant:"h6",children:x?"Edit Customer":"Add New Customer"}),e.jsx(T,{"aria-label":"close",onClick:p,size:"small",children:e.jsx(ne,{})})]}),e.jsx(M,{dividers:!0,children:e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,label:"Customer Name *",name:"customer_name",value:i.customer_name,onChange:c,error:!!r.customer_name,helperText:r.customer_name,disabled:t,required:!0})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(j,{fullWidth:!0,label:"Business Name",name:"business_name",value:i.business_name,onChange:c,error:!!r.business_name,helperText:r.business_name,disabled:t})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(j,{fullWidth:!0,label:"Business Address",name:"business_address",value:i.business_address,onChange:c,error:!!r.business_address,helperText:r.business_address,disabled:t})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(j,{fullWidth:!0,label:"Contact Number",name:"contact_number",value:i.contact_number,onChange:c,error:!!r.contact_number,helperText:r.contact_number,disabled:t})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(j,{fullWidth:!0,label:"Email",name:"email",type:"email",value:i.email,onChange:c,error:!!r.email,helperText:r.email,disabled:t})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(j,{fullWidth:!0,label:"Address",name:"address",value:i.address,onChange:c,error:!!r.address,helperText:r.address,disabled:t,multiline:!0,rows:2})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(re,{fullWidth:!0,options:W,getOptionLabel:n=>`${n.name}`,value:W.find(n=>n.name===i.city)||null,onChange:(n,o)=>{c({target:{name:"city",value:o?o.name:""}})},isOptionEqualToValue:(n,o)=>n.name===o.name,renderInput:n=>e.jsx(j,{...n,label:"City",name:"city",size:"normal",slotProps:{inputLabel:{sx:{top:"1px"}}},error:!!r.city,helperText:r.city,disabled:t})})})]})}),e.jsxs(F,{sx:{px:3,py:2},children:[e.jsx(b,{onClick:p,disabled:t,children:"Cancel"}),e.jsx(b,{variant:"contained",color:"primary",onClick:R,disabled:t,startIcon:t&&e.jsx(J,{size:20,color:"inherit"}),children:t?"Saving...":x?"Update":"Save"})]})]})},fe=()=>e.jsxs(P,{children:[e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{children:e.jsx(u,{animation:"wave"})}),e.jsx(a,{align:"right",children:e.jsxs(A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(u,{animation:"wave",variant:"circular",width:32,height:32}),e.jsx(u,{animation:"wave",variant:"circular",width:32,height:32})]})})]}),qe=()=>{const y=Q(),p=L(Y),l=L(O),{getAllCustomers:_,deleteCustomer:w}=B(),[i,C]=m.useState(0),[r,f]=m.useState(10),[t,S]=m.useState(""),[D,x]=m.useState(!1),[g,c]=m.useState(null),[R,n]=m.useState(!1),[o,d]=m.useState(null),v=(s,k)=>{C(k)},q=s=>{f(parseInt(s.target.value,10)),C(0)},H=s=>{c(s),x(!0)},G=async()=>{try{await w(g.id),x(!1),c(null)}catch(s){console.error("Error deleting customer:",s)}},V=()=>{S("")},K=()=>{d(null),n(!0)},U=s=>{d(s),n(!0)},X=()=>{n(!1)},Z=()=>{_()},E=s=>{y(`/app/customer/${s}/purchase-history`)},I=p.filter(s=>s.customer_name.toLowerCase().includes(t.toLowerCase())||s.business_name&&s.business_name.toLowerCase().includes(t.toLowerCase())||s.email&&s.email.toLowerCase().includes(t.toLowerCase())||s.contact_number&&s.contact_number.toLowerCase().includes(t.toLowerCase())||s.city&&s.city.toLowerCase().includes(t.toLowerCase()));return e.jsxs(te,{maxWidth:"xxl",sx:{mt:0,px:"0!important"},children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,gap:2},children:[e.jsx(A,{sx:{display:"flex",gap:2,flex:1},children:e.jsx(j,{placeholder:"Search customers",variant:"outlined",size:"small",value:t,onChange:s=>S(s.target.value),InputProps:{startAdornment:e.jsx(ee,{position:"start",children:e.jsx(ie,{})})},sx:{minWidth:300}})}),e.jsxs(A,{children:[e.jsx(b,{variant:"text",color:"error",sx:{mr:1},onClick:V,children:e.jsx(le,{})}),e.jsx(b,{variant:"contained",color:"primary",startIcon:e.jsx(oe,{}),onClick:K,children:"Add Customer"})]})]}),e.jsx(de,{component:se,children:e.jsxs(ce,{children:[e.jsx(me,{children:e.jsxs(P,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Business Name"}),e.jsx(a,{children:"Business Address"}),e.jsx(a,{children:"Contact Number"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Address"}),e.jsx(a,{children:"City"}),e.jsx(a,{align:"right",children:"Actions"})]})}),e.jsxs(ue,{children:[l?[...Array(r)].map((s,k)=>e.jsx(fe,{},k)):I.slice(i*r,i*r+r).map(s=>e.jsxs(P,{children:[e.jsx(a,{children:e.jsx(N,{sx:{cursor:"pointer","&:hover":{color:"primary.main",textDecoration:"underline"}},onClick:()=>E(s.id),children:s.customer_name})}),e.jsx(a,{children:s.business_name||"N/A"}),e.jsx(a,{children:s.business_address||"N/A"}),e.jsx(a,{children:s.contact_number||"N/A"}),e.jsx(a,{children:s.email||"N/A"}),e.jsx(a,{children:s.address||"N/A"}),e.jsx(a,{children:s.city||"N/A"}),e.jsxs(a,{align:"right",children:[e.jsx(T,{onClick:()=>E(s.id),color:"primary",title:"View Purchase History",children:e.jsx(ae,{style:{fontSize:20}})}),e.jsx(T,{onClick:()=>U(s),children:e.jsx(xe,{style:{fontSize:20}})}),e.jsx(T,{onClick:()=>H(s),children:e.jsx(he,{style:{fontSize:20,color:"red"}})})]})]},s.id)),!l&&I.length===0&&e.jsx(P,{children:e.jsx(a,{colSpan:8,align:"center",children:e.jsx(N,{variant:"body1",sx:{py:2},children:"No customers found"})})})]})]})}),e.jsx(je,{rowsPerPageOptions:[5,10,25],component:"div",count:I.length,rowsPerPage:r,page:i,onPageChange:v,onRowsPerPageChange:q}),e.jsxs($,{open:D,onClose:()=>x(!1),children:[e.jsx(z,{children:"Confirm Delete"}),e.jsx(M,{children:e.jsxs(pe,{children:['Are you sure you want to delete the customer "',g==null?void 0:g.customer_name,'"? This action cannot be undone.']})}),e.jsxs(F,{children:[e.jsx(b,{onClick:()=>x(!1),children:"Cancel"}),e.jsx(b,{onClick:G,color:"error",children:"Delete"})]})]}),e.jsx(Ce,{open:R,handleClose:X,customer:o,handleSuccess:Z})]})};export{qe as default};

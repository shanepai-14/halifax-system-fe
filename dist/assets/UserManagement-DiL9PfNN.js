import{g as le,h as ce,s as V,T as I,m as ne,r as b,w as de,j as e,k as ae,z as ue,u as $e,C as we,B as Ie,t as D,n as ye,x as Te,ai as ee,l as B,ao as ke,ap as Ae,aM as ze,ab as q,ch as Me,ci as Ee,cj as Ne,ck as Oe,cl as _e,cm as oe,Y as W,cn as be,co as ie,J as E,cp as Fe,cq as De,cr as We,cs as Le,ct as qe,cu as Be,cv as Ve,cw as Ge,cx as Qe,cy as He,K,N as O,U as f,a2 as J,Z as pe,E as N,_ as Se,L as Ke,a_ as Je,V as Xe,W as Ye,P as L,$ as Ce,X as H}from"./index-DBE16dNJ.js";import{D as me}from"./Dialog-BvoaxRAS.js";import{D as xe,a as he}from"./DialogTitle-CU-uubLr.js";import{R as Pe}from"./CloseOutlined-qRPlR-rb.js";import{T as A,S as ge,c as Ze,d as es,e as ss,a as se,b as k,f as as}from"./TextField-BFvUv3jz.js";import{R as re}from"./EyeOutlined-BthGkDEk.js";import{I as fe,a as Ue}from"./InputLabel-CmvkQMfU.js";import{M as z}from"./MenuItem-BDmkg4Sd.js";import{D as je}from"./DialogActions-Nr9b4A4d.js";import{R as rs}from"./PlusOutlined-BkP6xSvd.js";import{R as ts}from"./SearchOutlined-BlgNFUGN.js";import{R as ns}from"./FilterOutlined-CkQR7BAA.js";import{R as os}from"./ReloadOutlined-D0xu8i2j.js";import{A as is}from"./Alert-CcFSJbS8.js";import{R as ls}from"./EditOutlined-BSIDgwAm.js";import{R as cs}from"./DeleteOutlined-Ddhxq8nB.js";import{F as ds,L as us}from"./LastPage-C_a6dSiX.js";import{D as ps}from"./DialogContentText-1ExWrGYM.js";import"./Close-4yUZz1CE.js";function ms(s){return ce("MuiAlertTitle",s)}le("MuiAlertTitle",["root"]);const xs=s=>{const{classes:a}=s;return ue({root:["root"]},ms,a)},hs=V(I,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(s,a)=>a.root})(ne(({theme:s})=>({fontWeight:s.typography.fontWeightMedium,marginTop:-2}))),gs=b.forwardRef(function(a,n){const r=de({props:a,name:"MuiAlertTitle"}),{className:c,...d}=r,p=r,y=xs(p);return e.jsx(hs,{gutterBottom:!0,component:"div",ownerState:p,ref:n,className:ae(y.root,c),...d})});function fs(s){return ce("MuiPagination",s)}le("MuiPagination",["root","ul","outlined","text"]);function js(s={}){const{boundaryCount:a=1,componentName:n="usePagination",count:r=1,defaultPage:c=1,disabled:d=!1,hideNextButton:p=!1,hidePrevButton:y=!1,onChange:C,page:w,showFirstButton:U=!1,showLastButton:R=!1,siblingCount:l=1,...i}=s,[o,t]=$e({controlled:w,default:c,name:n,state:"page"}),g=(v,P)=>{w||t(P),C&&C(v,P)},m=(v,P)=>{const F=P-v+1;return Array.from({length:F},(X,G)=>v+G)},u=m(1,Math.min(a,r)),S=m(Math.max(r-a+1,a+1),r),j=Math.max(Math.min(o-l,r-a-l*2-1),a+2),x=Math.min(Math.max(o+l,a+l*2+2),r-a-1),_=[...U?["first"]:[],...y?[]:["previous"],...u,...j>a+2?["start-ellipsis"]:a+1<r-a?[a+1]:[],...m(j,x),...x<r-a-1?["end-ellipsis"]:r-a>a?[r-a]:[],...S,...p?[]:["next"],...R?["last"]:[]],M=v=>{switch(v){case"first":return 1;case"previous":return o-1;case"next":return o+1;case"last":return r;default:return null}};return{items:_.map(v=>typeof v=="number"?{onClick:P=>{g(P,v)},type:"page",page:v,selected:v===o,disabled:d,"aria-current":v===o?"true":void 0}:{onClick:P=>{g(P,M(v))},type:v,page:M(v),selected:!1,disabled:d||!v.includes("ellipsis")&&(v==="next"||v==="last"?o>=r:o<=1)}),...i}}function vs(s){return ce("MuiPaginationItem",s)}const $=le("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),ys=we(e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),bs=we(e.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),Re=(s,a)=>{const{ownerState:n}=s;return[a.root,a[n.variant],a[`size${B(n.size)}`],n.variant==="text"&&a[`text${B(n.color)}`],n.variant==="outlined"&&a[`outlined${B(n.color)}`],n.shape==="rounded"&&a.rounded,n.type==="page"&&a.page,(n.type==="start-ellipsis"||n.type==="end-ellipsis")&&a.ellipsis,(n.type==="previous"||n.type==="next")&&a.previousNext,(n.type==="first"||n.type==="last")&&a.firstLast]},Cs=s=>{const{classes:a,color:n,disabled:r,selected:c,size:d,shape:p,type:y,variant:C}=s,w={root:["root",`size${B(d)}`,C,p,n!=="standard"&&`color${B(n)}`,n!=="standard"&&`${C}${B(n)}`,r&&"disabled",c&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[y]],icon:["icon"]};return ue(w,vs,a)},ws=V("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Re})(ne(({theme:s})=>({...s.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(s.vars||s).palette.text.primary,height:"auto",[`&.${$.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity},variants:[{props:{size:"small"},style:{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:s.typography.pxToRem(15)}}]}))),Ss=V(Ie,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Re})(ne(({theme:s})=>({...s.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(s.vars||s).palette.text.primary,[`&.${$.focusVisible}`]:{backgroundColor:(s.vars||s).palette.action.focus},[`&.${$.disabled}`]:{opacity:(s.vars||s).palette.action.disabledOpacity},transition:s.transitions.create(["color","background-color"],{duration:s.transitions.duration.short}),"&:hover":{backgroundColor:(s.vars||s).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${$.selected}`]:{backgroundColor:(s.vars||s).palette.action.selected,"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:D(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(s.vars||s).palette.action.selected}},[`&.${$.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.action.selectedChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.focusOpacity}))`:D(s.palette.action.selected,s.palette.action.selectedOpacity+s.palette.action.focusOpacity)},[`&.${$.disabled}`]:{opacity:1,color:(s.vars||s).palette.action.disabled,backgroundColor:(s.vars||s).palette.action.selected}},variants:[{props:{size:"small"},style:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:s.typography.pxToRem(15)}},{props:{shape:"rounded"},style:{borderRadius:(s.vars||s).shape.borderRadius}},{props:{variant:"outlined"},style:{border:s.vars?`1px solid rgba(${s.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${s.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${$.selected}`]:{[`&.${$.disabled}`]:{borderColor:(s.vars||s).palette.action.disabledBackground,color:(s.vars||s).palette.action.disabled}}}},{props:{variant:"text"},style:{[`&.${$.selected}`]:{[`&.${$.disabled}`]:{color:(s.vars||s).palette.action.disabled}}}},...Object.entries(s.palette).filter(ye(["dark","contrastText"])).map(([a])=>({props:{variant:"text",color:a},style:{[`&.${$.selected}`]:{color:(s.vars||s).palette[a].contrastText,backgroundColor:(s.vars||s).palette[a].main,"&:hover":{backgroundColor:(s.vars||s).palette[a].dark,"@media (hover: none)":{backgroundColor:(s.vars||s).palette[a].main}},[`&.${$.focusVisible}`]:{backgroundColor:(s.vars||s).palette[a].dark},[`&.${$.disabled}`]:{color:(s.vars||s).palette.action.disabled}}}})),...Object.entries(s.palette).filter(ye(["light"])).map(([a])=>({props:{variant:"outlined",color:a},style:{[`&.${$.selected}`]:{color:(s.vars||s).palette[a].main,border:`1px solid ${s.vars?`rgba(${s.vars.palette[a].mainChannel} / 0.5)`:D(s.palette[a].main,.5)}`,backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / ${s.vars.palette.action.activatedOpacity})`:D(s.palette[a].main,s.palette.action.activatedOpacity),"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / calc(${s.vars.palette.action.activatedOpacity} + ${s.vars.palette.action.focusOpacity}))`:D(s.palette[a].main,s.palette.action.activatedOpacity+s.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${$.focusVisible}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / calc(${s.vars.palette.action.activatedOpacity} + ${s.vars.palette.action.focusOpacity}))`:D(s.palette[a].main,s.palette.action.activatedOpacity+s.palette.action.focusOpacity)}}}}))]}))),Ps=V("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(s,a)=>a.icon})(ne(({theme:s})=>({fontSize:s.typography.pxToRem(20),margin:"0 -8px",variants:[{props:{size:"small"},style:{fontSize:s.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:s.typography.pxToRem(22)}}]}))),Us=b.forwardRef(function(a,n){const r=de({props:a,name:"MuiPaginationItem"}),{className:c,color:d="standard",component:p,components:y={},disabled:C=!1,page:w,selected:U=!1,shape:R="circular",size:l="medium",slots:i={},slotProps:o={},type:t="page",variant:g="text",...m}=r,u={...r,color:d,disabled:C,selected:U,shape:R,size:l,type:t,variant:g},S=Te(),j=Cs(u),x={slots:{previous:i.previous??y.previous,next:i.next??y.next,first:i.first??y.first,last:i.last??y.last},slotProps:o},[_,M]=ee("previous",{elementType:ys,externalForwardedProps:x,ownerState:u}),[T,v]=ee("next",{elementType:bs,externalForwardedProps:x,ownerState:u}),[P,F]=ee("first",{elementType:ds,externalForwardedProps:x,ownerState:u}),[X,G]=ee("last",{elementType:us,externalForwardedProps:x,ownerState:u}),Y=S?{previous:"next",next:"previous",first:"last",last:"first"}[t]:t,Z={previous:_,next:T,first:P,last:X}[Y],h={previous:M,next:v,first:F,last:G}[Y];return t==="start-ellipsis"||t==="end-ellipsis"?e.jsx(ws,{ref:n,ownerState:u,className:ae(j.root,c),children:"â€¦"}):e.jsxs(Ss,{ref:n,ownerState:u,component:p,disabled:C,className:ae(j.root,c),...m,children:[t==="page"&&w,Z?e.jsx(Ps,{...h,className:j.icon,as:Z}):null]})}),Rs=s=>{const{classes:a,variant:n}=s;return ue({root:["root",n],ul:["ul"]},fs,a)},$s=V("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:n}=s;return[a.root,a[n.variant]]}})({}),Is=V("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(s,a)=>a.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Ts(s,a,n){return s==="page"?`${n?"":"Go to "}page ${a}`:`Go to ${s} page`}const ks=b.forwardRef(function(a,n){const r=de({props:a,name:"MuiPagination"}),{boundaryCount:c=1,className:d,color:p="standard",count:y=1,defaultPage:C=1,disabled:w=!1,getItemAriaLabel:U=Ts,hideNextButton:R=!1,hidePrevButton:l=!1,onChange:i,page:o,renderItem:t=P=>e.jsx(Us,{...P}),shape:g="circular",showFirstButton:m=!1,showLastButton:u=!1,siblingCount:S=1,size:j="medium",variant:x="text",..._}=r,{items:M}=js({...r,componentName:"Pagination"}),T={...r,boundaryCount:c,color:p,count:y,defaultPage:C,disabled:w,getItemAriaLabel:U,hideNextButton:R,hidePrevButton:l,renderItem:t,shape:g,showFirstButton:m,showLastButton:u,siblingCount:S,size:j,variant:x},v=Rs(T);return e.jsx($s,{"aria-label":"pagination navigation",className:ae(v.root,d),ownerState:T,ref:n,..._,children:e.jsx(Is,{className:v.ul,ownerState:T,children:M.map((P,F)=>e.jsx("li",{children:t({...P,color:p,"aria-label":U(P.type,P.page,P.selected),shape:g,size:j,variant:x})},F))})})});var As={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},zs=function(a,n){return b.createElement(ke,Ae({},a,{ref:n,icon:As}))},te=b.forwardRef(zs);const ve=()=>{const s=ze(),a=q(Me),n=q(Ee),r=q(Ne),c=q(Oe),d=q(_e);return{users:a,stats:n,loading:r,error:c,filters:d,getAllUsers:async(l={})=>{var i,o;try{s(oe());const t={search:d.search||l.search,role:d.role!=="all"?d.role:void 0,sort_by:l.sort_by||"created_at",sort_order:l.sort_order||"desc"},g=await W.get("/users",{params:t});return s(be(g.data.data)),g.data.data}catch(t){return console.error("Error fetching users:",t),s(ie(t.message)),E.error(((o=(i=t.response)==null?void 0:i.data)==null?void 0:o.message)||"Failed to fetch users"),[]}},getUserById:async l=>{var i,o;try{s(oe());const t=await W.get(`/users/${l}`);return s(be([t.data.data])),t.data.data}catch(t){return console.error("Error fetching user:",t),s(ie(t.message)),E.error(((o=(i=t.response)==null?void 0:i.data)==null?void 0:o.message)||"Failed to fetch user"),null}},createUser:async l=>{var i,o;try{s(Fe());const t=await W.post("/users",l);return s(De(t.data.data)),E.success("User created successfully"),t.data.data}catch(t){throw console.error("Error creating user:",t),s(We(t.message)),E.error(((o=(i=t.response)==null?void 0:i.data)==null?void 0:o.message)||"Failed to create user"),t}},updateUser:async(l,i)=>{var o,t;try{s(Le());const g=await W.put(`/users/${l}`,i);return s(qe(g.data.data)),E.success("User updated successfully"),g.data.data}catch(g){throw console.error("Error updating user:",g),s(Be(g.message)),E.error(((t=(o=g.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to update user"),g}},deleteUser:async l=>{var i,o;try{return s(Ve()),await W.delete(`/users/${l}`),s(Ge(l)),E.success("User deleted successfully"),!0}catch(t){throw console.error("Error deleting user:",t),s(Qe(t.message)),E.error(((o=(i=t.response)==null?void 0:i.data)==null?void 0:o.message)||"Failed to delete user"),t}},getUserStats:async()=>{var l,i;try{s(oe());const o=await W.get("/users/stats");return s(He(o.data.data)),o.data.data}catch(o){return console.error("Error fetching user statistics:",o),s(ie(o.message)),E.error(((i=(l=o.response)==null?void 0:l.data)==null?void 0:i.message)||"Failed to fetch user statistics"),null}}}},Ms=({open:s,onClose:a,onSuccess:n})=>{const[r,c]=b.useState({name:"",username:"",email:"",password:"",password_confirmation:"",role:"cashier"}),[d,p]=b.useState({}),[y,C]=b.useState(!1),[w,U]=b.useState(!1),{createUser:R,loading:l}=ve(),i=m=>{const{name:u,value:S}=m.target;c(j=>({...j,[u]:S})),d[u]&&p(j=>({...j,[u]:null}))},o=()=>{const m={};return r.name.trim()||(m.name="Name is required"),r.username.trim()?r.username.trim().length<3&&(m.username="Username must be at least 3 characters"):m.username="Username is required",r.email.trim()?/^\S+@\S+\.\S+$/.test(r.email)||(m.email="Invalid email address"):m.email="Email is required",r.password?r.password.length<8&&(m.password="Password must be at least 8 characters"):m.password="Password is required",r.password!==r.password_confirmation&&(m.password_confirmation="Passwords do not match"),r.role||(m.role="Role is required"),p(m),Object.keys(m).length===0},t=async m=>{var u,S;if(m.preventDefault(),!!o())try{await R(r),g(!0)}catch(j){console.error("Error adding user:",j),(S=(u=j.response)==null?void 0:u.data)!=null&&S.errors&&p(j.response.data.errors)}},g=(m=!1)=>{c({name:"",username:"",email:"",password:"",password_confirmation:"",role:"cashier"}),p({}),C(!1),U(!1),m?n():a()};return e.jsxs(me,{open:s,onClose:()=>g(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(xe,{children:e.jsxs(K,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(I,{variant:"h6",children:"Add New User"}),e.jsx(O,{edge:"end",color:"inherit",onClick:()=>g(),"aria-label":"close",children:e.jsx(Pe,{})})]})}),e.jsxs("form",{onSubmit:t,children:[e.jsx(he,{children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Full Name",name:"name",value:r.name,onChange:i,error:!!d.name,helperText:d.name})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Username",name:"username",value:r.username,onChange:i,error:!!d.username,helperText:d.username})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Email",name:"email",type:"email",value:r.email,onChange:i,error:!!d.email,helperText:d.email})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Password",name:"password",type:y?"text":"password",value:r.password,onChange:i,error:!!d.password,helperText:d.password,InputProps:{endAdornment:e.jsx(J,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:()=>C(!y),edge:"end",children:y?e.jsx(te,{}):e.jsx(re,{})})})}})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Confirm Password",name:"password_confirmation",type:w?"text":"password",value:r.password_confirmation,onChange:i,error:!!d.password_confirmation,helperText:d.password_confirmation,InputProps:{endAdornment:e.jsx(J,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:()=>U(!w),edge:"end",children:w?e.jsx(te,{}):e.jsx(re,{})})})}})}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(pe,{fullWidth:!0,error:!!d.role,required:!0,children:[e.jsx(fe,{children:"Role"}),e.jsxs(ge,{name:"role",value:r.role,onChange:i,label:"Role",children:[e.jsx(z,{value:"admin",children:"Admin"}),e.jsx(z,{value:"sales",children:"Sales"}),e.jsx(z,{value:"cashier",children:"Cashier"})]}),d.role&&e.jsx(Ue,{children:d.role})]})})]})}),e.jsxs(je,{children:[e.jsx(N,{onClick:()=>g(),color:"primary",disabled:l,children:"Cancel"}),e.jsx(N,{type:"submit",variant:"contained",color:"primary",disabled:l,startIcon:l?e.jsx(Se,{size:24}):null,children:l?"Creating...":"Create User"})]})]})]})},Es=({open:s,onClose:a,onSuccess:n,user:r})=>{const[c,d]=b.useState({name:"",username:"",email:"",password:"",password_confirmation:"",role:""}),[p,y]=b.useState({}),[C,w]=b.useState(!1),[U,R]=b.useState(!1),{updateUser:l,loading:i}=ve();b.useEffect(()=>{r&&d({name:r.name||"",username:r.username||"",email:r.email||"",password:"",password_confirmation:"",role:r.role||""})},[r]);const o=u=>{const{name:S,value:j}=u.target;d(x=>({...x,[S]:j})),p[S]&&y(x=>({...x,[S]:null}))},t=()=>{const u={};return c.name.trim()||(u.name="Name is required"),c.username.trim()?c.username.trim().length<3&&(u.username="Username must be at least 3 characters"):u.username="Username is required",c.email.trim()?/^\S+@\S+\.\S+$/.test(c.email)||(u.email="Invalid email address"):u.email="Email is required",c.password&&(c.password.length<8&&(u.password="Password must be at least 8 characters"),c.password!==c.password_confirmation&&(u.password_confirmation="Passwords do not match")),c.role||(u.role="Role is required"),y(u),Object.keys(u).length===0},g=async u=>{var S,j;if(u.preventDefault(),!(!r||!t()))try{const x={...c};x.password||(delete x.password,delete x.password_confirmation),await l(r.id,x),m(!0)}catch(x){console.error("Error updating user:",x),(j=(S=x.response)==null?void 0:S.data)!=null&&j.errors&&y(x.response.data.errors)}},m=(u=!1)=>{y({}),w(!1),R(!1),u?n():a()};return r?e.jsxs(me,{open:s,onClose:()=>m(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(xe,{children:e.jsxs(K,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(I,{variant:"h6",children:"Edit User"}),e.jsx(O,{edge:"end",color:"inherit",onClick:()=>m(),"aria-label":"close",children:e.jsx(Pe,{})})]})}),e.jsxs("form",{onSubmit:g,children:[e.jsx(he,{children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Full Name",name:"name",value:c.name,onChange:o,error:!!p.name,helperText:p.name})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Username",name:"username",value:c.username,onChange:o,error:!!p.username,helperText:p.username})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,required:!0,label:"Email",name:"email",type:"email",value:c.email,onChange:o,error:!!p.email,helperText:p.email})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Ke,{sx:{mt:1,mb:2},children:e.jsx(I,{variant:"body2",color:"textSecondary",children:"Change Password (Optional)"})})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,label:"New Password",name:"password",type:C?"text":"password",value:c.password,onChange:o,error:!!p.password,helperText:p.password,InputProps:{endAdornment:e.jsx(J,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:()=>w(!C),edge:"end",children:C?e.jsx(te,{}):e.jsx(re,{})})})}})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(A,{fullWidth:!0,label:"Confirm New Password",name:"password_confirmation",type:U?"text":"password",value:c.password_confirmation,onChange:o,error:!!p.password_confirmation,helperText:p.password_confirmation,InputProps:{endAdornment:e.jsx(J,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:()=>R(!U),edge:"end",children:U?e.jsx(te,{}):e.jsx(re,{})})})}})}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(pe,{fullWidth:!0,error:!!p.role,required:!0,children:[e.jsx(fe,{children:"Role"}),e.jsxs(ge,{name:"role",value:c.role,onChange:o,label:"Role",children:[e.jsx(z,{value:"admin",children:"Admin"}),e.jsx(z,{value:"sales",children:"Sales"}),e.jsx(z,{value:"cashier",children:"Cashier"})]}),p.role&&e.jsx(Ue,{children:p.role})]})})]})}),e.jsxs(je,{children:[e.jsx(N,{onClick:()=>m(),color:"primary",disabled:i,children:"Cancel"}),e.jsx(N,{type:"submit",variant:"contained",color:"primary",disabled:i,startIcon:i?e.jsx(Se,{size:24}):null,children:i?"Updating...":"Update User"})]})]})]}):null},sa=()=>{const[s,a]=b.useState(""),[n,r]=b.useState("all"),[c,d]=b.useState(1),[p,y]=b.useState(1),[C,w]=b.useState(!1),[U,R]=b.useState(!1),[l,i]=b.useState(null),[o,t]=b.useState(!1),g=q(Je),{users:m,getAllUsers:u,deleteUser:S,getUserStats:j,stats:x,loading:_,error:M}=ve();b.useEffect(()=>{T(),j()},[c]);const T=async()=>{try{const Q=await u({search:s,role:n,page:c});Q&&Q.last_page&&y(Q.last_page)}catch(h){console.error("Error loading users:",h)}},v=()=>{d(1),T()},P=(h,Q)=>{d(Q)},F=h=>{i(h),R(!0)},X=async()=>{if(l)try{await S(l.id),t(!1),i(null),T(),j()}catch(h){console.error("Error deleting user:",h)}},G=h=>{i(h),t(!0)},Y=h=>{switch(h){case"admin":return e.jsx(H,{label:"Admin",color:"error",size:"small"});case"sales":return e.jsx(H,{label:"Sales",color:"info",size:"small"});case"cashier":return e.jsx(H,{label:"Cashier",color:"success",size:"small"});case"staff":return e.jsx(H,{label:"Staff",color:"warning",size:"small"});default:return e.jsx(H,{label:h,size:"small"})}},Z=()=>{a(""),r("all"),d(1),T()};return e.jsxs(K,{children:[e.jsx(Xe,{sx:{mb:3},children:e.jsx(Ye,{children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsxs(f,{item:!0,xs:12,md:6,children:[e.jsx(I,{variant:"h6",children:"User Management"}),e.jsx(I,{variant:"body2",color:"textSecondary",children:"Manage system users and their access roles"})]}),e.jsx(f,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(N,{variant:"contained",color:"primary",startIcon:e.jsx(rs,{}),onClick:()=>w(!0),children:"Add User"})})]})})}),x&&e.jsxs(f,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(f,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(L,{sx:{p:2,textAlign:"center"},children:[e.jsx(I,{variant:"body2",color:"textSecondary",children:"Total Users"}),e.jsx(I,{variant:"h4",children:x.total_users})]})}),e.jsx(f,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(L,{sx:{p:2,textAlign:"center"},children:[e.jsx(I,{variant:"body2",color:"textSecondary",children:"Admin Users"}),e.jsx(I,{variant:"h4",children:x.admin_users})]})}),e.jsx(f,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(L,{sx:{p:2,textAlign:"center"},children:[e.jsx(I,{variant:"body2",color:"textSecondary",children:"Sales Users"}),e.jsx(I,{variant:"h4",children:x.sales_users})]})}),e.jsx(f,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(L,{sx:{p:2,textAlign:"center"},children:[e.jsx(I,{variant:"body2",color:"textSecondary",children:"Cashier Users"}),e.jsx(I,{variant:"h4",children:x.cashier_users})]})})]}),e.jsx(L,{sx:{p:2,mb:3},children:e.jsxs(f,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(A,{fullWidth:!0,placeholder:"Search by name, username, email...",value:s,onChange:h=>a(h.target.value),onKeyPress:h=>h.key==="Enter"&&v(),InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(ts,{})})},size:"small"})}),e.jsx(f,{item:!0,xs:12,md:4,children:e.jsxs(pe,{fullWidth:!0,size:"small",children:[e.jsx(fe,{children:"Role"}),e.jsxs(ge,{value:n,onChange:h=>r(h.target.value),label:"Role",children:[e.jsx(z,{value:"all",children:"All Roles"}),e.jsx(z,{value:"admin",children:"Admin"}),e.jsx(z,{value:"sales",children:"Sales"}),e.jsx(z,{value:"cashier",children:"Cashier"}),e.jsx(z,{value:"staff",children:"Staff"})]})]})}),e.jsx(f,{item:!0,xs:12,md:4,children:e.jsxs(K,{sx:{display:"flex",gap:1},children:[e.jsx(N,{variant:"contained",color:"primary",onClick:v,startIcon:e.jsx(ns,{}),children:"Filter"}),e.jsx(N,{variant:"outlined",color:"secondary",onClick:Z,startIcon:e.jsx(os,{}),children:"Reset"})]})})]})}),M&&e.jsxs(is,{severity:"error",sx:{mb:3},children:[e.jsx(gs,{children:"Error"}),M]}),e.jsx(Ze,{component:L,children:e.jsxs(es,{size:"small",children:[e.jsx(ss,{children:e.jsxs(se,{children:[e.jsx(k,{children:"Username"}),e.jsx(k,{children:"Name"}),e.jsx(k,{children:"Email"}),e.jsx(k,{children:"Role"}),e.jsx(k,{children:"Actions"})]})}),e.jsx(as,{children:_?e.jsx(se,{children:e.jsx(k,{colSpan:5,align:"center",children:"Loading..."})}):m.length===0?e.jsx(se,{children:e.jsx(k,{colSpan:5,align:"center",children:"No users found"})}):m.map(h=>e.jsxs(se,{children:[e.jsx(k,{children:h.username}),e.jsx(k,{children:h.name}),e.jsx(k,{children:h.email}),e.jsx(k,{children:Y(h.role)}),e.jsxs(k,{children:[e.jsx(Ce,{title:"Edit",children:e.jsx(O,{color:"info",size:"small",onClick:()=>F(h),children:e.jsx(ls,{})})}),e.jsx(Ce,{title:"Delete",children:e.jsx(O,{color:"error",size:"small",onClick:()=>G(h),disabled:g&&g.id===h.id,children:e.jsx(cs,{})})})]})]},h.id))})]})}),p>1&&e.jsx(K,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(ks,{count:p,page:c,onChange:P,color:"primary"})}),e.jsxs(me,{open:o,onClose:()=>t(!1),children:[e.jsx(xe,{children:"Confirm Delete"}),e.jsx(he,{children:e.jsxs(ps,{children:['Are you sure you want to delete the user "',l==null?void 0:l.username,'"? This action cannot be undone.']})}),e.jsxs(je,{children:[e.jsx(N,{onClick:()=>t(!1),color:"primary",children:"Cancel"}),e.jsx(N,{onClick:X,color:"error",children:"Delete"})]})]}),e.jsx(Ms,{open:C,onClose:()=>w(!1),onSuccess:()=>{w(!1),T(),j()}}),e.jsx(Es,{open:U,onClose:()=>{R(!1),i(null)},onSuccess:()=>{R(!1),i(null),T()},user:l})]})};export{sa as default};

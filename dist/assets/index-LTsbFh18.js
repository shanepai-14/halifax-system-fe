import{r as x,a8 as Z,a9 as ee,aC as Se,S as H,bs as tr,bt as sr,bu as ar,bv as lr,bw as ir,bx as cr,by as or,bz as V,$ as M,bA as dr,bB as U,t as z,bC as ur,bD as mr,bE as hr,bF as Be,bG as xr,bH as Fe,bI as jr,bJ as pr,bK as gr,bL as fr,bM as vr,bN as br,bO as _e,bP as Ie,bQ as Ee,bR as yr,bS as _r,bT as Er,bU as Le,bV as qe,bW as Ce,bX as wr,bY as Tr,bZ as Dr,b_ as Fr,j as e,q as $,T as p,I as C,E as se,F as J,b$ as Ir,G as o,C as S,x as G,ae as Ge,af as be,P as K,H as Y,y as B,ac as Ne,D as He,ab as Ar,M as zr}from"./index-CrSDUfpv.js";import{D as ae}from"./Dialog-Ov5HwEb9.js";import{D as le,a as ie}from"./DialogTitle-Cw6pjI73.js";import{R as xe}from"./CloseOutlined-DSNBHcB9.js";import{T as k,S as Q,c as de,d as ue,e as me,a as O,b as n,f as he}from"./TextField-BZsMM0g7.js";import{D as ce}from"./DialogActions-DYSyT2-7.js";import{B as L,I as X,a as De}from"./InputLabel-CrBhOIEx.js";import{C as je}from"./CircularProgress-BZdF-D4l.js";import{A as Ke}from"./Alert-CrQwUFZY.js";import{M as P}from"./MenuItem-D9v4Q_DO.js";import{R as ze}from"./PlusOutlined-CS1xHgMf.js";import{R as Ye}from"./SearchOutlined-CtvaPbOD.js";import{R as Re}from"./FilterOutlined-DnHoQ-BA.js";import{R as We}from"./EditOutlined-Cnvvn_72.js";import{R as Pr}from"./EyeOutlined-CPZxAXXA.js";import{R as Rr}from"./DeleteOutlined-Dip08hFK.js";import{D as Wr}from"./DialogContentText-BKKuNc-g.js";import{R as kr}from"./WarningOutlined-KI1wQ6s6.js";import"./Close-CNlkB0yM.js";var Or={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},Mr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Or}))},$r=x.forwardRef(Mr),Br={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"},Lr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Br}))},qr=x.forwardRef(Lr),Cr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},Nr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Cr}))},we=x.forwardRef(Nr),Hr={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},Vr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Hr}))},Je=x.forwardRef(Vr),Ur={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar-circle",theme:"outlined"},Sr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Ur}))},Gr=x.forwardRef(Sr),Kr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"},Yr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Kr}))},Te=x.forwardRef(Yr),Jr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"},Qr=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Jr}))},Xr=x.forwardRef(Qr),Zr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},en=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:Zr}))},Pe=x.forwardRef(en),rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 464H528V448h312v128zm0 264H184V184h656v200H496c-17.7 0-32 14.3-32 32v192c0 17.7 14.3 32 32 32h344v200zM580 512a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"wallet",theme:"outlined"},nn=function(t,v){return x.createElement(Z,ee({},t,{ref:v,icon:rn}))},tn=x.forwardRef(nn);const pe=()=>{const r=Se(),t=H(tr),v=H(sr),m=H(ar),l=H(lr),u=H(ir),D=H(cr),j=H(or);return{funds:t,transactions:v,stats:m,balance:l,loading:u,error:D,filters:j,getBalance:async()=>{var f,h;try{r(V());const i=await M.get("/petty-cash/balance");return r(dr(i.data.data)),i.data.data}catch(i){return console.error("Error fetching petty cash balance:",i),r(U(i.message)),z.error(((h=(f=i.response)==null?void 0:f.data)==null?void 0:h.message)||"Failed to fetch petty cash balance"),null}},getAllFunds:async(f={})=>{var h,i;try{r(V());const c={search:j.search||f.search,status:j.status!=="all"?j.status:void 0,date_from:j.startDate||f.startDate,date_to:j.endDate||f.endDate,sort_by:f.sort_by||"date",sort_order:f.sort_order||"desc"},_=await M.get("/petty-cash/funds",{params:c});return r(ur(_.data.data)),_.data.data}catch(c){return console.error("Error fetching petty cash funds:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to fetch petty cash funds"),[]}},createFund:async f=>{var h,i;try{r(V());const c=await M.post("/petty-cash/funds",f);return r(mr(c.data.data)),z.success("Petty cash fund created successfully"),c.data.data}catch(c){throw console.error("Error creating petty cash fund:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to create petty cash fund"),c}},approveFund:async f=>{var h,i;try{r(V());const c=await M.put(`/petty-cash/funds/${f}/approve`);return r(hr(c.data.data)),z.success("Petty cash fund approved successfully"),c.data.data}catch(c){throw console.error("Error approving petty cash fund:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to approve petty cash fund"),c}},getAllTransactions:async(f={})=>{var h,i;try{r(V());const c={search:j.search||f.search,status:j.status!=="all"?j.status:void 0,employee_id:j.employeeId||f.employeeId,date_from:j.startDate||f.startDate,date_to:j.endDate||f.endDate,sort_by:f.sort_by||"date",sort_order:f.sort_order||"desc"},_=await M.get("/petty-cash/transactions",{params:c});return r(Be(_.data.data)),_.data.data}catch(c){return console.error("Error fetching petty cash transactions:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to fetch petty cash transactions"),[]}},createTransaction:async f=>{var h,i;try{r(V());let c;return f instanceof FormData?c=await M.post("/petty-cash/transactions",f,{headers:{"Content-Type":"multipart/form-data"}}):c=await M.post("/petty-cash/transactions",f),r(xr(c.data.data)),z.success("Petty cash transaction created successfully"),c.data.data}catch(c){throw console.error("Error creating petty cash transaction:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to create petty cash transaction"),c}},settleTransaction:async(f,h)=>{var i,c;try{r(V());let _;return h instanceof FormData?_=await M.put(`/petty-cash/transactions/${f}/settle`,h,{headers:{"Content-Type":"multipart/form-data"}}):_=await M.put(`/petty-cash/transactions/${f}/settle`,h),r(Fe(_.data.data)),z.success("Petty cash transaction settled successfully"),_.data.data}catch(_){throw console.error("Error settling petty cash transaction:",_),r(U(_.message)),z.error(((c=(i=_.response)==null?void 0:i.data)==null?void 0:c.message)||"Failed to settle petty cash transaction"),_}},approveTransaction:async f=>{var h,i;try{r(V());const c=await M.put(`/petty-cash/transactions/${f}/approve`);return r(Fe(c.data.data)),z.success("Petty cash transaction approved successfully"),c.data.data}catch(c){throw console.error("Error approving petty cash transaction:",c),r(U(c.message)),z.error(((i=(h=c.response)==null?void 0:h.data)==null?void 0:i.message)||"Failed to approve petty cash transaction"),c}},cancelTransaction:async(f,h)=>{var i,c;try{r(V());const _=await M.put(`/petty-cash/transactions/${f}/cancel`,{reason:h});return r(Fe(_.data.data)),z.success("Petty cash transaction cancelled successfully"),_.data.data}catch(_){throw console.error("Error cancelling petty cash transaction:",_),r(U(_.message)),z.error(((c=(i=_.response)==null?void 0:i.data)==null?void 0:c.message)||"Failed to cancel petty cash transaction"),_}},getStats:async()=>{var f,h;try{r(V());const i=await M.get("/petty-cash/stats");return r(jr(i.data.data)),i.data.data}catch(i){return console.error("Error fetching petty cash stats:",i),r(U(i.message)),z.error(((h=(f=i.response)==null?void 0:f.data)==null?void 0:h.message)||"Failed to fetch petty cash statistics"),null}},getEmployeeTransactions:async(f,h={})=>{var i,c;try{r(V());const _={status:j.status!=="all"?j.status:void 0,date_from:j.startDate||h.startDate,date_to:j.endDate||h.endDate,sort_by:h.sort_by||"date",sort_order:h.sort_order||"desc"},re=await M.get(`/petty-cash/employees/${f}/transactions`,{params:_});return r(Be(re.data.data)),re.data.data}catch(_){return console.error("Error fetching employee transactions:",_),r(U(_.message)),z.error(((c=(i=_.response)==null?void 0:i.data)==null?void 0:c.message)||"Failed to fetch employee transactions"),[]}}}},ye=()=>{const r=Se(),t=H(pr),v=H(gr),m=H(fr),l=H(vr),u=H(br);return{employees:t,stats:v,loading:m,error:l,filters:u,getAllEmployees:async(b={})=>{var d,s;try{r(_e());const a={search:u.search||b.search,status:u.status!=="all"?u.status:void 0,department:u.department!=="all"?u.department:void 0,sort_by:b.sort_by||"created_at",sort_order:b.sort_order||"desc"},T=await M.get("/employees",{params:a});return r(Ie(T.data.data)),T.data.data}catch(a){return console.error("Error fetching employees:",a),r(Ee(a.message)),z.error(((s=(d=a.response)==null?void 0:d.data)==null?void 0:s.message)||"Failed to fetch employees"),[]}},getEmployeeById:async b=>{var d,s;try{r(_e());const a=await M.get(`/employees/${b}`);return r(Ie([a.data.data])),a.data.data}catch(a){return console.error("Error fetching employee:",a),r(Ee(a.message)),z.error(((s=(d=a.response)==null?void 0:d.data)==null?void 0:s.message)||"Failed to fetch employee"),null}},createEmployee:async b=>{var d,s;try{r(yr());const a=await M.post("/employees",b);return r(_r(a.data.data)),z.success("Employee created successfully"),a.data.data}catch(a){throw console.error("Error creating employee:",a),r(Er(a.message)),z.error(((s=(d=a.response)==null?void 0:d.data)==null?void 0:s.message)||"Failed to create employee"),a}},updateEmployee:async(b,d)=>{var s,a;try{r(Le());const T=await M.put(`/employees/${b}`,d);return r(qe(T.data.data)),z.success("Employee updated successfully"),T.data.data}catch(T){throw console.error("Error updating employee:",T),r(Ce(T.message)),z.error(((a=(s=T.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to update employee"),T}},deleteEmployee:async b=>{var d,s;try{return r(wr()),await M.delete(`/employees/${b}`),r(Tr(b)),z.success("Employee deleted successfully"),!0}catch(a){throw console.error("Error deleting employee:",a),r(Dr(a.message)),z.error(((s=(d=a.response)==null?void 0:d.data)==null?void 0:s.message)||"Failed to delete employee"),a}},getEmployeeStats:async()=>{var b,d;try{r(_e());const s=await M.get("/employees/stats");return r(Fr(s.data.data)),s.data.data}catch(s){return console.error("Error fetching employee statistics:",s),r(Ee(s.message)),z.error(((d=(b=s.response)==null?void 0:b.data)==null?void 0:d.message)||"Failed to fetch employee statistics"),null}},getTrashedEmployees:async()=>{var b,d;try{r(_e());const s=await M.get("/employees/trashed");return r(Ie(s.data.data)),s.data.data}catch(s){return console.error("Error fetching trashed employees:",s),r(Ee(s.message)),z.error(((d=(b=s.response)==null?void 0:b.data)==null?void 0:d.message)||"Failed to fetch trashed employees"),[]}},restoreEmployee:async b=>{var d,s;try{r(Le());const a=await M.post(`/employees/${b}/restore`);return r(qe(a.data.data)),z.success("Employee restored successfully"),a.data.data}catch(a){throw console.error("Error restoring employee:",a),r(Ce(a.message)),z.error(((s=(d=a.response)==null?void 0:d.data)==null?void 0:s.message)||"Failed to restore employee"),a}}}},sn=({open:r,onClose:t,onSuccess:v})=>{const[m,l]=x.useState({date:new Date().toISOString().split("T")[0],amount:"",description:""}),[u,D]=x.useState({}),{createFund:j,loading:A}=pe(),I=y=>{const{name:b,value:d}=y.target;l(s=>({...s,[b]:d})),u[b]&&D(s=>({...s,[b]:null}))},R=()=>{const y={};return m.date||(y.date="Date is required"),m.amount?parseFloat(m.amount)<=0&&(y.amount="Amount must be greater than 0"):y.amount="Amount is required",m.description.trim()||(y.description="Description is required"),D(y),Object.keys(y).length===0},W=async y=>{if(y.preventDefault(),!!R())try{const b={...m,amount:parseFloat(m.amount)};await j(b),F(!0)}catch(b){console.error("Error adding fund:",b)}},F=(y=!1)=>{l({date:new Date().toISOString().split("T")[0],amount:"",description:""}),D({}),y?v():t()};return e.jsxs(ae,{open:r,onClose:()=>F(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{variant:"h6",children:"Add Petty Cash Fund"}),e.jsx(C,{edge:"end",color:"inherit",onClick:()=>F(),"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs("form",{onSubmit:W,children:[e.jsxs(ie,{children:[e.jsx(k,{margin:"dense",fullWidth:!0,label:"Date",type:"date",name:"date",value:m.date,onChange:I,error:!!u.date,helperText:u.date,InputLabelProps:{shrink:!0}}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Amount",type:"number",name:"amount",value:m.amount,onChange:I,error:!!u.amount,helperText:u.amount,InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Te,{})})}}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Description",name:"description",value:m.description,onChange:I,error:!!u.description,helperText:u.description,multiline:!0,rows:3})]}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>F(),color:"primary",disabled:A,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",disabled:A,startIcon:A?e.jsx(je,{size:24}):null,children:A?"Submitting...":"Add Fund"})]})]})]})},an=({open:r,onClose:t,onSuccess:v,employees:m,balance:l})=>{const[u,D]=x.useState({employee_id:"",date:new Date().toISOString().split("T")[0],purpose:"",description:"",amount_issued:""}),[j,A]=x.useState({}),{createTransaction:I,loading:R}=pe(),W=d=>{const{name:s,value:a}=d.target;D(T=>({...T,[s]:a})),j[s]&&A(T=>({...T,[s]:null}))},F=()=>{const d={};return u.employee_id||(d.employee_id="Employee is required"),u.date||(d.date="Date is required"),u.purpose.trim()||(d.purpose="Purpose is required"),u.amount_issued?parseFloat(u.amount_issued)<=0?d.amount_issued="Amount must be greater than 0":parseFloat(u.amount_issued)>l&&(d.amount_issued="Amount cannot exceed available balance"):d.amount_issued="Amount is required",A(d),Object.keys(d).length===0},y=async d=>{if(d.preventDefault(),!!F())try{const s={...u,amount_issued:parseFloat(u.amount_issued)};await I(s),b(!0)}catch(s){console.error("Error adding transaction:",s)}},b=(d=!1)=>{D({employee_id:"",date:new Date().toISOString().split("T")[0],purpose:"",description:"",amount_issued:""}),A({}),d?v():t()};return e.jsxs(ae,{open:r,onClose:()=>b(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{variant:"h6",children:"New Petty Cash Transaction"}),e.jsx(C,{edge:"end",color:"inherit",onClick:()=>b(),"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs("form",{onSubmit:y,children:[e.jsxs(ie,{children:[e.jsxs(Ke,{severity:"info",sx:{mb:2},children:["Available Balance: ",new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l)]}),e.jsxs(J,{fullWidth:!0,margin:"dense",error:!!j.employee_id,children:[e.jsx(X,{id:"employee-label",children:"Employee *"}),e.jsx(Q,{labelId:"employee-label",name:"employee_id",value:u.employee_id,onChange:W,label:"Employee *",startAdornment:e.jsx(se,{position:"start",children:e.jsx(Ir,{})}),children:m.length===0?e.jsx(P,{disabled:!0,children:"No employees available"}):m.map(d=>e.jsxs(P,{value:d.id,children:[d.full_name," - ",d.position]},d.id))}),j.employee_id&&e.jsx(De,{children:j.employee_id})]}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Date *",type:"date",name:"date",value:u.date,onChange:W,error:!!j.date,helperText:j.date,InputLabelProps:{shrink:!0}}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Purpose *",name:"purpose",value:u.purpose,onChange:W,error:!!j.purpose,helperText:j.purpose}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Description",name:"description",value:u.description,onChange:W,multiline:!0,rows:2}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Amount to Issue *",type:"number",name:"amount_issued",value:u.amount_issued,onChange:W,error:!!j.amount_issued,helperText:j.amount_issued,InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Te,{})})}})]}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>b(),color:"primary",disabled:R,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",disabled:R||!m.length,startIcon:R?e.jsx(je,{size:24}):null,children:R?"Submitting...":"Create Transaction"})]})]})]})},Ve=r=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(r),Qe=({open:r,onClose:t,onSuccess:v,transaction:m})=>{var f;const[l,u]=x.useState({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),[D,j]=x.useState({}),[A,I]=x.useState(""),[R,W]=x.useState(0),{settleTransaction:F,loading:y}=pe();x.useEffect(()=>{m&&(u({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),j({}),I(""))},[m]),x.useEffect(()=>{if(m&&l.amount_spent){const h=parseFloat(m.amount_issued),i=parseFloat(l.amount_spent)||0,c=h-i;W(c>=0?c:0),c>=0&&u(_=>({..._,amount_returned:c}))}},[l.amount_spent,m]);const b=h=>{const{name:i,value:c}=h.target;u(_=>({..._,[i]:c})),D[i]&&j(_=>({..._,[i]:null}))},d=h=>{const i=h.target.files[0];if(I(""),i){if(i.size>2*1024*1024){I("File size must be less than 2MB");return}if(!["image/jpeg","image/png","application/pdf"].includes(i.type)){I("Only JPG, PNG, and PDF files are allowed");return}u(_=>({..._,receipt_attachment:i}))}},s=()=>{const h={};if(l.amount_spent?parseFloat(l.amount_spent)<0?h.amount_spent="Amount spent cannot be negative":m&&parseFloat(l.amount_spent)>parseFloat(m.amount_issued)&&(h.amount_spent="Amount spent cannot exceed issued amount"):h.amount_spent="Amount spent is required",l.amount_returned?parseFloat(l.amount_returned)<0&&(h.amount_returned="Amount returned cannot be negative"):h.amount_returned="Amount returned is required",m&&l.amount_spent&&l.amount_returned&&!h.amount_spent&&!h.amount_returned){const i=parseFloat(m.amount_issued),c=parseFloat(l.amount_spent),_=parseFloat(l.amount_returned);Math.abs(c+_-i)>.01&&(h.amount_returned="Total of spent and returned must equal issued amount")}return j(h),Object.keys(h).length===0},a=async h=>{if(h.preventDefault(),!(!s()||A))try{let i;l.receipt_attachment?(i=new FormData,i.append("amount_spent",l.amount_spent),i.append("amount_returned",l.amount_returned),i.append("remarks",l.remarks),i.append("receipt_attachment",l.receipt_attachment)):i={amount_spent:parseFloat(l.amount_spent),amount_returned:parseFloat(l.amount_returned),remarks:l.remarks},await F(m.id,i),T(!0)}catch(i){console.error("Error settling transaction:",i)}},T=(h=!1)=>{u({amount_spent:"",amount_returned:"",remarks:"",receipt_attachment:null}),j({}),I(""),h?v():t()};return m?e.jsxs(ae,{open:r,onClose:()=>T(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{variant:"h6",children:"Settle Transaction"}),e.jsx(C,{edge:"end",color:"inherit",onClick:()=>T(),"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs("form",{onSubmit:a,children:[e.jsxs(ie,{children:[e.jsxs(Ke,{severity:"info",sx:{mb:2},children:["Transaction Reference: ",m.transaction_reference,e.jsx("br",{}),"Employee: ",(f=m.employee)==null?void 0:f.full_name,e.jsx("br",{}),"Issued Amount: ",Ve(m.amount_issued)]}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{margin:"dense",fullWidth:!0,label:"Amount Spent *",type:"number",name:"amount_spent",value:l.amount_spent,onChange:b,error:!!D.amount_spent,helperText:D.amount_spent,InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Te,{})})}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{margin:"dense",fullWidth:!0,label:"Amount Returned *",type:"number",name:"amount_returned",value:l.amount_returned,onChange:b,error:!!D.amount_returned,helperText:D.amount_returned,InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Te,{})})}})})]}),l.amount_spent&&e.jsxs(p,{variant:"body2",color:"textSecondary",sx:{mt:1},children:["Remaining amount to be returned: ",Ve(R)]}),e.jsx(k,{margin:"dense",fullWidth:!0,label:"Remarks",name:"remarks",value:l.remarks,onChange:b,multiline:!0,rows:2}),e.jsxs($,{sx:{mt:2},children:[e.jsx(p,{variant:"body2",gutterBottom:!0,children:"Receipt Attachment"}),e.jsxs(L,{variant:"outlined",component:"label",startIcon:e.jsx(Xr,{}),fullWidth:!0,children:["Upload Receipt",e.jsx("input",{type:"file",hidden:!0,accept:"image/jpeg,image/png,application/pdf",onChange:d})]}),l.receipt_attachment&&e.jsxs(p,{variant:"caption",display:"block",sx:{mt:1},children:["Selected file: ",l.receipt_attachment.name]}),A&&e.jsx(De,{error:!0,children:A})]})]}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>T(),color:"primary",disabled:y,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",disabled:y,startIcon:y?e.jsx(je,{size:24}):null,children:y?"Submitting...":"Settle Transaction"})]})]})]}):null},ve=r=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(r),Ue=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",ln=({refresh:r})=>{const[t,v]=x.useState(0),[m,l]=x.useState(!1),[u,D]=x.useState(!1),[j,A]=x.useState(!1),[I,R]=x.useState(null),[W,F]=x.useState(""),[y,b]=x.useState(""),[d,s]=x.useState("all"),[a,T]=x.useState(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[f,h]=x.useState(new Date().toISOString().split("T")[0]),{funds:i,transactions:c,balance:_,getAllFunds:re,getAllTransactions:ge,approveFund:fe,approveTransaction:E,cancelTransaction:q,loading:w}=pe(),{employees:ke,getAllEmployees:Xe,loading:xn}=ye();x.useEffect(()=>{ne(),Xe()},[t]);const ne=async()=>{try{const g={search:y,status:d!=="all"?d:void 0,startDate:a,endDate:f,employeeId:W||void 0};t===0?await ge(g):await re(g),r()}catch(g){console.error("Error loading data:",g)}},Oe=()=>{ne()},Ze=(g,N)=>{v(N)},Me=async(g,N)=>{try{N==="fund"?await fe(g):await E(g),ne()}catch(nr){console.error("Error approving item:",nr)}},er=async g=>{try{const N=prompt("Please enter a reason for cancellation:");N&&(await q(g,N),ne())}catch(N){console.error("Error cancelling transaction:",N)}},rr=g=>{R(g),A(!0)},$e=g=>{switch(g){case"approved":return e.jsx(B,{label:"Approved",color:"success",size:"small"});case"pending":return e.jsx(B,{label:"Pending",color:"warning",size:"small"});case"settled":return e.jsx(B,{label:"Settled",color:"info",size:"small"});case"issued":return e.jsx(B,{label:"Issued",color:"primary",size:"small"});case"cancelled":return e.jsx(B,{label:"Cancelled",color:"error",size:"small"});case"rejected":return e.jsx(B,{label:"Rejected",color:"error",size:"small"});default:return e.jsx(B,{label:g,size:"small"})}};return e.jsxs($,{children:[e.jsx(S,{sx:{mb:3},children:e.jsx(G,{children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Current Balance"}),e.jsx(p,{variant:"h4",children:ve(_||0)})]}),e.jsx(o,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsxs($,{children:[e.jsx(L,{variant:"contained",color:"primary",startIcon:e.jsx(ze,{}),onClick:()=>l(!0),sx:{mr:2},children:"Add Funds"}),e.jsx(L,{variant:"contained",color:"secondary",startIcon:e.jsx(ze,{}),onClick:()=>D(!0),children:"New Transaction"})]})})]})})}),e.jsx($,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(Ge,{value:t,onChange:Ze,"aria-label":"petty cash sub-tabs",textColor:"primary",indicatorColor:"primary",children:[e.jsx(be,{label:"Transactions",id:"petty-cash-subtab-0"}),e.jsx(be,{label:"Funds",id:"petty-cash-subtab-1"})]})}),e.jsx(K,{sx:{p:2,mb:3},children:e.jsxs(o,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(k,{fullWidth:!0,placeholder:"Search",value:y,onChange:g=>b(g.target.value),onKeyPress:g=>g.key==="Enter"&&Oe(),InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Ye,{})})},size:"small"})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsxs(J,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Status"}),e.jsxs(Q,{value:d,onChange:g=>s(g.target.value),label:"Status",children:[e.jsx(P,{value:"all",children:"All Status"}),e.jsx(P,{value:"pending",children:"Pending"}),e.jsx(P,{value:"approved",children:"Approved"}),t===0&&e.jsxs(e.Fragment,{children:[e.jsx(P,{value:"issued",children:"Issued"}),e.jsx(P,{value:"settled",children:"Settled"}),e.jsx(P,{value:"cancelled",children:"Cancelled"})]}),t===1&&e.jsx(P,{value:"rejected",children:"Rejected"})]})]})}),t===0&&e.jsx(o,{item:!0,xs:12,md:2,children:e.jsxs(J,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Employee"}),e.jsxs(Q,{value:W,onChange:g=>F(g.target.value),label:"Employee",children:[e.jsx(P,{value:"",children:"All Employees"}),ke.map(g=>e.jsx(P,{value:g.id,children:g.full_name},g.id))]})]})}),e.jsx(o,{item:!0,xs:6,md:2,children:e.jsx(k,{label:"Start Date",type:"date",value:a,onChange:g=>T(g.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,size:"small"})}),e.jsx(o,{item:!0,xs:6,md:2,children:e.jsx(k,{label:"End Date",type:"date",value:f,onChange:g=>h(g.target.value),InputLabelProps:{shrink:!0},fullWidth:!0,size:"small",inputProps:{min:a}})}),e.jsx(o,{item:!0,xs:12,md:1,children:e.jsx(L,{variant:"contained",color:"primary",fullWidth:!0,onClick:Oe,startIcon:e.jsx(Re,{}),children:"Filter"})})]})}),t===1?e.jsx(de,{component:K,children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Reference"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Description"}),e.jsx(n,{align:"right",children:"Amount"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Created By"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(he,{children:w?e.jsx(O,{children:e.jsx(n,{colSpan:7,align:"center",children:"Loading..."})}):i.length===0?e.jsx(O,{children:e.jsx(n,{colSpan:7,align:"center",children:"No funds found"})}):i.map(g=>{var N;return e.jsxs(O,{children:[e.jsx(n,{children:g.transaction_reference}),e.jsx(n,{children:Ue(g.date)}),e.jsx(n,{children:g.description}),e.jsx(n,{align:"right",children:ve(g.amount)}),e.jsx(n,{children:$e(g.status)}),e.jsx(n,{children:((N=g.creator)==null?void 0:N.name)||"-"}),e.jsx(n,{children:g.status==="pending"&&e.jsx(Y,{title:"Approve",children:e.jsx(C,{color:"success",size:"small",onClick:()=>Me(g.id,"fund"),children:e.jsx(we,{})})})})]},g.id)})})]})}):e.jsx(de,{component:K,children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Reference"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Employee"}),e.jsx(n,{children:"Purpose"}),e.jsx(n,{align:"right",children:"Issued"}),e.jsx(n,{align:"right",children:"Spent"}),e.jsx(n,{align:"right",children:"Returned"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(he,{children:w?e.jsx(O,{children:e.jsx(n,{colSpan:9,align:"center",children:"Loading..."})}):c.length===0?e.jsx(O,{children:e.jsx(n,{colSpan:9,align:"center",children:"No transactions found"})}):c.map(g=>{var N;return e.jsxs(O,{children:[e.jsx(n,{children:g.transaction_reference}),e.jsx(n,{children:Ue(g.date)}),e.jsx(n,{children:((N=g.employee)==null?void 0:N.full_name)||"-"}),e.jsx(n,{children:g.purpose}),e.jsx(n,{align:"right",children:ve(g.amount_issued)}),e.jsx(n,{align:"right",children:ve(g.amount_spent||0)}),e.jsx(n,{align:"right",children:ve(g.amount_returned||0)}),e.jsx(n,{children:$e(g.status)}),e.jsxs(n,{children:[g.status==="issued"&&e.jsx(Y,{title:"Settle",children:e.jsx(C,{color:"primary",size:"small",onClick:()=>rr(g),children:e.jsx(We,{})})}),g.status==="settled"&&e.jsx(Y,{title:"Approve",children:e.jsx(C,{color:"success",size:"small",onClick:()=>Me(g.id,"transaction"),children:e.jsx(we,{})})}),(g.status==="issued"||g.status==="settled")&&e.jsx(Y,{title:"Cancel",children:e.jsx(C,{color:"error",size:"small",onClick:()=>er(g.id),children:e.jsx(Je,{})})})]})]},g.id)})})]})}),e.jsx(sn,{open:m,onClose:()=>l(!1),onSuccess:()=>{l(!1),ne()}}),e.jsx(an,{open:u,onClose:()=>D(!1),onSuccess:()=>{D(!1),ne()},employees:ke,balance:_||0}),e.jsx(Qe,{open:j,onClose:()=>{A(!1),R(null)},onSuccess:()=>{A(!1),R(null),ne()},transaction:I})]})},cn=({open:r,onClose:t,onSuccess:v,departments:m=[]})=>{const[l,u]=x.useState({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),[D,j]=x.useState({}),[A,I]=x.useState(""),{createEmployee:R,loading:W}=ye(),F=s=>{const{name:a,value:T}=s.target;u(f=>({...f,[a]:T})),D[a]&&j(f=>({...f,[a]:null}))},y=()=>{const s={};return l.full_name.trim()||(s.full_name="Full name is required"),l.position.trim()||(s.position="Position is required"),!l.department.trim()&&!A.trim()&&(s.department="Department is required"),l.email&&!/^\S+@\S+\.\S+$/.test(l.email)&&(s.email="Invalid email address"),j(s),Object.keys(s).length===0},b=async s=>{if(s.preventDefault(),!!y())try{const a={...l,department:l.department==="new"?A:l.department};await R(a),d(!0)}catch(a){console.error("Error adding employee:",a)}},d=(s=!1)=>{u({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),I(""),j({}),s?v():t()};return e.jsxs(ae,{open:r,onClose:()=>d(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{variant:"h6",children:"Add Employee"}),e.jsx(C,{edge:"end",color:"inherit",onClick:()=>d(),"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs("form",{onSubmit:b,children:[e.jsx(ie,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Full Name",name:"full_name",value:l.full_name,onChange:F,error:!!D.full_name,helperText:D.full_name})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Position",name:"position",value:l.position,onChange:F,error:!!D.position,helperText:D.position})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(J,{fullWidth:!0,error:!!D.department,required:!0,children:[e.jsx(X,{children:"Department"}),e.jsxs(Q,{name:"department",value:l.department,onChange:F,label:"Department *",children:[m.map(s=>e.jsx(P,{value:s,children:s},s)),e.jsx(P,{value:"new",children:e.jsx("em",{children:"Add New Department"})})]}),D.department&&e.jsx(De,{children:D.department})]})}),l.department==="new"&&e.jsx(o,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,required:!0,label:"New Department Name",value:A,onChange:s=>I(s.target.value),error:l.department==="new"&&!A.trim(),helperText:l.department==="new"&&!A.trim()?"New department name is required":""})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,label:"Email",name:"email",type:"email",value:l.email,onChange:F,error:!!D.email,helperText:D.email})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,label:"Phone Number",name:"phone_number",value:l.phone_number,onChange:F})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(X,{children:"Status"}),e.jsxs(Q,{name:"status",value:l.status,onChange:F,label:"Status",children:[e.jsx(P,{value:"active",children:"Active"}),e.jsx(P,{value:"inactive",children:"Inactive"})]})]})})]})}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>d(),color:"primary",disabled:W,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",disabled:W,startIcon:W?e.jsx(je,{size:24}):null,children:W?"Adding...":"Add Employee"})]})]})]})},on=({open:r,onClose:t,onSuccess:v,employee:m,departments:l=[]})=>{const[u,D]=x.useState({full_name:"",position:"",department:"",email:"",phone_number:"",status:"active"}),[j,A]=x.useState({}),[I,R]=x.useState(""),{updateEmployee:W,loading:F}=ye();x.useEffect(()=>{m&&D({full_name:m.full_name||"",position:m.position||"",department:m.department||"",email:m.email||"",phone_number:m.phone_number||"",status:m.status||"active"})},[m]);const y=a=>{const{name:T,value:f}=a.target;D(h=>({...h,[T]:f})),j[T]&&A(h=>({...h,[T]:null}))},b=()=>{const a={};return u.full_name.trim()||(a.full_name="Full name is required"),u.position.trim()||(a.position="Position is required"),!u.department.trim()&&!I.trim()&&(a.department="Department is required"),u.email&&!/^\S+@\S+\.\S+$/.test(u.email)&&(a.email="Invalid email address"),A(a),Object.keys(a).length===0},d=async a=>{if(a.preventDefault(),!(!m||!b()))try{const T={...u,department:u.department==="new"?I:u.department};await W(m.id,T),s(!0)}catch(T){console.error("Error updating employee:",T)}},s=(a=!1)=>{R(""),A({}),a?v():t()};return m?e.jsxs(ae,{open:r,onClose:()=>s(),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(p,{variant:"h6",children:"Edit Employee"}),e.jsx(C,{edge:"end",color:"inherit",onClick:()=>s(),"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs("form",{onSubmit:d,children:[e.jsxs(ie,{children:[e.jsx(k,{margin:"dense",fullWidth:!0,label:"Employee Code",value:m.employee_code||"",disabled:!0}),e.jsxs(o,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Full Name",name:"full_name",value:u.full_name,onChange:y,error:!!j.full_name,helperText:j.full_name})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,required:!0,label:"Position",name:"position",value:u.position,onChange:y,error:!!j.position,helperText:j.position})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(J,{fullWidth:!0,error:!!j.department,required:!0,children:[e.jsx(X,{children:"Department"}),e.jsxs(Q,{name:"department",value:u.department,onChange:y,label:"Department *",children:[l.map(a=>e.jsx(P,{value:a,children:a},a)),e.jsx(P,{value:"new",children:e.jsx("em",{children:"Add New Department"})})]}),j.department&&e.jsx(De,{children:j.department})]})}),u.department==="new"&&e.jsx(o,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,required:!0,label:"New Department Name",value:I,onChange:a=>R(a.target.value),error:u.department==="new"&&!I.trim(),helperText:u.department==="new"&&!I.trim()?"New department name is required":""})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,label:"Email",name:"email",type:"email",value:u.email,onChange:y,error:!!j.email,helperText:j.email})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(k,{fullWidth:!0,label:"Phone Number",name:"phone_number",value:u.phone_number,onChange:y})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(X,{children:"Status"}),e.jsxs(Q,{name:"status",value:u.status,onChange:y,label:"Status",children:[e.jsx(P,{value:"active",children:"Active"}),e.jsx(P,{value:"inactive",children:"Inactive"})]})]})})]})]}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>s(),color:"primary",disabled:F,children:"Cancel"}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",disabled:F,startIcon:F?e.jsx(je,{size:24}):null,children:F?"Updating...":"Update Employee"})]})]})]}):null},oe=r=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(r||0),dn=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",un=({open:r,onClose:t,employee:v})=>{const[m,l]=x.useState(new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0]),[u,D]=x.useState(new Date().toISOString().split("T")[0]),[j,A]=x.useState("all"),[I,R]=x.useState(!1),[W,F]=x.useState(null),{transactions:y,getEmployeeTransactions:b,approveTransaction:d,cancelTransaction:s,loading:a}=pe();x.useEffect(()=>{r&&v&&T()},[r,v]);const T=async()=>{if(v)try{const E={status:j!=="all"?j:void 0,startDate:m,endDate:u};await b(v.id,E)}catch(E){console.error("Error loading employee transactions:",E)}},f=()=>{T()},h=async E=>{try{await d(E),T()}catch(q){console.error("Error approving transaction:",q)}},i=async E=>{try{const q=prompt("Please enter a reason for cancellation:");q&&(await s(E,q),T())}catch(q){console.error("Error cancelling transaction:",q)}},c=E=>{F(E),R(!0)},_=E=>{switch(E){case"approved":return e.jsx(B,{label:"Approved",color:"success",size:"small"});case"pending":return e.jsx(B,{label:"Pending",color:"warning",size:"small"});case"settled":return e.jsx(B,{label:"Settled",color:"info",size:"small"});case"issued":return e.jsx(B,{label:"Issued",color:"primary",size:"small"});case"cancelled":return e.jsx(B,{label:"Cancelled",color:"error",size:"small"});default:return e.jsx(B,{label:E,size:"small"})}},re=()=>y.reduce((E,q)=>E+parseFloat(q.amount_issued||0),0),ge=()=>y.reduce((E,q)=>E+parseFloat(q.amount_spent||0),0),fe=()=>y.reduce((E,q)=>E+parseFloat(q.amount_returned||0),0);return v?e.jsxs(e.Fragment,{children:[e.jsxs(ae,{open:r,onClose:t,maxWidth:"md",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs($,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(p,{variant:"h6",children:[v.full_name,"'s Transactions"]}),e.jsx(C,{edge:"end",color:"inherit",onClick:t,"aria-label":"close",children:e.jsx(xe,{})})]})}),e.jsxs(ie,{children:[e.jsx(K,{sx:{p:2,mb:3},children:e.jsxs(o,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(k,{fullWidth:!0,label:"Start Date",type:"date",value:m,onChange:E=>l(E.target.value),InputLabelProps:{shrink:!0},size:"small"})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(k,{fullWidth:!0,label:"End Date",type:"date",value:u,onChange:E=>D(E.target.value),InputLabelProps:{shrink:!0},size:"small",inputProps:{min:m}})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsxs(J,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Status"}),e.jsxs(Q,{value:j,onChange:E=>A(E.target.value),label:"Status",children:[e.jsx(P,{value:"all",children:"All Status"}),e.jsx(P,{value:"issued",children:"Issued"}),e.jsx(P,{value:"settled",children:"Settled"}),e.jsx(P,{value:"approved",children:"Approved"}),e.jsx(P,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsx(L,{variant:"contained",color:"primary",fullWidth:!0,onClick:f,startIcon:e.jsx(Re,{}),children:"Filter"})})]})}),e.jsx($,{sx:{mb:3},children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsxs(K,{sx:{p:2,textAlign:"center"},children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Issued"}),e.jsx(p,{variant:"h5",children:oe(re())})]})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsxs(K,{sx:{p:2,textAlign:"center"},children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Spent"}),e.jsx(p,{variant:"h5",children:oe(ge())})]})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsxs(K,{sx:{p:2,textAlign:"center"},children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Returned"}),e.jsx(p,{variant:"h5",children:oe(fe())})]})})]})}),e.jsx(de,{component:K,children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Reference"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Purpose"}),e.jsx(n,{align:"right",children:"Issued"}),e.jsx(n,{align:"right",children:"Spent"}),e.jsx(n,{align:"right",children:"Returned"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(he,{children:a?e.jsx(O,{children:e.jsx(n,{colSpan:8,align:"center",children:e.jsx(je,{size:24})})}):y.length===0?e.jsx(O,{children:e.jsx(n,{colSpan:8,align:"center",children:"No transactions found for this period"})}):y.map(E=>e.jsxs(O,{children:[e.jsx(n,{children:E.transaction_reference}),e.jsx(n,{children:dn(E.date)}),e.jsx(n,{children:E.purpose}),e.jsx(n,{align:"right",children:oe(E.amount_issued)}),e.jsx(n,{align:"right",children:oe(E.amount_spent||0)}),e.jsx(n,{align:"right",children:oe(E.amount_returned||0)}),e.jsx(n,{children:_(E.status)}),e.jsxs(n,{children:[E.status==="issued"&&e.jsx(Y,{title:"Settle",children:e.jsx(C,{color:"primary",size:"small",onClick:()=>c(E),children:e.jsx(We,{})})}),E.status==="settled"&&e.jsx(Y,{title:"Approve",children:e.jsx(C,{color:"success",size:"small",onClick:()=>h(E.id),children:e.jsx(we,{})})}),(E.status==="issued"||E.status==="settled")&&e.jsx(Y,{title:"Cancel",children:e.jsx(C,{color:"error",size:"small",onClick:()=>i(E.id),children:e.jsx(Je,{})})})]})]},E.id))})]})})]}),e.jsx(ce,{children:e.jsx(L,{onClick:t,color:"primary",children:"Close"})})]}),e.jsx(Qe,{open:I,onClose:()=>{R(!1),F(null)},onSuccess:()=>{R(!1),F(null),T()},transaction:W})]}):null},mn=()=>{const[r,t]=x.useState(""),[v,m]=x.useState("all"),[l,u]=x.useState("all"),[D,j]=x.useState(!1),[A,I]=x.useState(!1),[R,W]=x.useState(!1),[F,y]=x.useState(null),[b,d]=x.useState(!1),{employees:s,getAllEmployees:a,deleteEmployee:T,stats:f,loading:h}=ye();x.useEffect(()=>{i()},[]);const i=async()=>{try{await a({search:r,status:v!=="all"?v:void 0,department:l!=="all"?l:void 0})}catch(w){console.error("Error loading employees:",w)}},c=()=>{i()},_=w=>{y(w),I(!0)},re=w=>{y(w),W(!0)},ge=async()=>{if(F)try{await T(F.id),d(!1),y(null),i()}catch(w){console.error("Error deleting employee:",w)}},fe=w=>{y(w),d(!0)},E=()=>!f||!f.departments?[]:f.departments,q=w=>{switch(w){case"active":return e.jsx(B,{label:"Active",color:"success",size:"small"});case"inactive":return e.jsx(B,{label:"Inactive",color:"error",size:"small"});default:return e.jsx(B,{label:w,size:"small"})}};return e.jsxs($,{children:[e.jsx(S,{sx:{mb:3},children:e.jsx(G,{children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"h6",children:"Employees Management"}),e.jsx(p,{variant:"body2",color:"textSecondary",children:"Manage employees for petty cash transactions"})]}),e.jsx(o,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(L,{variant:"contained",color:"primary",startIcon:e.jsx(ze,{}),onClick:()=>j(!0),children:"Add Employee"})})]})})}),e.jsx(K,{sx:{p:2,mb:3},children:e.jsxs(o,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(k,{fullWidth:!0,placeholder:"Search name, code, position...",value:r,onChange:w=>t(w.target.value),onKeyPress:w=>w.key==="Enter"&&c(),InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(Ye,{})})},size:"small"})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsxs(J,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Status"}),e.jsxs(Q,{value:v,onChange:w=>m(w.target.value),label:"Status",children:[e.jsx(P,{value:"all",children:"All Status"}),e.jsx(P,{value:"active",children:"Active"}),e.jsx(P,{value:"inactive",children:"Inactive"})]})]})}),e.jsx(o,{item:!0,xs:12,md:3,children:e.jsxs(J,{fullWidth:!0,size:"small",children:[e.jsx(X,{children:"Department"}),e.jsxs(Q,{value:l,onChange:w=>u(w.target.value),label:"Department",children:[e.jsx(P,{value:"all",children:"All Departments"}),E().map(w=>e.jsx(P,{value:w,children:w},w))]})]})}),e.jsx(o,{item:!0,xs:12,md:2,children:e.jsx(L,{variant:"contained",color:"primary",fullWidth:!0,onClick:c,startIcon:e.jsx(Re,{}),children:"Filter"})})]})}),e.jsx(de,{component:K,children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Employee Code"}),e.jsx(n,{children:"Full Name"}),e.jsx(n,{children:"Position"}),e.jsx(n,{children:"Department"}),e.jsx(n,{children:"Contact"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(he,{children:h?e.jsx(O,{children:e.jsx(n,{colSpan:7,align:"center",children:"Loading..."})}):s.length===0?e.jsx(O,{children:e.jsx(n,{colSpan:7,align:"center",children:"No employees found"})}):s.map(w=>e.jsxs(O,{children:[e.jsx(n,{children:w.employee_code}),e.jsx(n,{children:w.full_name}),e.jsx(n,{children:w.position}),e.jsx(n,{children:w.department}),e.jsx(n,{children:w.phone_number?e.jsxs("div",{children:[e.jsx("div",{children:w.phone_number}),e.jsx(p,{variant:"caption",color:"textSecondary",children:w.email})]}):w.email}),e.jsx(n,{children:q(w.status)}),e.jsxs(n,{children:[e.jsx(Y,{title:"View Transactions",children:e.jsx(C,{color:"primary",size:"small",onClick:()=>re(w),children:e.jsx(Pr,{})})}),e.jsx(Y,{title:"Edit",children:e.jsx(C,{color:"info",size:"small",onClick:()=>_(w),children:e.jsx(We,{})})}),e.jsx(Y,{title:"Delete",children:e.jsx(C,{color:"error",size:"small",onClick:()=>fe(w),children:e.jsx(Rr,{})})})]})]},w.id))})]})}),e.jsxs(ae,{open:b,onClose:()=>d(!1),children:[e.jsx(le,{children:"Confirm Delete"}),e.jsx(ie,{children:e.jsxs(Wr,{children:['Are you sure you want to delete the employee "',F==null?void 0:F.full_name,'"? This action cannot be undone.']})}),e.jsxs(ce,{children:[e.jsx(L,{onClick:()=>d(!1),color:"primary",children:"Cancel"}),e.jsx(L,{onClick:ge,color:"error",children:"Delete"})]})]}),e.jsx(cn,{open:D,onClose:()=>j(!1),onSuccess:()=>{j(!1),i()},departments:E()}),e.jsx(on,{open:A,onClose:()=>{I(!1),y(null)},onSuccess:()=>{I(!1),y(null),i()},employee:F,departments:E()}),e.jsx(un,{open:R,onClose:()=>{W(!1),y(null)},employee:F})]})},te=r=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2}).format(r),hn=({pettyCashStats:r,employeeStats:t,balance:v})=>{var m;return e.jsxs($,{children:[e.jsxs(o,{container:!0,spacing:3,mb:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Fund Usage Rate"}),e.jsxs(p,{variant:"h4",children:[(r==null?void 0:r.total_funds)>0?Math.round((r.total_funds-r.available_balance)/r.total_funds*100):0,"%"]}),e.jsxs($,{sx:{display:"flex",alignItems:"center"},children:[e.jsx($r,{style:{color:"#ff4d4f",marginRight:8}}),e.jsxs(p,{variant:"body2",color:"error",children:["Used: ",te((r==null?void 0:r.total_funds)-(r==null?void 0:r.available_balance)||0)]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Transaction Success Rate"}),e.jsxs(p,{variant:"h4",children:[(r==null?void 0:r.total_transactions)>0?Math.round(r.approved_transactions/r.total_transactions*100):0,"%"]}),e.jsxs($,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(we,{style:{color:"#52c41a",marginRight:8}}),e.jsxs(p,{variant:"body2",color:"success.main",children:["Approved: ",(r==null?void 0:r.approved_transactions)||0," of ",(r==null?void 0:r.total_transactions)||0]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Pending Actions"}),e.jsx(p,{variant:"h4",children:((r==null?void 0:r.pending_transactions)||0)+((r==null?void 0:r.settled_transactions)||0)}),e.jsxs($,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(kr,{style:{color:"#faad14",marginRight:8}}),e.jsxs(p,{variant:"body2",color:"warning.main",children:[(r==null?void 0:r.pending_transactions)||0," pending, ",(r==null?void 0:r.settled_transactions)||0," to approve"]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Employee Engagement"}),e.jsx(p,{variant:"h4",children:t!=null&&t.active_employees?Math.round(((r==null?void 0:r.total_transactions)||0)/t.active_employees):0}),e.jsxs($,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Pe,{style:{color:"#1890ff",marginRight:8}}),e.jsx(p,{variant:"body2",color:"primary",children:"Avg. transactions per employee"})]})]})})})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsxs(Ne,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(Gr,{style:{fontSize:24}}),e.jsx(p,{variant:"h6",children:"Petty Cash Statistics"})]}),e.jsx(He,{sx:{mb:2}}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Available Balance"}),e.jsx(p,{variant:"h5",children:te(v||0)})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Funds"}),e.jsx(p,{variant:"h5",children:te((r==null?void 0:r.total_funds)||0)})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Issued"}),e.jsx(p,{variant:"h5",color:"error",children:te((r==null?void 0:r.total_issued)||0)})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Spent"}),e.jsx(p,{variant:"h5",color:"warning.main",children:te((r==null?void 0:r.total_spent)||0)})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Returned"}),e.jsx(p,{variant:"h5",color:"success.main",children:te((r==null?void 0:r.total_returned)||0)})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Pending Funds"}),e.jsx(p,{variant:"h5",color:"info.main",children:te((r==null?void 0:r.pending_funds)||0)})]})]})]})})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsxs(Ne,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(Pe,{style:{fontSize:24}}),e.jsx(p,{variant:"h6",children:"Employee Statistics"})]}),e.jsx(He,{sx:{mb:2}}),e.jsxs(o,{container:!0,spacing:1.5,children:[e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Employees"}),e.jsx(p,{variant:"h5",children:(t==null?void 0:t.total_employees)||0})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Active Employees"}),e.jsx(p,{variant:"h5",color:"success.main",children:(t==null?void 0:t.active_employees)||0})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Inactive Employees"}),e.jsx(p,{variant:"h5",color:"error",children:(t==null?void 0:t.inactive_employees)||0})]}),e.jsxs(o,{item:!0,xs:6,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",children:"Total Departments"}),e.jsx(p,{variant:"h5",children:((m=t==null?void 0:t.departments)==null?void 0:m.length)||0})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(p,{variant:"subtitle2",color:"textSecondary",gutterBottom:!0,children:"Active Rate"}),e.jsxs($,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx($,{sx:{flexGrow:1,mr:2},children:e.jsx(Ar,{variant:"determinate",value:t!=null&&t.total_employees?t.active_employees/t.total_employees*100:0,sx:{height:10,borderRadius:5},color:"success"})}),e.jsxs(p,{variant:"body2",sx:{minWidth:"fit-content"},children:[t!=null&&t.total_employees?Math.round(t.active_employees/t.total_employees*100):0,"%"]})]})]})]})]})})})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"Transaction Status"}),e.jsx(de,{children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Status"}),e.jsx(n,{align:"right",children:"Count"}),e.jsx(n,{align:"right",children:"Percentage"})]})}),e.jsxs(he,{children:[e.jsxs(O,{children:[e.jsx(n,{children:e.jsx(B,{label:"Pending",color:"warning",size:"small"})}),e.jsx(n,{align:"right",children:(r==null?void 0:r.pending_transactions)||0}),e.jsxs(n,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.pending_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(O,{children:[e.jsx(n,{children:e.jsx(B,{label:"Settled",color:"info",size:"small"})}),e.jsx(n,{align:"right",children:(r==null?void 0:r.settled_transactions)||0}),e.jsxs(n,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.settled_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(O,{children:[e.jsx(n,{children:e.jsx(B,{label:"Approved",color:"success",size:"small"})}),e.jsx(n,{align:"right",children:(r==null?void 0:r.approved_transactions)||0}),e.jsxs(n,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.approved_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(O,{children:[e.jsx(n,{children:e.jsx(B,{label:"Cancelled",color:"error",size:"small"})}),e.jsx(n,{align:"right",children:(r==null?void 0:r.cancelled_transactions)||0}),e.jsxs(n,{align:"right",children:[(r==null?void 0:r.total_transactions)>0?((r==null?void 0:r.cancelled_transactions)/(r==null?void 0:r.total_transactions)*100).toFixed(1):0,"%"]})]}),e.jsxs(O,{children:[e.jsx(n,{sx:{fontWeight:"bold"},children:"Total"}),e.jsx(n,{align:"right",sx:{fontWeight:"bold"},children:(r==null?void 0:r.total_transactions)||0}),e.jsx(n,{align:"right",sx:{fontWeight:"bold"},children:"100%"})]})]})]})})]})})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(S,{children:e.jsxs(G,{children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"Department Breakdown"}),t!=null&&t.departments&&t.departments.length>0?e.jsx(de,{children:e.jsxs(ue,{size:"small",children:[e.jsx(me,{children:e.jsxs(O,{children:[e.jsx(n,{children:"Department"}),e.jsx(n,{align:"right",children:"Employees"})]})}),e.jsx(he,{children:t.departments.map(l=>e.jsxs(O,{children:[e.jsx(n,{children:l}),e.jsx(n,{align:"right",children:"-"})]},l))})]})}):e.jsx(p,{variant:"body2",color:"textSecondary",align:"center",sx:{py:4},children:"No department data available"})]})})})]})]})};function Ae(r){const{children:t,value:v,index:m,...l}=r;return e.jsx("div",{role:"tabpanel",hidden:v!==m,id:`petty-cash-tabpanel-${m}`,"aria-labelledby":`petty-cash-tab-${m}`,...l,children:v===m&&e.jsx($,{children:t})})}const kn=()=>{const[r,t]=x.useState(0),[v,m]=x.useState(!1),{getBalance:l,getStats:u,balance:D,stats:j,loading:A}=pe(),{getEmployeeStats:I,stats:R,loading:W}=ye();x.useEffect(()=>{(async()=>{m(!0);try{await Promise.all([l(),u(),I()])}catch(d){console.error("Error loading data:",d)}finally{m(!1)}})()},[]);const F=(b,d)=>{t(d)},y=async()=>{r===0?await Promise.all([l(),u()]):r===1?await I():r===2&&await Promise.all([l(),u(),I()])};return e.jsxs(zr,{children:[e.jsx($,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(Ge,{value:r,onChange:F,"aria-label":"petty cash management tabs",textColor:"primary",indicatorColor:"primary",children:[e.jsx(be,{icon:e.jsx(tn,{}),iconPosition:"start",label:"Petty Cash",id:"petty-cash-tab-0"}),e.jsx(be,{icon:e.jsx(Pe,{}),iconPosition:"start",label:"Employees",id:"petty-cash-tab-1"}),e.jsx(be,{icon:e.jsx(qr,{}),iconPosition:"start",label:"Statistics",id:"petty-cash-tab-2"})]})}),e.jsx(Ae,{value:r,index:0,children:e.jsx(ln,{refresh:y})}),e.jsx(Ae,{value:r,index:1,children:e.jsx(mn,{})}),e.jsx(Ae,{value:r,index:2,children:e.jsx(hn,{pettyCashStats:j,employeeStats:R,balance:D})})]})};export{kn as default};

import{j as e,T as n,Q as V,aC as Y,S as J,aD as X,aB as Z,r as x,G as i,C as f,x as b,q as ee,E as _,I as te,F as w,P as ae,y as F,aE as se,aF as re,aG as ne,aH as T}from"./index-Chkw8LpN.js";import{f as j,a as k}from"./currencyFormat-jXf0VaAX.js";import{a as m,b as a,T as S,S as I,c as ie,d as le,e as de,f as oe}from"./TextField-Czzb7ycq.js";import{S as l}from"./Skeleton-6YVSzGd4.js";import{C as ce}from"./Container-BmsYVYg_.js";import{R as he}from"./SearchOutlined-K4PNmaK5.js";import{R as xe}from"./FilterOutlined-2DlRXOcz.js";import{I as R,B as ue}from"./InputLabel-aB29g19v.js";import{M as d}from"./MenuItem-DKP--nxm.js";import{R as je}from"./PlusOutlined-1JNR4_VJ.js";import{T as me}from"./TablePagination-CcVC2h88.js";const pe=({key:u})=>e.jsxs(m,{children:[e.jsx(a,{children:e.jsx(l,{width:100,height:24,variant:"text"})}),e.jsxs(a,{children:[e.jsx(l,{width:120,height:24,variant:"text"}),e.jsx(n,{variant:"caption",display:"block",children:e.jsx(l,{width:80,height:16,variant:"text"})})]}),e.jsx(a,{children:e.jsx(l,{width:80,height:32,variant:"rounded"})}),e.jsx(a,{children:e.jsx(l,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(l,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(l,{width:90,height:24,variant:"text"})}),e.jsx(a,{children:e.jsx(l,{width:60,height:24,variant:"text"})}),e.jsx(a,{align:"right",children:e.jsx(l,{width:80,height:24,variant:"text",sx:{ml:"auto"}})}),e.jsx(a,{align:"right",children:e.jsx(l,{width:80,height:24,variant:"text",sx:{ml:"auto"}})}),e.jsx(a,{children:e.jsx(l,{width:60,height:32,variant:"rounded"})})]},u),Fe=()=>{const u=V(),o=Y(),s=J(X),{sales:c,getAllSales:z,getSalesStats:E}=Z(),[p,v]=x.useState(0),[h,W]=x.useState(10),[A,C]=x.useState(!0),[g,B]=x.useState({total_sales:0,total_revenue:0,total_profit:0});x.useEffect(()=>{y()},[s.statusFilter,s.deliveredFilter,s.startDate,s.endDate]);const y=async()=>{C(!0);const t={status:s.statusFilter!=="all"?s.statusFilter:void 0,is_delivered:s.deliveredFilter!=="all"?s.deliveredFilter==="true":void 0,date_from:s.startDate||void 0,date_to:s.endDate||void 0,search:s.searchTerm||void 0};await z(t);const r={date_from:t.date_from,date_to:t.date_to},P=await E(r);P&&B(P),C(!1)},L=(t,r)=>{v(r)},N=t=>{W(parseInt(t.target.value,10)),v(0)},G=t=>{o(se(t.target.value))},D=()=>{v(0),y()},M=t=>{t.key==="Enter"&&D()},O=t=>{o(re(t.target.value))},U=t=>{o(ne(t.target.value))},$=t=>{o(T({startDate:t.target.value,endDate:s.endDate}))},H=t=>{o(T({startDate:s.startDate,endDate:t.target.value}))},K=()=>{u("/app/sales")},q=t=>{u(`/app/delivery-report/${t}`)},Q=t=>{let r;switch(t){case"completed":r="success";break;case"pending":r="warning";break;case"cancelled":r="error";break;case"partially_paid":r="info";break;case"unpaid":r="default";break;default:r="default"}return e.jsx(F,{label:t.replace("_"," ").toUpperCase(),color:r,size:"small"})};return e.jsxs(ce,{maxWidth:"xxl",sx:{mt:0,p:"0!important"},children:[e.jsxs(i,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,md:4,children:e.jsx(f,{children:e.jsxs(b,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Sales"}),e.jsx(n,{variant:"h4",children:g.total_sales||0}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})}),e.jsx(i,{item:!0,xs:12,md:4,children:e.jsx(f,{children:e.jsxs(b,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Revenue"}),e.jsx(n,{variant:"h4",children:j(g.total_revenue||0)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})}),e.jsx(i,{item:!0,xs:12,md:4,children:e.jsx(f,{children:e.jsxs(b,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Total Profit"}),e.jsx(n,{variant:"h4",children:j(g.total_profit||0)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"For the selected date range"})]})})})]}),e.jsx(ee,{sx:{mb:3},children:e.jsxs(i,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(i,{item:!0,xs:12,md:3,children:e.jsx(S,{fullWidth:!0,placeholder:"Search by invoice number",variant:"outlined",size:"small",value:s.searchTerm,onChange:G,onKeyPress:M,InputProps:{startAdornment:e.jsx(_,{position:"start",children:e.jsx(he,{})}),endAdornment:e.jsx(_,{position:"end",children:e.jsx(te,{onClick:D,size:"small",children:e.jsx(xe,{})})})}})}),e.jsx(i,{item:!0,xs:6,md:2,children:e.jsxs(w,{fullWidth:!0,size:"small",children:[e.jsx(R,{children:"Status"}),e.jsxs(I,{value:s.statusFilter,onChange:O,label:"Status",children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"pending",children:"Pending"}),e.jsx(d,{value:"completed",children:"Completed"}),e.jsx(d,{value:"partially_paid",children:"Partially Paid"}),e.jsx(d,{value:"unpaid",children:"Unpaid"}),e.jsx(d,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(i,{item:!0,xs:6,md:2,children:e.jsxs(w,{fullWidth:!0,size:"small",children:[e.jsx(R,{children:"Delivery Status"}),e.jsxs(I,{value:s.deliveredFilter,onChange:U,label:"Delivery Status",children:[e.jsx(d,{value:"all",children:"All"}),e.jsx(d,{value:"true",children:"Delivered"}),e.jsx(d,{value:"false",children:"Not Delivered"})]})]})}),e.jsx(i,{item:!0,xs:6,md:2,children:e.jsx(S,{label:"Start Date",type:"date",value:s.startDate,onChange:$,InputLabelProps:{shrink:!0},size:"small",fullWidth:!0})}),e.jsx(i,{item:!0,xs:6,md:2,children:e.jsx(S,{label:"End Date",type:"date",value:s.endDate,onChange:H,InputLabelProps:{shrink:!0},size:"small",fullWidth:!0,inputProps:{min:s.startDate}})}),e.jsx(i,{item:!0,xs:12,md:1,children:e.jsx(ue,{variant:"contained",color:"primary",startIcon:e.jsx(je,{}),onClick:K,fullWidth:!0,children:"Sale"})})]})}),e.jsx(ie,{component:ae,children:e.jsxs(le,{size:"small",children:[e.jsx(de,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Invoice #"}),e.jsx(a,{children:"Customer"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Method"}),e.jsx(a,{children:"Order Date"}),e.jsx(a,{children:"Delivery Date"}),e.jsx(a,{children:"City"}),e.jsx(a,{align:"right",children:"Total"}),e.jsx(a,{align:"right",children:"Received"}),e.jsx(a,{children:"Delivered"})]})}),e.jsx(oe,{children:A?Array(h).fill(0).map((t,r)=>e.jsx(pe,{},r)):c&&c.length>0?c.slice(p*h,p*h+h).map(t=>e.jsxs(m,{children:[e.jsx(a,{children:e.jsx(n,{variant:"body1",fontWeight:"bold",sx:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>q(t.id),children:t.invoice_number})}),e.jsx(a,{children:t.customer?e.jsxs(e.Fragment,{children:[t.customer.customer_name,t.customer.business_name&&e.jsx(n,{variant:"caption",display:"block",sx:{color:"text.secondary"},children:t.customer.business_name})]}):"Walk-in Customer"}),e.jsx(a,{children:Q(t.status)}),e.jsx(a,{children:t.payment_method.toUpperCase()}),e.jsx(a,{children:k(t.order_date)}),e.jsx(a,{children:k(t.delivery_date)}),e.jsx(a,{children:t.city||"-"}),e.jsx(a,{align:"right",children:j(t.total)}),e.jsx(a,{align:"right",children:j(t.amount_received)}),e.jsx(a,{children:e.jsx(F,{label:t.is_delivered?"YES":"NO",color:t.is_delivered?"success":"default",size:"small"})})]},t.id)):e.jsx(m,{children:e.jsx(a,{colSpan:10,align:"center",children:e.jsx(n,{variant:"body1",sx:{py:2},children:"No sales found"})})})})]})}),e.jsx(me,{rowsPerPageOptions:[5,10,25,50],component:"div",count:c?c.length:0,rowsPerPage:h,page:p,onPageChange:L,onRowsPerPageChange:N})]})};export{Fe as default};
